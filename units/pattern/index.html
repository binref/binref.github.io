<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.11.6" />
<title>the refinery.units.pattern documentation</title>
<meta name="description" content="On a Mission to Refine Binaries" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow-night-bright.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{background-color:#0D0D0D;color:#EEEEEE;font-size:16pt}@font-face{font-family:"FixedSysEx";src:local('Fixedsys Excelsior 3.01-L2'),local('Fixedsys Excelsior 3.01'),local('FixedSysEx'),url(../../FixedSysEx.ttf) format('truetype')}code,pre,body,html{font-family:FixedSysEx,monospace}b,strong{font-weight:normal}#content{padding:20px}#sidebar{padding:1vw;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #EEEEEE;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}hr{display:none}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#EE8080;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#EEEEEE}// .title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#BB4040}pre code{background:#000000;display:block;padding:1px 0px 4px 0px;line-height:100%}code{background:#000000;padding:1px 0px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#000000;border:0;border-top:1px solid #EEEEEE;border-bottom:1px solid #EEEEEE;margin:1em 0;padding:1ex;overflow-x:auto}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index ul{list-style-type:square;padding:0}// #index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 10px}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#000000;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#0D0D0D}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#EEEEEE;border-left:5px solid #EEEEEE;padding-left:1em}.inheritance em{font-style:normal}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1ch}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition.note,.admonition.info,.admonition.todo,.admonition.versionadded,.admonition.important,.admonition.tip,.admonition.hint{background:#054000}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#998800}.admonition.error,.admonition.danger,.admonition.caution{background:#300000}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:1vw}main{display:flex;flex-direction:row;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #EEEEEE;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>refinery.units.pattern</code></h1>
</header>
<section id="section-intro">
<p>Pattern matching based extraction and substitution units.</p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L1-L331" class="git-link">Browse git</a>
</summary>
<pre><code class="python">&#34;&#34;&#34;
Pattern matching based extraction and substitution units.
&#34;&#34;&#34;
from __future__ import annotations

import re

from hashlib import blake2b
from itertools import islice
from typing import TYPE_CHECKING

from refinery.lib.patterns import formats, indicators
from refinery.lib.types import INF, Callable, Iterable, Param, bounds, buf
from refinery.units import Arg, Unit

if TYPE_CHECKING:
    from typing import Mapping, Tuple
    MT = Tuple[int, re.Match[bytes]]
    MB = re.Match[bytes]
    PT = re.Pattern[bytes]
    MC = Callable[[&#39;RefinedMatch&#39;], buf | None]


class RefinedMatch:
    &#34;&#34;&#34;
    Refinery allows insertion of patterns from `refinery.lib.patterns` into the user&#39;s regular
    expressions. Since some of those patterns include match groups for back-references, the final
    constructed expression might contain more groups than the user expects. This class builds a
    match object that retroactively removes these internal groups from a match object that came
    out of the pattern matching engine.
    &#34;&#34;&#34;

    __slots__ = &#39;_match&#39;, &#39;_ignored_keys&#39;, &#39;_mapped_index&#39;

    def __init__(self, match: MB, group_count: int, group_index: Mapping[str, int]):
        self._match = match
        ignored = [
            key for key in group_index if key.startswith(&#39;__&#39;) and key.endswith(&#39;__&#39;)]
        skipped_nums = sorted(group_index[key] for key in ignored)
        skipped_nums.append(group_count + 1)
        index = 0
        delta = 0
        self._ignored_keys = ignored
        self._mapped_index = _map = {0: 0}
        for num in skipped_nums:
            for index in range(index + 1, num - delta):
                _map[index] = index + delta
            delta += 1

    def grouplist(self):
        g = self._match.group
        return [g(k) for k in self._mapped_index.values()]

    def groupdict(self):
        groupdict = self._match.groupdict()
        for key in self._ignored_keys:
            del groupdict[key]
        return groupdict

    def start(self, group: int = 0) -&gt; int:
        return self._match.start(self._mapped_index[group])

    def end(self, group: int = 0) -&gt; int:
        return self._match.end(self._mapped_index[group])

    def group(self, group: int = 0) -&gt; bytes:
        return self._match.group(self._mapped_index[group])

    def span(self, group: int = 0) -&gt; tuple[int, int]:
        return self._match.span(self._mapped_index[group])

    __getitem__ = group

    @property
    def string(self):
        return self._match.string


class PatternExtractorBase(Unit, abstract=True):

    def __init__(
        self,
        min: Param[int, Arg.Number(&#39;-n&#39;, help=&#39;Matches must have length at least N.&#39;)] = 1,
        max: Param[int, Arg.Number(&#39;-m&#39;, help=&#39;Matches must have length at most N.&#39;)] = 0,
        len: Param[int, Arg.Number(&#39;-e&#39;, help=&#39;Matches must be of length exactly N.&#39;)] = 0,
        stripspace: Param[bool, Arg.Switch(&#39;-x&#39;, help=(
            &#39;Strip all whitespace from input before data is extracted.&#39;
        ))] = False,
        duplicates: Param[bool, Arg.Switch(&#39;-r&#39;, help=(
            &#39;Yield every (transformed) Match, even when it was found before.&#39;
        ))] = False,
        longest: Param[bool, Arg.Switch(&#39;-l&#39;, help=(
            &#39;Pick longer results first. The output will be sorted by length unless the --take &#39;
            &#39;option is specified, in which case the longest K results will be returned in order &#39;
            &#39;of appearance.&#39;
        ))] = False,
        take: Param[int, Arg.Number(&#39;-t&#39;, metavar=&#39;K&#39;, help=(
            &#39;Return only the first K occurrences in order of appearance. If --longest is &#39;
            &#39;specified, the K longest results will be returned in order of appearance within &#39;
            &#39;the input.&#39;
        ))] = 0,
        **keywords
    ):
        keywords.setdefault(&#39;ascii&#39;, True)
        keywords.setdefault(&#39;utf16&#39;, True)
        super().__init__(
            min=min,
            max=max or INF,
            len=len,
            stripspace=stripspace,
            duplicates=duplicates,
            longest=longest,
            take=take or INF,
            **keywords
        )

    def matches(self, data: buf, pattern: re.Pattern[bytes]):
        &#34;&#34;&#34;
        Searches the input data for the given regular expression pattern. If the
        argument `utf16` is `True`, search for occurrences where a zero byte
        is between every character of the match. The `ascii` option allows to
        control whether normal matching results are also returned.
        &#34;&#34;&#34;
        if self.args.ascii:
            for match in pattern.finditer(data):
                yield match.start(), match
        if self.args.utf16:
            from refinery.lib.patterns import alphabet, pattern_with_size_limits
            sizes = self._getbounds()
            utf16 = alphabet(&#39;.\\0&#39;, prefix=&#39;(.?)&#39;, token_size=2, flags=re.DOTALL)
            utf16 = pattern_with_size_limits(utf16, max(1, sizes.min), abs(sizes.max))
            for zm in utf16.bin.finditer(data):
                a, b = zm.span(0)
                if zm[2] and data[(a := a + 1)]:
                    b += 1
                for match in pattern.finditer(bytes(data[a:b:2])):
                    start = a + match.start() * 2
                    yield start, match

    def _getbounds(self):
        if (n := self.args.len) &gt; 0:
            return bounds[n]
        else:
            n = self.args.min
            m = self.args.max
            return bounds[n:m]

    def _prefilter(self, matches: Iterable[MT]) -&gt; Iterable[MT]:
        barrier = set()
        taken = 0
        sizes = self._getbounds()
        dedup = not self.args.duplicates
        maxtake = self.args.take
        longest = self.args.longest
        for offset, match in matches:
            hit = memoryview(match[0])
            if not hit or sizes and len(hit) not in sizes:
                continue
            if dedup:
                uid = blake2b(hit, digest_size=8).digest()
                if uid in barrier:
                    continue
                barrier.add(uid)
            yield offset, match
            taken += 1
            if not longest and taken &gt;= maxtake:
                break

    def _postfilter(self, matches: Iterable[MT]) -&gt; Iterable[MT]:
        if (t := self.args.take) is not INF:
            if self.args.longest:
                result = matches
                if not isinstance(result, (list, tuple)):
                    result = list(result)
                indices = sorted(
                    range(len(result)),
                    key=lambda k: len(result[k][1][0]),
                    reverse=True)
                for k in sorted(islice(indices, t)):
                    yield result[k]
            else:
                yield from islice(matches, t)
        elif self.args.longest:
            def sortkey(m: MT):
                return m[1].end() - m[1].start()
            yield from sorted(matches, key=sortkey, reverse=True)
        else:
            yield from matches

    def matchfilter(self, matches: Iterable[MT]) -&gt; Iterable[MT]:
        yield from self._postfilter(self._prefilter(matches))

    def matches_filtered(
        self,
        data: buf,
        pattern: buf | re.Pattern,
        *transforms: int | MC,
        expose_named_groups: bool = False,
    ):
        &#34;&#34;&#34;
        This is a wrapper for `AbstractRegexUint.matches` which filters the
        results according to the given commandline arguments. Returns a
        dictionary mapping its position (start, end) in the input data to the
        filtered and transformed match that was found at this position.
        &#34;&#34;&#34;
        if not isinstance(pattern, re.Pattern):
            pattern = re.compile(pattern)
        if self.args.stripspace:
            data = re.sub(BR&#39;\s+&#39;, B&#39;&#39;, data)
        if not transforms:
            transforms = 0,
        group_index = pattern.groupindex
        group_count = pattern.groups
        for k, (offset, match) in enumerate(self.matchfilter(self.matches(memoryview(data), pattern))):
            match = RefinedMatch(match, group_count, group_index)
            for transform in transforms:
                kwargs: dict = {
                    &#39;offset&#39;: offset
                }
                if callable(transform):
                    transformed = transform(match)
                    if transformed is None:
                        continue
                else:
                    if isinstance(transform, int):
                        transformed = match[transform]
                    else:
                        transformed = transform
                    if expose_named_groups:
                        kwargs.update(match.groupdict())
                chunk = self.labelled(transformed, **kwargs)
                chunk.set_next_batch(k)
                yield chunk


class PatternExtractor(PatternExtractorBase, abstract=True):
    def __init__(
        self, min=1, max=0, len=0, stripspace=False, duplicates=False, longest=False, take=0,
        ascii: Param[bool, Arg.Switch(&#39;-u&#39;, &#39;--no-ascii&#39;, group=&#39;AvsU&#39;, help=&#39;Search for UTF16 encoded patterns only.&#39;)] = True,
        utf16: Param[bool, Arg.Switch(&#39;-a&#39;, &#39;--no-utf16&#39;, group=&#39;AvsU&#39;, help=&#39;Search for ASCII encoded patterns only.&#39;)] = True,
        **keywords
    ):
        super().__init__(
            min=min,
            max=max,
            len=len,
            stripspace=stripspace,
            duplicates=duplicates,
            longest=longest,
            take=take,
            ascii=ascii,
            utf16=utf16,
            **keywords
        )


class RegexUnit(Unit, abstract=True):

    def __init__(
        self,
        fullmatch: Param[bool, Arg.Switch(&#39;-U&#39;, help=(
            &#39;Regular expressions are matched against the full input, not substrings of it.&#39;))] = False,
        multiline: Param[bool, Arg.Switch(&#39;-M&#39;, help=(
            &#39;Caret and dollar in regular expressions match the beginning and end of a line and &#39;
            &#39;a dot does not match line breaks.&#39;))] = False,
        ignorecase: Param[bool, Arg.Switch(&#39;-I&#39;, help=(
            &#39;Ignore capitalization for alphabetic characters in regular expressions.&#39;))] = False,
        **keywords
    ):
        flags = re.MULTILINE if multiline else re.DOTALL
        if ignorecase:
            flags |= re.IGNORECASE
        super().__init__(flags=flags, fullmatch=fullmatch, **keywords)

    def _make_matcher(self, pattern: str | buf | None, default=None):
        if pattern is None:
            return default
        regex = Arg.AsRegExp(self.codec, pattern, self.args.flags)
        if self.args.fullmatch:
            return regex.fullmatch
        else:
            return regex.search


_FMT = &#39;,\x20&#39;.join(p.name for p in formats)
_IOC = &#39;,\x20&#39;.join(p.name for p in indicators)


class SingleRegexUnit(RegexUnit, abstract=True):
    def __init__(
        self,
        regex: Param[str, Arg.RegExp(help=(
            &#39;A regular expression to match. Besides standard Python syntax, this also supports the &#39;
            &#39;extension (??P) where P is any named pattern known to refinery. For example, (??date) &#39;
            &#39;will match on any string that looks like a date. The following are all currently &#39;
            &#39;available pattern names: {}, {}.&#39;
        ).format(_IOC, _FMT))],
        count: Param[int, Arg.Number(&#39;-c&#39;, help=(
            &#39;Specify the maximum number of operations to perform.&#39;
        ))] = 0,
        fullmatch=False,
        multiline=False,
        ignorecase=False,
        **keywords
    ):
        super().__init__(
            regex=regex,
            count=count,
            fullmatch=fullmatch,
            multiline=multiline,
            ignorecase=ignorecase,
            **keywords
        )

    @property
    def regex(self):
        return Arg.AsRegExp(self.codec, self.args.regex, self.args.flags)


class SingleRegexTransformUnit(SingleRegexUnit, abstract=True):
    &#34;&#34;&#34;
    Besides the syntax `{k}` to insert the `k`-th match group, the unit supports processing the
    contents of match groups with arbitrary refinery units and other multibin handlers. To do so,
    use the following syntax:

        {match-group:handlers}

    where `handlers` is an optional reverse multibin expression that is used to post-process the
    binary data from the match. For example, `{2:hex:b64}` represents the base64-decoding of the
    hex-decoding of the second match group.
    &#34;&#34;&#34;</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="refinery.units.pattern.carve" href="carve.html">refinery.units.pattern.carve</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.carve_7z" href="carve_7z.html">refinery.units.pattern.carve_7z</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.carve_der" href="carve_der.html">refinery.units.pattern.carve_der</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.carve_json" href="carve_json.html">refinery.units.pattern.carve_json</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.carve_lnk" href="carve_lnk.html">refinery.units.pattern.carve_lnk</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.carve_pe" href="carve_pe.html">refinery.units.pattern.carve_pe</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.carve_png" href="carve_png.html">refinery.units.pattern.carve_png</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.carve_rtf" href="carve_rtf.html">refinery.units.pattern.carve_rtf</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.carve_tar" href="carve_tar.html">refinery.units.pattern.carve_tar</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.carve_xml" href="carve_xml.html">refinery.units.pattern.carve_xml</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.carve_zip" href="carve_zip.html">refinery.units.pattern.carve_zip</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.defang" href="defang.html">refinery.units.pattern.defang</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.dnsdomain" href="dnsdomain.html">refinery.units.pattern.dnsdomain</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.mimewords" href="mimewords.html">refinery.units.pattern.mimewords</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.resplit" href="resplit.html">refinery.units.pattern.resplit</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.resub" href="resub.html">refinery.units.pattern.resub</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.rex" href="rex.html">refinery.units.pattern.rex</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.struct_parser" href="struct_parser.html">refinery.units.pattern.struct_parser</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.subfiles" href="subfiles.html">refinery.units.pattern.subfiles</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.urlguards" href="urlguards.html">refinery.units.pattern.urlguards</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.xtp" href="xtp.html">refinery.units.pattern.xtp</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt><code class="name"><a title="refinery.units.pattern.xtw" href="xtw.html">refinery.units.pattern.xtw</a></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="refinery.units.pattern.RefinedMatch"><code class="flex name class">
<span>class <span class="ident">RefinedMatch</span></span>
<span>(</span><span>match, group_count, group_index)</span>
</code></dt>
<dd>
<section class="desc"><p>Refinery allows insertion of patterns from <code><a title="refinery.lib.patterns" href="../../lib/patterns/index.html">refinery.lib.patterns</a></code> into the user's regular
expressions. Since some of those patterns include match groups for back-references, the final
constructed expression might contain more groups than the user expects. This class builds a
match object that retroactively removes these internal groups from a match object that came
out of the pattern matching engine.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L24-L76" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class RefinedMatch:
    &#34;&#34;&#34;
    Refinery allows insertion of patterns from `refinery.lib.patterns` into the user&#39;s regular
    expressions. Since some of those patterns include match groups for back-references, the final
    constructed expression might contain more groups than the user expects. This class builds a
    match object that retroactively removes these internal groups from a match object that came
    out of the pattern matching engine.
    &#34;&#34;&#34;

    __slots__ = &#39;_match&#39;, &#39;_ignored_keys&#39;, &#39;_mapped_index&#39;

    def __init__(self, match: MB, group_count: int, group_index: Mapping[str, int]):
        self._match = match
        ignored = [
            key for key in group_index if key.startswith(&#39;__&#39;) and key.endswith(&#39;__&#39;)]
        skipped_nums = sorted(group_index[key] for key in ignored)
        skipped_nums.append(group_count + 1)
        index = 0
        delta = 0
        self._ignored_keys = ignored
        self._mapped_index = _map = {0: 0}
        for num in skipped_nums:
            for index in range(index + 1, num - delta):
                _map[index] = index + delta
            delta += 1

    def grouplist(self):
        g = self._match.group
        return [g(k) for k in self._mapped_index.values()]

    def groupdict(self):
        groupdict = self._match.groupdict()
        for key in self._ignored_keys:
            del groupdict[key]
        return groupdict

    def start(self, group: int = 0) -&gt; int:
        return self._match.start(self._mapped_index[group])

    def end(self, group: int = 0) -&gt; int:
        return self._match.end(self._mapped_index[group])

    def group(self, group: int = 0) -&gt; bytes:
        return self._match.group(self._mapped_index[group])

    def span(self, group: int = 0) -&gt; tuple[int, int]:
        return self._match.span(self._mapped_index[group])

    __getitem__ = group

    @property
    def string(self):
        return self._match.string</code></pre>
</details>
<h3>Instance variables</h3>
<dl>
<dt id="refinery.units.pattern.RefinedMatch.string"><code class="name">var <span class="ident">string</span></code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L74-L76" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def string(self):
    return self._match.string</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.units.pattern.RefinedMatch.grouplist"><code class="name flex">
<span>def <span class="ident">grouplist</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L50-L52" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def grouplist(self):
    g = self._match.group
    return [g(k) for k in self._mapped_index.values()]</code></pre>
</details>
</dd>
<dt id="refinery.units.pattern.RefinedMatch.groupdict"><code class="name flex">
<span>def <span class="ident">groupdict</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L54-L58" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def groupdict(self):
    groupdict = self._match.groupdict()
    for key in self._ignored_keys:
        del groupdict[key]
    return groupdict</code></pre>
</details>
</dd>
<dt id="refinery.units.pattern.RefinedMatch.start"><code class="name flex">
<span>def <span class="ident">start</span></span>(<span>self, group=0)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L60-L61" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def start(self, group: int = 0) -&gt; int:
    return self._match.start(self._mapped_index[group])</code></pre>
</details>
</dd>
<dt id="refinery.units.pattern.RefinedMatch.end"><code class="name flex">
<span>def <span class="ident">end</span></span>(<span>self, group=0)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L63-L64" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def end(self, group: int = 0) -&gt; int:
    return self._match.end(self._mapped_index[group])</code></pre>
</details>
</dd>
<dt id="refinery.units.pattern.RefinedMatch.group"><code class="name flex">
<span>def <span class="ident">group</span></span>(<span>self, group=0)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L66-L67" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def group(self, group: int = 0) -&gt; bytes:
    return self._match.group(self._mapped_index[group])</code></pre>
</details>
</dd>
<dt id="refinery.units.pattern.RefinedMatch.span"><code class="name flex">
<span>def <span class="ident">span</span></span>(<span>self, group=0)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L69-L70" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def span(self, group: int = 0) -&gt; tuple[int, int]:
    return self._match.span(self._mapped_index[group])</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="refinery.units.pattern.PatternExtractorBase"><code class="flex name class">
<span>class <span class="ident">PatternExtractorBase</span></span>
<span>(</span><span>min=1, max=0, len=0, stripspace=False, duplicates=False, longest=False, take=0, **keywords)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L79-L233" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class PatternExtractorBase(Unit, abstract=True):

    def __init__(
        self,
        min: Param[int, Arg.Number(&#39;-n&#39;, help=&#39;Matches must have length at least N.&#39;)] = 1,
        max: Param[int, Arg.Number(&#39;-m&#39;, help=&#39;Matches must have length at most N.&#39;)] = 0,
        len: Param[int, Arg.Number(&#39;-e&#39;, help=&#39;Matches must be of length exactly N.&#39;)] = 0,
        stripspace: Param[bool, Arg.Switch(&#39;-x&#39;, help=(
            &#39;Strip all whitespace from input before data is extracted.&#39;
        ))] = False,
        duplicates: Param[bool, Arg.Switch(&#39;-r&#39;, help=(
            &#39;Yield every (transformed) Match, even when it was found before.&#39;
        ))] = False,
        longest: Param[bool, Arg.Switch(&#39;-l&#39;, help=(
            &#39;Pick longer results first. The output will be sorted by length unless the --take &#39;
            &#39;option is specified, in which case the longest K results will be returned in order &#39;
            &#39;of appearance.&#39;
        ))] = False,
        take: Param[int, Arg.Number(&#39;-t&#39;, metavar=&#39;K&#39;, help=(
            &#39;Return only the first K occurrences in order of appearance. If --longest is &#39;
            &#39;specified, the K longest results will be returned in order of appearance within &#39;
            &#39;the input.&#39;
        ))] = 0,
        **keywords
    ):
        keywords.setdefault(&#39;ascii&#39;, True)
        keywords.setdefault(&#39;utf16&#39;, True)
        super().__init__(
            min=min,
            max=max or INF,
            len=len,
            stripspace=stripspace,
            duplicates=duplicates,
            longest=longest,
            take=take or INF,
            **keywords
        )

    def matches(self, data: buf, pattern: re.Pattern[bytes]):
        &#34;&#34;&#34;
        Searches the input data for the given regular expression pattern. If the
        argument `utf16` is `True`, search for occurrences where a zero byte
        is between every character of the match. The `ascii` option allows to
        control whether normal matching results are also returned.
        &#34;&#34;&#34;
        if self.args.ascii:
            for match in pattern.finditer(data):
                yield match.start(), match
        if self.args.utf16:
            from refinery.lib.patterns import alphabet, pattern_with_size_limits
            sizes = self._getbounds()
            utf16 = alphabet(&#39;.\\0&#39;, prefix=&#39;(.?)&#39;, token_size=2, flags=re.DOTALL)
            utf16 = pattern_with_size_limits(utf16, max(1, sizes.min), abs(sizes.max))
            for zm in utf16.bin.finditer(data):
                a, b = zm.span(0)
                if zm[2] and data[(a := a + 1)]:
                    b += 1
                for match in pattern.finditer(bytes(data[a:b:2])):
                    start = a + match.start() * 2
                    yield start, match

    def _getbounds(self):
        if (n := self.args.len) &gt; 0:
            return bounds[n]
        else:
            n = self.args.min
            m = self.args.max
            return bounds[n:m]

    def _prefilter(self, matches: Iterable[MT]) -&gt; Iterable[MT]:
        barrier = set()
        taken = 0
        sizes = self._getbounds()
        dedup = not self.args.duplicates
        maxtake = self.args.take
        longest = self.args.longest
        for offset, match in matches:
            hit = memoryview(match[0])
            if not hit or sizes and len(hit) not in sizes:
                continue
            if dedup:
                uid = blake2b(hit, digest_size=8).digest()
                if uid in barrier:
                    continue
                barrier.add(uid)
            yield offset, match
            taken += 1
            if not longest and taken &gt;= maxtake:
                break

    def _postfilter(self, matches: Iterable[MT]) -&gt; Iterable[MT]:
        if (t := self.args.take) is not INF:
            if self.args.longest:
                result = matches
                if not isinstance(result, (list, tuple)):
                    result = list(result)
                indices = sorted(
                    range(len(result)),
                    key=lambda k: len(result[k][1][0]),
                    reverse=True)
                for k in sorted(islice(indices, t)):
                    yield result[k]
            else:
                yield from islice(matches, t)
        elif self.args.longest:
            def sortkey(m: MT):
                return m[1].end() - m[1].start()
            yield from sorted(matches, key=sortkey, reverse=True)
        else:
            yield from matches

    def matchfilter(self, matches: Iterable[MT]) -&gt; Iterable[MT]:
        yield from self._postfilter(self._prefilter(matches))

    def matches_filtered(
        self,
        data: buf,
        pattern: buf | re.Pattern,
        *transforms: int | MC,
        expose_named_groups: bool = False,
    ):
        &#34;&#34;&#34;
        This is a wrapper for `AbstractRegexUint.matches` which filters the
        results according to the given commandline arguments. Returns a
        dictionary mapping its position (start, end) in the input data to the
        filtered and transformed match that was found at this position.
        &#34;&#34;&#34;
        if not isinstance(pattern, re.Pattern):
            pattern = re.compile(pattern)
        if self.args.stripspace:
            data = re.sub(BR&#39;\s+&#39;, B&#39;&#39;, data)
        if not transforms:
            transforms = 0,
        group_index = pattern.groupindex
        group_count = pattern.groups
        for k, (offset, match) in enumerate(self.matchfilter(self.matches(memoryview(data), pattern))):
            match = RefinedMatch(match, group_count, group_index)
            for transform in transforms:
                kwargs: dict = {
                    &#39;offset&#39;: offset
                }
                if callable(transform):
                    transformed = transform(match)
                    if transformed is None:
                        continue
                else:
                    if isinstance(transform, int):
                        transformed = match[transform]
                    else:
                        transformed = transform
                    if expose_named_groups:
                        kwargs.update(match.groupdict())
                chunk = self.labelled(transformed, **kwargs)
                chunk.set_next_batch(k)
                yield chunk</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="../index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.UnitBase" href="../index.html#refinery.units.UnitBase">UnitBase</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.PatternExtractor" href="#refinery.units.pattern.PatternExtractor">PatternExtractor</a></li>
<li><a title="refinery.units.pattern.dnsdomain.dnsdomain" href="dnsdomain.html#refinery.units.pattern.dnsdomain.dnsdomain">dnsdomain</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="refinery.units.pattern.PatternExtractorBase.matches"><code class="name flex">
<span>def <span class="ident">matches</span></span>(<span>self, data, pattern)</span>
</code></dt>
<dd>
<section class="desc"><p>Searches the input data for the given regular expression pattern. If the
argument <code>utf16</code> is <code>True</code>, search for occurrences where a zero byte
is between every character of the match. The <code>ascii</code> option allows to
control whether normal matching results are also returned.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L117-L138" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def matches(self, data: buf, pattern: re.Pattern[bytes]):
    &#34;&#34;&#34;
    Searches the input data for the given regular expression pattern. If the
    argument `utf16` is `True`, search for occurrences where a zero byte
    is between every character of the match. The `ascii` option allows to
    control whether normal matching results are also returned.
    &#34;&#34;&#34;
    if self.args.ascii:
        for match in pattern.finditer(data):
            yield match.start(), match
    if self.args.utf16:
        from refinery.lib.patterns import alphabet, pattern_with_size_limits
        sizes = self._getbounds()
        utf16 = alphabet(&#39;.\\0&#39;, prefix=&#39;(.?)&#39;, token_size=2, flags=re.DOTALL)
        utf16 = pattern_with_size_limits(utf16, max(1, sizes.min), abs(sizes.max))
        for zm in utf16.bin.finditer(data):
            a, b = zm.span(0)
            if zm[2] and data[(a := a + 1)]:
                b += 1
            for match in pattern.finditer(bytes(data[a:b:2])):
                start = a + match.start() * 2
                yield start, match</code></pre>
</details>
</dd>
<dt id="refinery.units.pattern.PatternExtractorBase.matchfilter"><code class="name flex">
<span>def <span class="ident">matchfilter</span></span>(<span>self, matches)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L190-L191" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def matchfilter(self, matches: Iterable[MT]) -&gt; Iterable[MT]:
    yield from self._postfilter(self._prefilter(matches))</code></pre>
</details>
</dd>
<dt id="refinery.units.pattern.PatternExtractorBase.matches_filtered"><code class="name flex">
<span>def <span class="ident">matches_filtered</span></span>(<span>self, data, pattern, *transforms, expose_named_groups=False)</span>
</code></dt>
<dd>
<section class="desc"><p>This is a wrapper for <code>AbstractRegexUint.matches</code> which filters the
results according to the given commandline arguments. Returns a
dictionary mapping its position (start, end) in the input data to the
filtered and transformed match that was found at this position.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L193-L233" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def matches_filtered(
    self,
    data: buf,
    pattern: buf | re.Pattern,
    *transforms: int | MC,
    expose_named_groups: bool = False,
):
    &#34;&#34;&#34;
    This is a wrapper for `AbstractRegexUint.matches` which filters the
    results according to the given commandline arguments. Returns a
    dictionary mapping its position (start, end) in the input data to the
    filtered and transformed match that was found at this position.
    &#34;&#34;&#34;
    if not isinstance(pattern, re.Pattern):
        pattern = re.compile(pattern)
    if self.args.stripspace:
        data = re.sub(BR&#39;\s+&#39;, B&#39;&#39;, data)
    if not transforms:
        transforms = 0,
    group_index = pattern.groupindex
    group_count = pattern.groups
    for k, (offset, match) in enumerate(self.matchfilter(self.matches(memoryview(data), pattern))):
        match = RefinedMatch(match, group_count, group_index)
        for transform in transforms:
            kwargs: dict = {
                &#39;offset&#39;: offset
            }
            if callable(transform):
                transformed = transform(match)
                if transformed is None:
                    continue
            else:
                if isinstance(transform, int):
                    transformed = match[transform]
                else:
                    transformed = transform
                if expose_named_groups:
                    kwargs.update(match.groupdict())
            chunk = self.labelled(transformed, **kwargs)
            chunk.set_next_batch(k)
            yield chunk</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="../index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.FilterEverything" href="../index.html#refinery.units.UnitBase.FilterEverything">FilterEverything</a></code></li>
<li><code><a title="refinery.units.Unit.Requires" href="../index.html#refinery.units.Unit.Requires">Requires</a></code></li>
<li><code><a title="refinery.units.Unit.act" href="../index.html#refinery.units.Unit.act">act</a></code></li>
<li><code><a title="refinery.units.Unit.assemble" href="../index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.codec" href="../index.html#refinery.units.Unit.codec">codec</a></code></li>
<li><code><a title="refinery.units.Unit.console" href="../index.html#refinery.units.Unit.console">console</a></code></li>
<li><code><a title="refinery.units.Unit.finish" href="../index.html#refinery.units.UnitBase.finish">finish</a></code></li>
<li><code><a title="refinery.units.Unit.handles" href="../index.html#refinery.units.UnitBase.handles">handles</a></code></li>
<li><code><a title="refinery.units.Unit.is_quiet" href="../index.html#refinery.units.Unit.is_quiet">is_quiet</a></code></li>
<li><code><a title="refinery.units.Unit.is_reversible" href="../index.html#refinery.units.Unit.is_reversible">is_reversible</a></code></li>
<li><code><a title="refinery.units.Unit.isatty" href="../index.html#refinery.units.Unit.isatty">isatty</a></code></li>
<li><code><a title="refinery.units.Unit.labelled" href="../index.html#refinery.units.Unit.labelled">labelled</a></code></li>
<li><code><a title="refinery.units.Unit.leniency" href="../index.html#refinery.units.Unit.leniency">leniency</a></code></li>
<li><code><a title="refinery.units.Unit.log_always" href="../index.html#refinery.units.Unit.log_always">log_always</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="../index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_detach" href="../index.html#refinery.units.Unit.log_detach">log_detach</a></code></li>
<li><code><a title="refinery.units.Unit.log_fail" href="../index.html#refinery.units.Unit.log_fail">log_fail</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="../index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="../index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="../index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.logger" href="../index.html#refinery.units.Unit.logger">logger</a></code></li>
<li><code><a title="refinery.units.Unit.name" href="../index.html#refinery.units.Unit.name">name</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="../index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.optional_dependencies" href="../index.html#refinery.units.Unit.optional_dependencies">optional_dependencies</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="../index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="../index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.required_dependencies" href="../index.html#refinery.units.Unit.required_dependencies">required_dependencies</a></code></li>
<li><code><a title="refinery.units.Unit.reset" href="../index.html#refinery.units.Unit.reset">reset</a></code></li>
<li><code><a title="refinery.units.Unit.reverse" href="../index.html#refinery.units.UnitBase.reverse">reverse</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="../index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="../index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="../index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.UnitBase" href="../index.html#refinery.units.UnitBase">UnitBase</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.UnitBase.filter" href="../index.html#refinery.units.UnitBase.filter">filter</a></code></li>
<li><code><a title="refinery.units.UnitBase.process" href="../index.html#refinery.units.UnitBase.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.units.pattern.PatternExtractor"><code class="flex name class">
<span>class <span class="ident">PatternExtractor</span></span>
<span>(</span><span>min=1, max=0, len=0, stripspace=False, duplicates=False, longest=False, take=0, ascii=True, utf16=True, **keywords)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L236-L254" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class PatternExtractor(PatternExtractorBase, abstract=True):
    def __init__(
        self, min=1, max=0, len=0, stripspace=False, duplicates=False, longest=False, take=0,
        ascii: Param[bool, Arg.Switch(&#39;-u&#39;, &#39;--no-ascii&#39;, group=&#39;AvsU&#39;, help=&#39;Search for UTF16 encoded patterns only.&#39;)] = True,
        utf16: Param[bool, Arg.Switch(&#39;-a&#39;, &#39;--no-utf16&#39;, group=&#39;AvsU&#39;, help=&#39;Search for ASCII encoded patterns only.&#39;)] = True,
        **keywords
    ):
        super().__init__(
            min=min,
            max=max,
            len=len,
            stripspace=stripspace,
            duplicates=duplicates,
            longest=longest,
            take=take,
            ascii=ascii,
            utf16=utf16,
            **keywords
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.PatternExtractorBase" href="#refinery.units.pattern.PatternExtractorBase">PatternExtractorBase</a></li>
<li><a title="refinery.units.Unit" href="../index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.UnitBase" href="../index.html#refinery.units.UnitBase">UnitBase</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.carve.carve" href="carve.html#refinery.units.pattern.carve.carve">carve</a></li>
<li><a title="refinery.units.pattern.rex.rex" href="rex.html#refinery.units.pattern.rex.rex">rex</a></li>
<li><a title="refinery.units.pattern.xtp.xtp" href="xtp.html#refinery.units.pattern.xtp.xtp">xtp</a></li>
<li><a title="refinery.units.pattern.xtw.xtw" href="xtw.html#refinery.units.pattern.xtw.xtw">xtw</a></li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.pattern.PatternExtractorBase" href="#refinery.units.pattern.PatternExtractorBase">PatternExtractorBase</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.pattern.PatternExtractorBase.FilterEverything" href="../index.html#refinery.units.UnitBase.FilterEverything">FilterEverything</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.Requires" href="../index.html#refinery.units.Unit.Requires">Requires</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.act" href="../index.html#refinery.units.Unit.act">act</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.assemble" href="../index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.codec" href="../index.html#refinery.units.Unit.codec">codec</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.console" href="../index.html#refinery.units.Unit.console">console</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.filter" href="../index.html#refinery.units.UnitBase.filter">filter</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.finish" href="../index.html#refinery.units.UnitBase.finish">finish</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.handles" href="../index.html#refinery.units.UnitBase.handles">handles</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.is_quiet" href="../index.html#refinery.units.Unit.is_quiet">is_quiet</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.is_reversible" href="../index.html#refinery.units.Unit.is_reversible">is_reversible</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.isatty" href="../index.html#refinery.units.Unit.isatty">isatty</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.labelled" href="../index.html#refinery.units.Unit.labelled">labelled</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.leniency" href="../index.html#refinery.units.Unit.leniency">leniency</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.log_always" href="../index.html#refinery.units.Unit.log_always">log_always</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.log_debug" href="../index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.log_detach" href="../index.html#refinery.units.Unit.log_detach">log_detach</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.log_fail" href="../index.html#refinery.units.Unit.log_fail">log_fail</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.log_info" href="../index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.log_level" href="../index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.log_warn" href="../index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.logger" href="../index.html#refinery.units.Unit.logger">logger</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.matches" href="#refinery.units.pattern.PatternExtractorBase.matches">matches</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.matches_filtered" href="#refinery.units.pattern.PatternExtractorBase.matches_filtered">matches_filtered</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.name" href="../index.html#refinery.units.Unit.name">name</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.nozzle" href="../index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.optional_dependencies" href="../index.html#refinery.units.Unit.optional_dependencies">optional_dependencies</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.process" href="../index.html#refinery.units.UnitBase.process">process</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.read" href="../index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.read1" href="../index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.required_dependencies" href="../index.html#refinery.units.Unit.required_dependencies">required_dependencies</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.reset" href="../index.html#refinery.units.Unit.reset">reset</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.reverse" href="../index.html#refinery.units.UnitBase.reverse">reverse</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.run" href="../index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.source" href="../index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.superinit" href="../index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.units.pattern.RegexUnit"><code class="flex name class">
<span>class <span class="ident">RegexUnit</span></span>
<span>(</span><span>fullmatch=False, multiline=False, ignorecase=False, **keywords)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L257-L282" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class RegexUnit(Unit, abstract=True):

    def __init__(
        self,
        fullmatch: Param[bool, Arg.Switch(&#39;-U&#39;, help=(
            &#39;Regular expressions are matched against the full input, not substrings of it.&#39;))] = False,
        multiline: Param[bool, Arg.Switch(&#39;-M&#39;, help=(
            &#39;Caret and dollar in regular expressions match the beginning and end of a line and &#39;
            &#39;a dot does not match line breaks.&#39;))] = False,
        ignorecase: Param[bool, Arg.Switch(&#39;-I&#39;, help=(
            &#39;Ignore capitalization for alphabetic characters in regular expressions.&#39;))] = False,
        **keywords
    ):
        flags = re.MULTILINE if multiline else re.DOTALL
        if ignorecase:
            flags |= re.IGNORECASE
        super().__init__(flags=flags, fullmatch=fullmatch, **keywords)

    def _make_matcher(self, pattern: str | buf | None, default=None):
        if pattern is None:
            return default
        regex = Arg.AsRegExp(self.codec, pattern, self.args.flags)
        if self.args.fullmatch:
            return regex.fullmatch
        else:
            return regex.search</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.Unit" href="../index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.UnitBase" href="../index.html#refinery.units.UnitBase">UnitBase</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="refinery.units.meta.loop.loop" href="../meta/loop.html#refinery.units.meta.loop.loop">loop</a></li>
<li><a title="refinery.units.pattern.SingleRegexUnit" href="#refinery.units.pattern.SingleRegexUnit">SingleRegexUnit</a></li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.Unit" href="../index.html#refinery.units.Unit">Unit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.Unit.FilterEverything" href="../index.html#refinery.units.UnitBase.FilterEverything">FilterEverything</a></code></li>
<li><code><a title="refinery.units.Unit.Requires" href="../index.html#refinery.units.Unit.Requires">Requires</a></code></li>
<li><code><a title="refinery.units.Unit.act" href="../index.html#refinery.units.Unit.act">act</a></code></li>
<li><code><a title="refinery.units.Unit.assemble" href="../index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.Unit.codec" href="../index.html#refinery.units.Unit.codec">codec</a></code></li>
<li><code><a title="refinery.units.Unit.console" href="../index.html#refinery.units.Unit.console">console</a></code></li>
<li><code><a title="refinery.units.Unit.finish" href="../index.html#refinery.units.UnitBase.finish">finish</a></code></li>
<li><code><a title="refinery.units.Unit.handles" href="../index.html#refinery.units.UnitBase.handles">handles</a></code></li>
<li><code><a title="refinery.units.Unit.is_quiet" href="../index.html#refinery.units.Unit.is_quiet">is_quiet</a></code></li>
<li><code><a title="refinery.units.Unit.is_reversible" href="../index.html#refinery.units.Unit.is_reversible">is_reversible</a></code></li>
<li><code><a title="refinery.units.Unit.isatty" href="../index.html#refinery.units.Unit.isatty">isatty</a></code></li>
<li><code><a title="refinery.units.Unit.labelled" href="../index.html#refinery.units.Unit.labelled">labelled</a></code></li>
<li><code><a title="refinery.units.Unit.leniency" href="../index.html#refinery.units.Unit.leniency">leniency</a></code></li>
<li><code><a title="refinery.units.Unit.log_always" href="../index.html#refinery.units.Unit.log_always">log_always</a></code></li>
<li><code><a title="refinery.units.Unit.log_debug" href="../index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.Unit.log_detach" href="../index.html#refinery.units.Unit.log_detach">log_detach</a></code></li>
<li><code><a title="refinery.units.Unit.log_fail" href="../index.html#refinery.units.Unit.log_fail">log_fail</a></code></li>
<li><code><a title="refinery.units.Unit.log_info" href="../index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.Unit.log_level" href="../index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.Unit.log_warn" href="../index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.Unit.logger" href="../index.html#refinery.units.Unit.logger">logger</a></code></li>
<li><code><a title="refinery.units.Unit.name" href="../index.html#refinery.units.Unit.name">name</a></code></li>
<li><code><a title="refinery.units.Unit.nozzle" href="../index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.Unit.optional_dependencies" href="../index.html#refinery.units.Unit.optional_dependencies">optional_dependencies</a></code></li>
<li><code><a title="refinery.units.Unit.read" href="../index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.Unit.read1" href="../index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.Unit.required_dependencies" href="../index.html#refinery.units.Unit.required_dependencies">required_dependencies</a></code></li>
<li><code><a title="refinery.units.Unit.reset" href="../index.html#refinery.units.Unit.reset">reset</a></code></li>
<li><code><a title="refinery.units.Unit.reverse" href="../index.html#refinery.units.UnitBase.reverse">reverse</a></code></li>
<li><code><a title="refinery.units.Unit.run" href="../index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.Unit.source" href="../index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.Unit.superinit" href="../index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.UnitBase" href="../index.html#refinery.units.UnitBase">UnitBase</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.UnitBase.filter" href="../index.html#refinery.units.UnitBase.filter">filter</a></code></li>
<li><code><a title="refinery.units.UnitBase.process" href="../index.html#refinery.units.UnitBase.process">process</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.units.pattern.SingleRegexUnit"><code class="flex name class">
<span>class <span class="ident">SingleRegexUnit</span></span>
<span>(</span><span>regex, count=0, fullmatch=False, multiline=False, ignorecase=False, **keywords)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L289-L317" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class SingleRegexUnit(RegexUnit, abstract=True):
    def __init__(
        self,
        regex: Param[str, Arg.RegExp(help=(
            &#39;A regular expression to match. Besides standard Python syntax, this also supports the &#39;
            &#39;extension (??P) where P is any named pattern known to refinery. For example, (??date) &#39;
            &#39;will match on any string that looks like a date. The following are all currently &#39;
            &#39;available pattern names: {}, {}.&#39;
        ).format(_IOC, _FMT))],
        count: Param[int, Arg.Number(&#39;-c&#39;, help=(
            &#39;Specify the maximum number of operations to perform.&#39;
        ))] = 0,
        fullmatch=False,
        multiline=False,
        ignorecase=False,
        **keywords
    ):
        super().__init__(
            regex=regex,
            count=count,
            fullmatch=fullmatch,
            multiline=multiline,
            ignorecase=ignorecase,
            **keywords
        )

    @property
    def regex(self):
        return Arg.AsRegExp(self.codec, self.args.regex, self.args.flags)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.RegexUnit" href="#refinery.units.pattern.RegexUnit">RegexUnit</a></li>
<li><a title="refinery.units.Unit" href="../index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.UnitBase" href="../index.html#refinery.units.UnitBase">UnitBase</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="refinery.units.meta.iffx.iffx" href="../meta/iffx.html#refinery.units.meta.iffx.iffx">iffx</a></li>
<li><a title="refinery.units.pattern.SingleRegexTransformUnit" href="#refinery.units.pattern.SingleRegexTransformUnit">SingleRegexTransformUnit</a></li>
<li><a title="refinery.units.pattern.resplit.resplit" href="resplit.html#refinery.units.pattern.resplit.resplit">resplit</a></li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="refinery.units.pattern.SingleRegexUnit.regex"><code class="name">var <span class="ident">regex</span></code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L315-L317" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@property
def regex(self):
    return Arg.AsRegExp(self.codec, self.args.regex, self.args.flags)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.pattern.RegexUnit" href="#refinery.units.pattern.RegexUnit">RegexUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.pattern.RegexUnit.FilterEverything" href="../index.html#refinery.units.UnitBase.FilterEverything">FilterEverything</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.Requires" href="../index.html#refinery.units.Unit.Requires">Requires</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.act" href="../index.html#refinery.units.Unit.act">act</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.assemble" href="../index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.codec" href="../index.html#refinery.units.Unit.codec">codec</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.console" href="../index.html#refinery.units.Unit.console">console</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.filter" href="../index.html#refinery.units.UnitBase.filter">filter</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.finish" href="../index.html#refinery.units.UnitBase.finish">finish</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.handles" href="../index.html#refinery.units.UnitBase.handles">handles</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.is_quiet" href="../index.html#refinery.units.Unit.is_quiet">is_quiet</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.is_reversible" href="../index.html#refinery.units.Unit.is_reversible">is_reversible</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.isatty" href="../index.html#refinery.units.Unit.isatty">isatty</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.labelled" href="../index.html#refinery.units.Unit.labelled">labelled</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.leniency" href="../index.html#refinery.units.Unit.leniency">leniency</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_always" href="../index.html#refinery.units.Unit.log_always">log_always</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_debug" href="../index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_detach" href="../index.html#refinery.units.Unit.log_detach">log_detach</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_fail" href="../index.html#refinery.units.Unit.log_fail">log_fail</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_info" href="../index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_level" href="../index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.log_warn" href="../index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.logger" href="../index.html#refinery.units.Unit.logger">logger</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.name" href="../index.html#refinery.units.Unit.name">name</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.nozzle" href="../index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.optional_dependencies" href="../index.html#refinery.units.Unit.optional_dependencies">optional_dependencies</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.process" href="../index.html#refinery.units.UnitBase.process">process</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.read" href="../index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.read1" href="../index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.required_dependencies" href="../index.html#refinery.units.Unit.required_dependencies">required_dependencies</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.reset" href="../index.html#refinery.units.Unit.reset">reset</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.reverse" href="../index.html#refinery.units.UnitBase.reverse">reverse</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.run" href="../index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.source" href="../index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.pattern.RegexUnit.superinit" href="../index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="refinery.units.pattern.SingleRegexTransformUnit"><code class="flex name class">
<span>class <span class="ident">SingleRegexTransformUnit</span></span>
<span>(</span><span>regex, count=0, fullmatch=False, multiline=False, ignorecase=False, **keywords)</span>
</code></dt>
<dd>
<section class="desc"><p>Besides the syntax <code>{k}</code> to insert the <code>k</code>-th match group, the unit supports processing the
contents of match groups with arbitrary refinery units and other multibin handlers. To do so,
use the following syntax:</p>
<pre><code>{match-group:handlers}
</code></pre>
<p>where <code>handlers</code> is an optional reverse multibin expression that is used to post-process the
binary data from the match. For example, <code>{2:hex:b64}</code> represents the base64-decoding of the
hex-decoding of the second match group.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/units/pattern/__init__.py#L320-L331" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class SingleRegexTransformUnit(SingleRegexUnit, abstract=True):
    &#34;&#34;&#34;
    Besides the syntax `{k}` to insert the `k`-th match group, the unit supports processing the
    contents of match groups with arbitrary refinery units and other multibin handlers. To do so,
    use the following syntax:

        {match-group:handlers}

    where `handlers` is an optional reverse multibin expression that is used to post-process the
    binary data from the match. For example, `{2:hex:b64}` represents the base64-decoding of the
    hex-decoding of the second match group.
    &#34;&#34;&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.SingleRegexUnit" href="#refinery.units.pattern.SingleRegexUnit">SingleRegexUnit</a></li>
<li><a title="refinery.units.pattern.RegexUnit" href="#refinery.units.pattern.RegexUnit">RegexUnit</a></li>
<li><a title="refinery.units.Unit" href="../index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.UnitBase" href="../index.html#refinery.units.UnitBase">UnitBase</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="refinery.units.pattern.resub.resub" href="resub.html#refinery.units.pattern.resub.resub">resub</a></li>
<li><a title="refinery.units.pattern.rex.rex" href="rex.html#refinery.units.pattern.rex.rex">rex</a></li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.pattern.SingleRegexUnit" href="#refinery.units.pattern.SingleRegexUnit">SingleRegexUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.pattern.SingleRegexUnit.FilterEverything" href="../index.html#refinery.units.UnitBase.FilterEverything">FilterEverything</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.Requires" href="../index.html#refinery.units.Unit.Requires">Requires</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.act" href="../index.html#refinery.units.Unit.act">act</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.assemble" href="../index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.codec" href="../index.html#refinery.units.Unit.codec">codec</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.console" href="../index.html#refinery.units.Unit.console">console</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.filter" href="../index.html#refinery.units.UnitBase.filter">filter</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.finish" href="../index.html#refinery.units.UnitBase.finish">finish</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.handles" href="../index.html#refinery.units.UnitBase.handles">handles</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.is_quiet" href="../index.html#refinery.units.Unit.is_quiet">is_quiet</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.is_reversible" href="../index.html#refinery.units.Unit.is_reversible">is_reversible</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.isatty" href="../index.html#refinery.units.Unit.isatty">isatty</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.labelled" href="../index.html#refinery.units.Unit.labelled">labelled</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.leniency" href="../index.html#refinery.units.Unit.leniency">leniency</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.log_always" href="../index.html#refinery.units.Unit.log_always">log_always</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.log_debug" href="../index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.log_detach" href="../index.html#refinery.units.Unit.log_detach">log_detach</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.log_fail" href="../index.html#refinery.units.Unit.log_fail">log_fail</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.log_info" href="../index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.log_level" href="../index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.log_warn" href="../index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.logger" href="../index.html#refinery.units.Unit.logger">logger</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.name" href="../index.html#refinery.units.Unit.name">name</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.nozzle" href="../index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.optional_dependencies" href="../index.html#refinery.units.Unit.optional_dependencies">optional_dependencies</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.process" href="../index.html#refinery.units.UnitBase.process">process</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.read" href="../index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.read1" href="../index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.required_dependencies" href="../index.html#refinery.units.Unit.required_dependencies">required_dependencies</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.reset" href="../index.html#refinery.units.Unit.reset">reset</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.reverse" href="../index.html#refinery.units.UnitBase.reverse">reverse</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.run" href="../index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.source" href="../index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.pattern.SingleRegexUnit.superinit" href="../index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="refinery.units" href="../index.html">refinery.units</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="refinery.units.pattern.carve" href="carve.html">refinery.units.pattern.carve</a></code></li>
<li><code><a title="refinery.units.pattern.carve_7z" href="carve_7z.html">refinery.units.pattern.carve_7z</a></code></li>
<li><code><a title="refinery.units.pattern.carve_der" href="carve_der.html">refinery.units.pattern.carve_der</a></code></li>
<li><code><a title="refinery.units.pattern.carve_json" href="carve_json.html">refinery.units.pattern.carve_json</a></code></li>
<li><code><a title="refinery.units.pattern.carve_lnk" href="carve_lnk.html">refinery.units.pattern.carve_lnk</a></code></li>
<li><code><a title="refinery.units.pattern.carve_pe" href="carve_pe.html">refinery.units.pattern.carve_pe</a></code></li>
<li><code><a title="refinery.units.pattern.carve_png" href="carve_png.html">refinery.units.pattern.carve_png</a></code></li>
<li><code><a title="refinery.units.pattern.carve_rtf" href="carve_rtf.html">refinery.units.pattern.carve_rtf</a></code></li>
<li><code><a title="refinery.units.pattern.carve_tar" href="carve_tar.html">refinery.units.pattern.carve_tar</a></code></li>
<li><code><a title="refinery.units.pattern.carve_xml" href="carve_xml.html">refinery.units.pattern.carve_xml</a></code></li>
<li><code><a title="refinery.units.pattern.carve_zip" href="carve_zip.html">refinery.units.pattern.carve_zip</a></code></li>
<li><code><a title="refinery.units.pattern.defang" href="defang.html">refinery.units.pattern.defang</a></code></li>
<li><code><a title="refinery.units.pattern.dnsdomain" href="dnsdomain.html">refinery.units.pattern.dnsdomain</a></code></li>
<li><code><a title="refinery.units.pattern.mimewords" href="mimewords.html">refinery.units.pattern.mimewords</a></code></li>
<li><code><a title="refinery.units.pattern.resplit" href="resplit.html">refinery.units.pattern.resplit</a></code></li>
<li><code><a title="refinery.units.pattern.resub" href="resub.html">refinery.units.pattern.resub</a></code></li>
<li><code><a title="refinery.units.pattern.rex" href="rex.html">refinery.units.pattern.rex</a></code></li>
<li><code><a title="refinery.units.pattern.struct_parser" href="struct_parser.html">refinery.units.pattern.struct_parser</a></code></li>
<li><code><a title="refinery.units.pattern.subfiles" href="subfiles.html">refinery.units.pattern.subfiles</a></code></li>
<li><code><a title="refinery.units.pattern.urlguards" href="urlguards.html">refinery.units.pattern.urlguards</a></code></li>
<li><code><a title="refinery.units.pattern.xtp" href="xtp.html">refinery.units.pattern.xtp</a></code></li>
<li><code><a title="refinery.units.pattern.xtw" href="xtw.html">refinery.units.pattern.xtw</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="refinery.units.pattern.RefinedMatch" href="#refinery.units.pattern.RefinedMatch">RefinedMatch</a></code></h4>
<ul class="two-column">
<li><code><a title="refinery.units.pattern.RefinedMatch.grouplist" href="#refinery.units.pattern.RefinedMatch.grouplist">grouplist</a></code></li>
<li><code><a title="refinery.units.pattern.RefinedMatch.groupdict" href="#refinery.units.pattern.RefinedMatch.groupdict">groupdict</a></code></li>
<li><code><a title="refinery.units.pattern.RefinedMatch.start" href="#refinery.units.pattern.RefinedMatch.start">start</a></code></li>
<li><code><a title="refinery.units.pattern.RefinedMatch.end" href="#refinery.units.pattern.RefinedMatch.end">end</a></code></li>
<li><code><a title="refinery.units.pattern.RefinedMatch.group" href="#refinery.units.pattern.RefinedMatch.group">group</a></code></li>
<li><code><a title="refinery.units.pattern.RefinedMatch.span" href="#refinery.units.pattern.RefinedMatch.span">span</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.units.pattern.PatternExtractorBase" href="#refinery.units.pattern.PatternExtractorBase">PatternExtractorBase</a></code></h4>
<ul class="">
<li><code><a title="refinery.units.pattern.PatternExtractorBase.matches" href="#refinery.units.pattern.PatternExtractorBase.matches">matches</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.matchfilter" href="#refinery.units.pattern.PatternExtractorBase.matchfilter">matchfilter</a></code></li>
<li><code><a title="refinery.units.pattern.PatternExtractorBase.matches_filtered" href="#refinery.units.pattern.PatternExtractorBase.matches_filtered">matches_filtered</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.units.pattern.PatternExtractor" href="#refinery.units.pattern.PatternExtractor">PatternExtractor</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.units.pattern.RegexUnit" href="#refinery.units.pattern.RegexUnit">RegexUnit</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.units.pattern.SingleRegexUnit" href="#refinery.units.pattern.SingleRegexUnit">SingleRegexUnit</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.units.pattern.SingleRegexTransformUnit" href="#refinery.units.pattern.SingleRegexTransformUnit">SingleRegexTransformUnit</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>
hljs.configure({languages: []})
hljs.initHighlightingOnLoad()
</script>
</body>
</html>
