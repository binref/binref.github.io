<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.11.6" />
<title>the refinery.units.crypto.cipher.sosemanuk documentation</title>
<meta name="description" content="On a Mission to Refine Binaries" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow-night-bright.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{background-color:#0D0D0D;color:#EEEEEE;font-size:16pt}@font-face{font-family:"FixedSysEx";src:local('Fixedsys Excelsior 3.01-L2'),local('Fixedsys Excelsior 3.01'),local('FixedSysEx'),url(../../../FixedSysEx.ttf) format('truetype')}code,pre,body,html{font-family:FixedSysEx,monospace}b,strong{font-weight:normal}#content{padding:20px}#sidebar{padding:1vw;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #EEEEEE;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}hr{display:none}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#EE8080;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#EEEEEE}// .title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#BB4040}pre code{background:#000000;display:block;padding:1px 0px 4px 0px;line-height:100%}code{background:#000000;padding:1px 0px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#000000;border:0;border-top:1px solid #EEEEEE;border-bottom:1px solid #EEEEEE;margin:1em 0;padding:1ex;overflow-x:auto}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index ul{list-style-type:square;padding:0}// #index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 10px}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#000000;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#0D0D0D}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#EEEEEE;border-left:5px solid #EEEEEE;padding-left:1em}.inheritance em{font-style:normal}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1ch}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition.note,.admonition.info,.admonition.todo,.admonition.versionadded,.admonition.important,.admonition.tip,.admonition.hint{background:#054000}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#998800}.admonition.error,.admonition.danger,.admonition.caution{background:#300000}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:1vw}main{display:flex;flex-direction:row;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #EEEEEE;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>refinery.units.crypto.cipher.sosemanuk</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/2c887cef6f2560025a1ac871b535f0d84fa3f321/refinery/units/crypto/cipher/sosemanuk.py#L1-L2229" class="git-link">Browse git</a>
</summary>
<pre><code class="python">from __future__ import annotations

from array import array

from refinery.lib import chunks
from refinery.lib.crypto import rotl32
from refinery.lib.types import Param, buf
from refinery.units.crypto.cipher import Arg, StreamCipherUnit


class Sosemanuk:

    lfsr0: int
    lfsr1: int
    lfsr2: int
    lfsr3: int
    lfsr4: int
    lfsr5: int
    lfsr6: int
    lfsr7: int
    lfsr8: int
    lfsr9: int
    fsmR1: int
    fsmR2: int

    def __init__(self, key: bytearray, nonce: bytearray):
        self.mul_alpha = array(&#39;I&#39;)
        self.div_alpha = array(&#39;I&#39;)
        self.serpent24_sub_keys = [0] * 100
        expb = bytearray(0x100)
        logb = bytearray(0x100)
        x = 1
        for i in range(0xFF):
            expb[i] = x
            x &lt;&lt;= 1
            if x &gt; 0xFF:
                x ^= 0x1A9
        expb[0xFF] = 0
        assert set(expb) == set(range(0x100))
        for i in range(0x100):
            logb[expb[i]] = i
        self.mul_alpha.append(0x00000000)
        self.div_alpha.append(0x00000000)
        for x in range(1, 0x100):
            ma, da, ex = 0, 0, logb[x]
            ma |= expb[(ex + 0x17) % 255] &lt;&lt; 0x18
            ma |= expb[(ex + 0xF5) % 255] &lt;&lt; 0x10
            ma |= expb[(ex + 0x30) % 255] &lt;&lt; 0x08
            ma |= expb[(ex + 0xEF) % 255] &lt;&lt; 0x00
            da |= expb[(ex + 0x10) % 255] &lt;&lt; 0x18
            da |= expb[(ex + 0x27) % 255] &lt;&lt; 0x10
            da |= expb[(ex + 0x06) % 255] &lt;&lt; 0x08
            da |= expb[(ex + 0x40) % 255] &lt;&lt; 0x00
            self.mul_alpha.append(ma)
            self.div_alpha.append(da)

        self._set_secret(key)
        self._set_vector(nonce)

    def _set_secret(self, key: bytearray):
        n = len(key)
        if not 1 &lt;= n &lt;= 32:
            raise ValueError(&#39;bad key length&#39;)
        lkey = bytearray(32)
        lkey[:n] = key
        if n &lt; 32:
            lkey[n] = 0x01

        i = 0

        w0, w1, w2, w3, w4, w5, w6, w7 = chunks.unpack(lkey, 4)
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779b9
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779b8
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779bb
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779ba
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r0
        r0 |= r3
        r3 ^= r1
        r1 &amp;= r4
        r4 ^= r2
        r2 ^= r3
        r3 &amp;= r0
        r4 |= r1
        r3 ^= r4
        r0 ^= r1
        r4 &amp;= r0
        r1 ^= r3
        r4 ^= r2
        r1 |= r0
        r1 ^= r2
        r0 ^= r3
        r2 = r1
        r1 |= r3
        r1 ^= r0
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779bd
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779bc
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779bf
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779be
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r4 = r0
        r0 &amp;= r2
        r0 ^= r3
        r2 ^= r1
        r2 ^= r0
        r3 |= r4
        r3 ^= r1
        r4 ^= r2
        r1 = r3
        r3 |= r4
        r3 ^= r0
        r0 &amp;= r1
        r4 ^= r0
        r1 ^= r3
        r1 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779b1
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779b0
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779b3
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779b2
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r0
        r0 &amp;= r1
        r2 ^= r0
        r0 |= r3
        r3 ^= r2
        r1 ^= r0
        r0 ^= r4
        r4 |= r1
        r1 ^= r3
        r2 |= r0
        r2 &amp;= r4
        r0 ^= r1
        r1 &amp;= r2
        r1 ^= r0
        r0 &amp;= r2
        r0 ^= r4
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779b5
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779b4
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779b7
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779b6
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r4 ^= r2
        r1 ^= r0
        r0 |= r3
        r0 ^= r4
        r4 ^= r3
        r3 ^= r2
        r2 |= r1
        r2 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        r4 |= r1
        r1 ^= r3
        r1 ^= r4
        r3 |= r0
        r1 ^= r3
        r4 ^= r3
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779a9
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779a8
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779ab
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779aa
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r1
        r1 |= r2
        r1 ^= r3
        r4 ^= r2
        r2 ^= r1
        r3 |= r4
        r3 &amp;= r0
        r4 ^= r2
        r3 ^= r1
        r1 |= r4
        r1 ^= r0
        r0 |= r4
        r0 ^= r2
        r1 ^= r4
        r2 ^= r1
        r1 &amp;= r0
        r1 ^= r4
        r2 = ~r2 &amp; 0xFFFFFFFF
        r2 |= r0
        r4 ^= r2
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779ad
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779ac
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779af
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779ae
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r3
        r3 &amp;= r0
        r0 ^= r4
        r3 ^= r2
        r2 |= r4
        r1 ^= r3
        r2 ^= r0
        r0 |= r1
        r2 ^= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r4 ^= r3
        r4 ^= r0
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 &amp;= r4
        r2 ^= r3
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779a1
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779a0
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779a3
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779a2
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 ^= r1
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r4 = r1
        r1 &amp;= r0
        r2 ^= r3
        r1 ^= r2
        r2 |= r4
        r4 ^= r3
        r3 &amp;= r1
        r3 ^= r0
        r4 ^= r1
        r4 ^= r2
        r2 ^= r0
        r0 &amp;= r3
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 ^= r4
        r4 |= r3
        r2 ^= r4
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779a5
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779a4
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779a7
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779a6
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 ^= r3
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r1 ^= r2
        r4 ^= r3
        r0 ^= r4
        r2 &amp;= r4
        r2 ^= r0
        r0 &amp;= r1
        r3 ^= r0
        r4 |= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r2 &amp;= r3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r4 ^= r2
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e377999
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e377998
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e37799b
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e37799a
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r0
        r0 |= r3
        r3 ^= r1
        r1 &amp;= r4
        r4 ^= r2
        r2 ^= r3
        r3 &amp;= r0
        r4 |= r1
        r3 ^= r4
        r0 ^= r1
        r4 &amp;= r0
        r1 ^= r3
        r4 ^= r2
        r1 |= r0
        r1 ^= r2
        r0 ^= r3
        r2 = r1
        r1 |= r3
        r1 ^= r0
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e37799d
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e37799c
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e37799f
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e37799e
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r4 = r0
        r0 &amp;= r2
        r0 ^= r3
        r2 ^= r1
        r2 ^= r0
        r3 |= r4
        r3 ^= r1
        r4 ^= r2
        r1 = r3
        r3 |= r4
        r3 ^= r0
        r0 &amp;= r1
        r4 ^= r0
        r1 ^= r3
        r1 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e377991
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e377990
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e377993
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e377992
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r0
        r0 &amp;= r1
        r2 ^= r0
        r0 |= r3
        r3 ^= r2
        r1 ^= r0
        r0 ^= r4
        r4 |= r1
        r1 ^= r3
        r2 |= r0
        r2 &amp;= r4
        r0 ^= r1
        r1 &amp;= r2
        r1 ^= r0
        r0 &amp;= r2
        r0 ^= r4
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e377995
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e377994
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e377997
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e377996
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r4 ^= r2
        r1 ^= r0
        r0 |= r3
        r0 ^= r4
        r4 ^= r3
        r3 ^= r2
        r2 |= r1
        r2 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        r4 |= r1
        r1 ^= r3
        r1 ^= r4
        r3 |= r0
        r1 ^= r3
        r4 ^= r3
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e377989
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e377988
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e37798b
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e37798a
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r1
        r1 |= r2
        r1 ^= r3
        r4 ^= r2
        r2 ^= r1
        r3 |= r4
        r3 &amp;= r0
        r4 ^= r2
        r3 ^= r1
        r1 |= r4
        r1 ^= r0
        r0 |= r4
        r0 ^= r2
        r1 ^= r4
        r2 ^= r1
        r1 &amp;= r0
        r1 ^= r4
        r2 = ~r2 &amp; 0xFFFFFFFF
        r2 |= r0
        r4 ^= r2
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e37798d
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e37798c
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e37798f
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e37798e
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r3
        r3 &amp;= r0
        r0 ^= r4
        r3 ^= r2
        r2 |= r4
        r1 ^= r3
        r2 ^= r0
        r0 |= r1
        r2 ^= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r4 ^= r3
        r4 ^= r0
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 &amp;= r4
        r2 ^= r3
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e377981
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e377980
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e377983
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e377982
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 ^= r1
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r4 = r1
        r1 &amp;= r0
        r2 ^= r3
        r1 ^= r2
        r2 |= r4
        r4 ^= r3
        r3 &amp;= r1
        r3 ^= r0
        r4 ^= r1
        r4 ^= r2
        r2 ^= r0
        r0 &amp;= r3
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 ^= r4
        r4 |= r3
        r2 ^= r4
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e377985
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e377984
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e377987
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e377986
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 ^= r3
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r1 ^= r2
        r4 ^= r3
        r0 ^= r4
        r2 &amp;= r4
        r2 ^= r0
        r0 &amp;= r1
        r3 ^= r0
        r4 |= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r2 &amp;= r3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r4 ^= r2
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779f9
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779f8
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779fb
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779fa
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r0
        r0 |= r3
        r3 ^= r1
        r1 &amp;= r4
        r4 ^= r2
        r2 ^= r3
        r3 &amp;= r0
        r4 |= r1
        r3 ^= r4
        r0 ^= r1
        r4 &amp;= r0
        r1 ^= r3
        r4 ^= r2
        r1 |= r0
        r1 ^= r2
        r0 ^= r3
        r2 = r1
        r1 |= r3
        r1 ^= r0
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779fd
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779fc
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779ff
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779fe
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r4 = r0
        r0 &amp;= r2
        r0 ^= r3
        r2 ^= r1
        r2 ^= r0
        r3 |= r4
        r3 ^= r1
        r4 ^= r2
        r1 = r3
        r3 |= r4
        r3 ^= r0
        r0 &amp;= r1
        r4 ^= r0
        r1 ^= r3
        r1 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779f1
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779f0
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779f3
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779f2
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r0
        r0 &amp;= r1
        r2 ^= r0
        r0 |= r3
        r3 ^= r2
        r1 ^= r0
        r0 ^= r4
        r4 |= r1
        r1 ^= r3
        r2 |= r0
        r2 &amp;= r4
        r0 ^= r1
        r1 &amp;= r2
        r1 ^= r0
        r0 &amp;= r2
        r0 ^= r4
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779f5
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779f4
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779f7
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779f6
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r4 ^= r2
        r1 ^= r0
        r0 |= r3
        r0 ^= r4
        r4 ^= r3
        r3 ^= r2
        r2 |= r1
        r2 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        r4 |= r1
        r1 ^= r3
        r1 ^= r4
        r3 |= r0
        r1 ^= r3
        r4 ^= r3
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779e9
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779e8
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779eb
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779ea
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r1
        r1 |= r2
        r1 ^= r3
        r4 ^= r2
        r2 ^= r1
        r3 |= r4
        r3 &amp;= r0
        r4 ^= r2
        r3 ^= r1
        r1 |= r4
        r1 ^= r0
        r0 |= r4
        r0 ^= r2
        r1 ^= r4
        r2 ^= r1
        r1 &amp;= r0
        r1 ^= r4
        r2 = ~r2 &amp; 0xFFFFFFFF
        r2 |= r0
        r4 ^= r2
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779ed
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779ec
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779ef
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779ee
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r3
        r3 &amp;= r0
        r0 ^= r4
        r3 ^= r2
        r2 |= r4
        r1 ^= r3
        r2 ^= r0
        r0 |= r1
        r2 ^= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r4 ^= r3
        r4 ^= r0
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 &amp;= r4
        r2 ^= r3
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779e1
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779e0
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779e3
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779e2
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 ^= r1
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r4 = r1
        r1 &amp;= r0
        r2 ^= r3
        r1 ^= r2
        r2 |= r4
        r4 ^= r3
        r3 &amp;= r1
        r3 ^= r0
        r4 ^= r1
        r4 ^= r2
        r2 ^= r0
        r0 &amp;= r3
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 ^= r4
        r4 |= r3
        r2 ^= r4
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779e5
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779e4
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779e7
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779e6
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 ^= r3
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r1 ^= r2
        r4 ^= r3
        r0 ^= r4
        r2 &amp;= r4
        r2 ^= r0
        r0 &amp;= r1
        r3 ^= r0
        r4 |= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r2 &amp;= r3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r4 ^= r2
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779d9
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779d8
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779db
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779da
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r0
        r0 |= r3
        r3 ^= r1
        r1 &amp;= r4
        r4 ^= r2
        r2 ^= r3
        r3 &amp;= r0
        r4 |= r1
        r3 ^= r4
        r0 ^= r1
        r4 &amp;= r0
        r1 ^= r3
        r4 ^= r2
        r1 |= r0
        r1 ^= r2
        r0 ^= r3
        r2 = r1
        r1 |= r3
        r1 ^= r0
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1

    def _set_vector(self, nonce: bytearray):
        n = len(nonce)
        if n &gt; 16:
            raise ValueError(&#39;bad IV length&#39;)
        pnonce = bytearray(16)
        pnonce[:n] = nonce

        r0, r1, r2, r3 = chunks.unpack(pnonce, 4)

        r0 ^= self.serpent24_sub_keys[0]
        r1 ^= self.serpent24_sub_keys[0 + 1]
        r2 ^= self.serpent24_sub_keys[0 + 2]
        r3 ^= self.serpent24_sub_keys[0 + 3]
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r4 ^= r2
        r1 ^= r0
        r0 |= r3
        r0 ^= r4
        r4 ^= r3
        r3 ^= r2
        r2 |= r1
        r2 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        r4 |= r1
        r1 ^= r3
        r1 ^= r4
        r3 |= r0
        r1 ^= r3
        r4 ^= r3
        r1 = rotl32(r1, 13)
        r2 = rotl32(r2, 3)
        r4 = r4 ^ r1 ^ r2
        r0 = r0 ^ r2 ^ (r1 &lt;&lt; 3)
        r0 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 1)
        r0 = rotl32(r0, 7)
        r1 = r1 ^ r4 ^ r0
        r2 = r2 ^ r0 ^ (r4 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r2 = rotl32(r2, 22)
        r1 ^= self.serpent24_sub_keys[4]
        r4 ^= self.serpent24_sub_keys[4 + 1]
        r2 ^= self.serpent24_sub_keys[4 + 2]
        r0 ^= self.serpent24_sub_keys[4 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r3 = r1
        r1 &amp;= r4
        r2 ^= r1
        r1 |= r0
        r0 ^= r2
        r4 ^= r1
        r1 ^= r3
        r3 |= r4
        r4 ^= r0
        r2 |= r1
        r2 &amp;= r3
        r1 ^= r4
        r4 &amp;= r2
        r4 ^= r1
        r1 &amp;= r2
        r1 ^= r3
        r2 = rotl32(r2, 13)
        r0 = rotl32(r0, 3)
        r1 = r1 ^ r2 ^ r0
        r4 = r4 ^ r0 ^ (r2 &lt;&lt; 3)
        r4 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r4 = rotl32(r4, 7)
        r2 = r2 ^ r1 ^ r4
        r0 = r0 ^ r4 ^ (r1 &lt;&lt; 7)
        r0 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 5)
        r0 = rotl32(r0, 22)
        r2 ^= self.serpent24_sub_keys[8]
        r1 ^= self.serpent24_sub_keys[8 + 1]
        r0 ^= self.serpent24_sub_keys[8 + 2]
        r4 ^= self.serpent24_sub_keys[8 + 3]
        r3 = r2
        r2 &amp;= r0
        r2 ^= r4
        r0 ^= r1
        r0 ^= r2
        r4 |= r3
        r4 ^= r1
        r3 ^= r0
        r1 = r4
        r4 |= r3
        r4 ^= r2
        r2 &amp;= r1
        r3 ^= r2
        r1 ^= r4
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r0 = rotl32(r0, 13)
        r1 = rotl32(r1, 3)
        r4 = r4 ^ r0 ^ r1
        r3 = r3 ^ r1 ^ (r0 &lt;&lt; 3)
        r3 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 1)
        r3 = rotl32(r3, 7)
        r0 = r0 ^ r4 ^ r3
        r1 = r1 ^ r3 ^ (r4 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 5)
        r1 = rotl32(r1, 22)
        r0 ^= self.serpent24_sub_keys[12]
        r4 ^= self.serpent24_sub_keys[12 + 1]
        r1 ^= self.serpent24_sub_keys[12 + 2]
        r3 ^= self.serpent24_sub_keys[12 + 3]
        r2 = r0
        r0 |= r3
        r3 ^= r4
        r4 &amp;= r2
        r2 ^= r1
        r1 ^= r3
        r3 &amp;= r0
        r2 |= r4
        r3 ^= r2
        r0 ^= r4
        r2 &amp;= r0
        r4 ^= r3
        r2 ^= r1
        r4 |= r0
        r4 ^= r1
        r0 ^= r3
        r1 = r4
        r4 |= r3
        r4 ^= r0
        r4 = rotl32(r4, 13)
        r3 = rotl32(r3, 3)
        r1 = r1 ^ r4 ^ r3
        r2 = r2 ^ r3 ^ (r4 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r2 = rotl32(r2, 7)
        r4 = r4 ^ r1 ^ r2
        r3 = r3 ^ r2 ^ (r1 &lt;&lt; 7)
        r3 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 5)
        r3 = rotl32(r3, 22)
        r4 ^= self.serpent24_sub_keys[16]
        r1 ^= self.serpent24_sub_keys[16 + 1]
        r3 ^= self.serpent24_sub_keys[16 + 2]
        r2 ^= self.serpent24_sub_keys[16 + 3]
        r1 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r3 ^= r2
        r2 ^= r4
        r0 = r1
        r1 &amp;= r2
        r1 ^= r3
        r0 ^= r2
        r4 ^= r0
        r3 &amp;= r0
        r3 ^= r4
        r4 &amp;= r1
        r2 ^= r4
        r0 |= r1
        r0 ^= r4
        r4 |= r2
        r4 ^= r3
        r3 &amp;= r2
        r4 = ~r4 &amp; 0xFFFFFFFF
        r0 ^= r3
        r1 = rotl32(r1, 13)
        r4 = rotl32(r4, 3)
        r0 = r0 ^ r1 ^ r4
        r2 = r2 ^ r4 ^ (r1 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 1)
        r2 = rotl32(r2, 7)
        r1 = r1 ^ r0 ^ r2
        r4 = r4 ^ r2 ^ (r0 &lt;&lt; 7)
        r4 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r4 = rotl32(r4, 22)
        r1 ^= self.serpent24_sub_keys[20]
        r0 ^= self.serpent24_sub_keys[20 + 1]
        r4 ^= self.serpent24_sub_keys[20 + 2]
        r2 ^= self.serpent24_sub_keys[20 + 3]
        r1 ^= r0
        r0 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r3 = r0
        r0 &amp;= r1
        r4 ^= r2
        r0 ^= r4
        r4 |= r3
        r3 ^= r2
        r2 &amp;= r0
        r2 ^= r1
        r3 ^= r0
        r3 ^= r4
        r4 ^= r1
        r1 &amp;= r2
        r4 = ~r4 &amp; 0xFFFFFFFF
        r1 ^= r3
        r3 |= r2
        r4 ^= r3
        r0 = rotl32(r0, 13)
        r1 = rotl32(r1, 3)
        r2 = r2 ^ r0 ^ r1
        r4 = r4 ^ r1 ^ (r0 &lt;&lt; 3)
        r4 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r4 = rotl32(r4, 7)
        r0 = r0 ^ r2 ^ r4
        r1 = r1 ^ r4 ^ (r2 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 5)
        r1 = rotl32(r1, 22)
        r0 ^= self.serpent24_sub_keys[24]
        r2 ^= self.serpent24_sub_keys[24 + 1]
        r1 ^= self.serpent24_sub_keys[24 + 2]
        r4 ^= self.serpent24_sub_keys[24 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r3 = r4
        r4 &amp;= r0
        r0 ^= r3
        r4 ^= r1
        r1 |= r3
        r2 ^= r4
        r1 ^= r0
        r0 |= r2
        r1 ^= r2
        r3 ^= r0
        r0 |= r4
        r0 ^= r1
        r3 ^= r4
        r3 ^= r0
        r4 = ~r4 &amp; 0xFFFFFFFF
        r1 &amp;= r3
        r1 ^= r4
        r0 = rotl32(r0, 13)
        r3 = rotl32(r3, 3)
        r2 = r2 ^ r0 ^ r3
        r1 = r1 ^ r3 ^ (r0 &lt;&lt; 3)
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r1 = rotl32(r1, 7)
        r0 = r0 ^ r2 ^ r1
        r3 = r3 ^ r1 ^ (r2 &lt;&lt; 7)
        r3 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 5)
        r3 = rotl32(r3, 22)
        r0 ^= self.serpent24_sub_keys[28]
        r2 ^= self.serpent24_sub_keys[28 + 1]
        r3 ^= self.serpent24_sub_keys[28 + 2]
        r1 ^= self.serpent24_sub_keys[28 + 3]
        r4 = r2
        r2 |= r3
        r2 ^= r1
        r4 ^= r3
        r3 ^= r2
        r1 |= r4
        r1 &amp;= r0
        r4 ^= r3
        r1 ^= r2
        r2 |= r4
        r2 ^= r0
        r0 |= r4
        r0 ^= r3
        r2 ^= r4
        r3 ^= r2
        r2 &amp;= r0
        r2 ^= r4
        r3 = ~r3 &amp; 0xFFFFFFFF
        r3 |= r0
        r4 ^= r3
        r4 = rotl32(r4, 13)
        r2 = rotl32(r2, 3)
        r1 = r1 ^ r4 ^ r2
        r0 = r0 ^ r2 ^ (r4 &lt;&lt; 3)
        r0 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r0 = rotl32(r0, 7)
        r4 = r4 ^ r1 ^ r0
        r2 = r2 ^ r0 ^ (r1 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 5)
        r2 = rotl32(r2, 22)
        r4 ^= self.serpent24_sub_keys[32]
        r1 ^= self.serpent24_sub_keys[32 + 1]
        r2 ^= self.serpent24_sub_keys[32 + 2]
        r0 ^= self.serpent24_sub_keys[32 + 3]
        r0 ^= r4
        r3 = r1
        r1 &amp;= r0
        r3 ^= r2
        r1 ^= r4
        r4 |= r0
        r4 ^= r3
        r3 ^= r0
        r0 ^= r2
        r2 |= r1
        r2 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r3 |= r1
        r1 ^= r0
        r1 ^= r3
        r0 |= r4
        r1 ^= r0
        r3 ^= r0
        r1 = rotl32(r1, 13)
        r2 = rotl32(r2, 3)
        r3 = r3 ^ r1 ^ r2
        r4 = r4 ^ r2 ^ (r1 &lt;&lt; 3)
        r4 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 1)
        r4 = rotl32(r4, 7)
        r1 = r1 ^ r3 ^ r4
        r2 = r2 ^ r4 ^ (r3 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r2 = rotl32(r2, 22)
        r1 ^= self.serpent24_sub_keys[36]
        r3 ^= self.serpent24_sub_keys[36 + 1]
        r2 ^= self.serpent24_sub_keys[36 + 2]
        r4 ^= self.serpent24_sub_keys[36 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 = r1
        r1 &amp;= r3
        r2 ^= r1
        r1 |= r4
        r4 ^= r2
        r3 ^= r1
        r1 ^= r0
        r0 |= r3
        r3 ^= r4
        r2 |= r1
        r2 &amp;= r0
        r1 ^= r3
        r3 &amp;= r2
        r3 ^= r1
        r1 &amp;= r2
        r1 ^= r0
        r2 = rotl32(r2, 13)
        r4 = rotl32(r4, 3)
        r1 = r1 ^ r2 ^ r4
        r3 = r3 ^ r4 ^ (r2 &lt;&lt; 3)
        r3 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r3 = rotl32(r3, 7)
        r2 = r2 ^ r1 ^ r3
        r4 = r4 ^ r3 ^ (r1 &lt;&lt; 7)
        r4 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 5)
        r4 = rotl32(r4, 22)
        r2 ^= self.serpent24_sub_keys[40]
        r1 ^= self.serpent24_sub_keys[40 + 1]
        r4 ^= self.serpent24_sub_keys[40 + 2]
        r3 ^= self.serpent24_sub_keys[40 + 3]
        r0 = r2
        r2 &amp;= r4
        r2 ^= r3
        r4 ^= r1
        r4 ^= r2
        r3 |= r0
        r3 ^= r1
        r0 ^= r4
        r1 = r3
        r3 |= r0
        r3 ^= r2
        r2 &amp;= r1
        r0 ^= r2
        r1 ^= r3
        r1 ^= r0
        r0 = ~r0 &amp; 0xFFFFFFFF
        r4 = rotl32(r4, 13)
        r1 = rotl32(r1, 3)
        r3 = r3 ^ r4 ^ r1
        r0 = r0 ^ r1 ^ (r4 &lt;&lt; 3)
        r0 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 1)
        r0 = rotl32(r0, 7)
        r4 = r4 ^ r3 ^ r0
        r1 = r1 ^ r0 ^ (r3 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 5)
        r1 = rotl32(r1, 22)
        r4 ^= self.serpent24_sub_keys[44]
        r3 ^= self.serpent24_sub_keys[44 + 1]
        r1 ^= self.serpent24_sub_keys[44 + 2]
        r0 ^= self.serpent24_sub_keys[44 + 3]
        r2 = r4
        r4 |= r0
        r0 ^= r3
        r3 &amp;= r2
        r2 ^= r1
        r1 ^= r0
        r0 &amp;= r4
        r2 |= r3
        r0 ^= r2
        r4 ^= r3
        r2 &amp;= r4
        r3 ^= r0
        r2 ^= r1
        r3 |= r4
        r3 ^= r1
        r4 ^= r0
        r1 = r3
        r3 |= r0
        r3 ^= r4
        r3 = rotl32(r3, 13)
        r0 = rotl32(r0, 3)
        r1 = r1 ^ r3 ^ r0
        r2 = r2 ^ r0 ^ (r3 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r2 = rotl32(r2, 7)
        r3 = r3 ^ r1 ^ r2
        r0 = r0 ^ r2 ^ (r1 &lt;&lt; 7)
        r0 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 5)
        r0 = rotl32(r0, 22)
        self.lfsr9 = r3
        self.lfsr8 = r1
        self.lfsr7 = r0
        self.lfsr6 = r2
        r3 ^= self.serpent24_sub_keys[48]
        r1 ^= self.serpent24_sub_keys[48 + 1]
        r0 ^= self.serpent24_sub_keys[48 + 2]
        r2 ^= self.serpent24_sub_keys[48 + 3]
        r1 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 ^= r2
        r2 ^= r3
        r4 = r1
        r1 &amp;= r2
        r1 ^= r0
        r4 ^= r2
        r3 ^= r4
        r0 &amp;= r4
        r0 ^= r3
        r3 &amp;= r1
        r2 ^= r3
        r4 |= r1
        r4 ^= r3
        r3 |= r2
        r3 ^= r0
        r0 &amp;= r2
        r3 = ~r3 &amp; 0xFFFFFFFF
        r4 ^= r0
        r1 = rotl32(r1, 13)
        r3 = rotl32(r3, 3)
        r4 = r4 ^ r1 ^ r3
        r2 = r2 ^ r3 ^ (r1 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 1)
        r2 = rotl32(r2, 7)
        r1 = r1 ^ r4 ^ r2
        r3 = r3 ^ r2 ^ (r4 &lt;&lt; 7)
        r3 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r3 = rotl32(r3, 22)
        r1 ^= self.serpent24_sub_keys[52]
        r4 ^= self.serpent24_sub_keys[52 + 1]
        r3 ^= self.serpent24_sub_keys[52 + 2]
        r2 ^= self.serpent24_sub_keys[52 + 3]
        r1 ^= r4
        r4 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 = r4
        r4 &amp;= r1
        r3 ^= r2
        r4 ^= r3
        r3 |= r0
        r0 ^= r2
        r2 &amp;= r4
        r2 ^= r1
        r0 ^= r4
        r0 ^= r3
        r3 ^= r1
        r1 &amp;= r2
        r3 = ~r3 &amp; 0xFFFFFFFF
        r1 ^= r0
        r0 |= r2
        r3 ^= r0
        r4 = rotl32(r4, 13)
        r1 = rotl32(r1, 3)
        r2 = r2 ^ r4 ^ r1
        r3 = r3 ^ r1 ^ (r4 &lt;&lt; 3)
        r3 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r3 = rotl32(r3, 7)
        r4 = r4 ^ r2 ^ r3
        r1 = r1 ^ r3 ^ (r2 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 5)
        r1 = rotl32(r1, 22)
        r4 ^= self.serpent24_sub_keys[56]
        r2 ^= self.serpent24_sub_keys[56 + 1]
        r1 ^= self.serpent24_sub_keys[56 + 2]
        r3 ^= self.serpent24_sub_keys[56 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r0 = r3
        r3 &amp;= r4
        r4 ^= r0
        r3 ^= r1
        r1 |= r0
        r2 ^= r3
        r1 ^= r4
        r4 |= r2
        r1 ^= r2
        r0 ^= r4
        r4 |= r3
        r4 ^= r1
        r0 ^= r3
        r0 ^= r4
        r3 = ~r3 &amp; 0xFFFFFFFF
        r1 &amp;= r0
        r1 ^= r3
        r4 = rotl32(r4, 13)
        r0 = rotl32(r0, 3)
        r2 = r2 ^ r4 ^ r0
        r1 = r1 ^ r0 ^ (r4 &lt;&lt; 3)
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r1 = rotl32(r1, 7)
        r4 = r4 ^ r2 ^ r1
        r0 = r0 ^ r1 ^ (r2 &lt;&lt; 7)
        r0 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 5)
        r0 = rotl32(r0, 22)
        r4 ^= self.serpent24_sub_keys[60]
        r2 ^= self.serpent24_sub_keys[60 + 1]
        r0 ^= self.serpent24_sub_keys[60 + 2]
        r1 ^= self.serpent24_sub_keys[60 + 3]
        r3 = r2
        r2 |= r0
        r2 ^= r1
        r3 ^= r0
        r0 ^= r2
        r1 |= r3
        r1 &amp;= r4
        r3 ^= r0
        r1 ^= r2
        r2 |= r3
        r2 ^= r4
        r4 |= r3
        r4 ^= r0
        r2 ^= r3
        r0 ^= r2
        r2 &amp;= r4
        r2 ^= r3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r0 |= r4
        r3 ^= r0
        r3 = rotl32(r3, 13)
        r2 = rotl32(r2, 3)
        r1 = r1 ^ r3 ^ r2
        r4 = r4 ^ r2 ^ (r3 &lt;&lt; 3)
        r4 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r4 = rotl32(r4, 7)
        r3 = r3 ^ r1 ^ r4
        r2 = r2 ^ r4 ^ (r1 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 5)
        r2 = rotl32(r2, 22)
        r3 ^= self.serpent24_sub_keys[64]
        r1 ^= self.serpent24_sub_keys[64 + 1]
        r2 ^= self.serpent24_sub_keys[64 + 2]
        r4 ^= self.serpent24_sub_keys[64 + 3]
        r4 ^= r3
        r0 = r1
        r1 &amp;= r4
        r0 ^= r2
        r1 ^= r3
        r3 |= r4
        r3 ^= r0
        r0 ^= r4
        r4 ^= r2
        r2 |= r1
        r2 ^= r0
        r0 = ~r0 &amp; 0xFFFFFFFF
        r0 |= r1
        r1 ^= r4
        r1 ^= r0
        r4 |= r3
        r1 ^= r4
        r0 ^= r4
        r1 = rotl32(r1, 13)
        r2 = rotl32(r2, 3)
        r0 = r0 ^ r1 ^ r2
        r3 = r3 ^ r2 ^ (r1 &lt;&lt; 3)
        r3 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 1)
        r3 = rotl32(r3, 7)
        r1 = r1 ^ r0 ^ r3
        r2 = r2 ^ r3 ^ (r0 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r2 = rotl32(r2, 22)
        r1 ^= self.serpent24_sub_keys[68]
        r0 ^= self.serpent24_sub_keys[68 + 1]
        r2 ^= self.serpent24_sub_keys[68 + 2]
        r3 ^= self.serpent24_sub_keys[68 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r1
        r1 &amp;= r0
        r2 ^= r1
        r1 |= r3
        r3 ^= r2
        r0 ^= r1
        r1 ^= r4
        r4 |= r0
        r0 ^= r3
        r2 |= r1
        r2 &amp;= r4
        r1 ^= r0
        r0 &amp;= r2
        r0 ^= r1
        r1 &amp;= r2
        r1 ^= r4
        r2 = rotl32(r2, 13)
        r3 = rotl32(r3, 3)
        r1 = r1 ^ r2 ^ r3
        r0 = r0 ^ r3 ^ (r2 &lt;&lt; 3)
        r0 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r0 = rotl32(r0, 7)
        r2 = r2 ^ r1 ^ r0
        r3 = r3 ^ r0 ^ (r1 &lt;&lt; 7)
        r3 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 5)
        r3 = rotl32(r3, 22)
        self.fsmR1 = r2
        self.lfsr4 = r1
        self.fsmR2 = r3
        self.lfsr5 = r0
        r2 ^= self.serpent24_sub_keys[72]
        r1 ^= self.serpent24_sub_keys[72 + 1]
        r3 ^= self.serpent24_sub_keys[72 + 2]
        r0 ^= self.serpent24_sub_keys[72 + 3]
        r4 = r2
        r2 &amp;= r3
        r2 ^= r0
        r3 ^= r1
        r3 ^= r2
        r0 |= r4
        r0 ^= r1
        r4 ^= r3
        r1 = r0
        r0 |= r4
        r0 ^= r2
        r2 &amp;= r1
        r4 ^= r2
        r1 ^= r0
        r1 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        r3 = rotl32(r3, 13)
        r1 = rotl32(r1, 3)
        r0 = r0 ^ r3 ^ r1
        r4 = r4 ^ r1 ^ (r3 &lt;&lt; 3)
        r4 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 1)
        r4 = rotl32(r4, 7)
        r3 = r3 ^ r0 ^ r4
        r1 = r1 ^ r4 ^ (r0 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 5)
        r1 = rotl32(r1, 22)
        r3 ^= self.serpent24_sub_keys[76]
        r0 ^= self.serpent24_sub_keys[76 + 1]
        r1 ^= self.serpent24_sub_keys[76 + 2]
        r4 ^= self.serpent24_sub_keys[76 + 3]
        r2 = r3
        r3 |= r4
        r4 ^= r0
        r0 &amp;= r2
        r2 ^= r1
        r1 ^= r4
        r4 &amp;= r3
        r2 |= r0
        r4 ^= r2
        r3 ^= r0
        r2 &amp;= r3
        r0 ^= r4
        r2 ^= r1
        r0 |= r3
        r0 ^= r1
        r3 ^= r4
        r1 = r0
        r0 |= r4
        r0 ^= r3
        r0 = rotl32(r0, 13)
        r4 = rotl32(r4, 3)
        r1 = r1 ^ r0 ^ r4
        r2 = r2 ^ r4 ^ (r0 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r2 = rotl32(r2, 7)
        r0 = r0 ^ r1 ^ r2
        r4 = r4 ^ r2 ^ (r1 &lt;&lt; 7)
        r4 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 5)
        r4 = rotl32(r4, 22)
        r0 ^= self.serpent24_sub_keys[80]
        r1 ^= self.serpent24_sub_keys[80 + 1]
        r4 ^= self.serpent24_sub_keys[80 + 2]
        r2 ^= self.serpent24_sub_keys[80 + 3]
        r1 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 ^= r2
        r2 ^= r0
        r3 = r1
        r1 &amp;= r2
        r1 ^= r4
        r3 ^= r2
        r0 ^= r3
        r4 &amp;= r3
        r4 ^= r0
        r0 &amp;= r1
        r2 ^= r0
        r3 |= r1
        r3 ^= r0
        r0 |= r2
        r0 ^= r4
        r4 &amp;= r2
        r0 = ~r0 &amp; 0xFFFFFFFF
        r3 ^= r4
        r1 = rotl32(r1, 13)
        r0 = rotl32(r0, 3)
        r3 = r3 ^ r1 ^ r0
        r2 = r2 ^ r0 ^ (r1 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 1)
        r2 = rotl32(r2, 7)
        r1 = r1 ^ r3 ^ r2
        r0 = r0 ^ r2 ^ (r3 &lt;&lt; 7)
        r0 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r0 = rotl32(r0, 22)
        r1 ^= self.serpent24_sub_keys[84]
        r3 ^= self.serpent24_sub_keys[84 + 1]
        r0 ^= self.serpent24_sub_keys[84 + 2]
        r2 ^= self.serpent24_sub_keys[84 + 3]
        r1 ^= r3
        r3 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r3
        r3 &amp;= r1
        r0 ^= r2
        r3 ^= r0
        r0 |= r4
        r4 ^= r2
        r2 &amp;= r3
        r2 ^= r1
        r4 ^= r3
        r4 ^= r0
        r0 ^= r1
        r1 &amp;= r2
        r0 = ~r0 &amp; 0xFFFFFFFF
        r1 ^= r4
        r4 |= r2
        r0 ^= r4
        r3 = rotl32(r3, 13)
        r1 = rotl32(r1, 3)
        r2 = r2 ^ r3 ^ r1
        r0 = r0 ^ r1 ^ (r3 &lt;&lt; 3)
        r0 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r0 = rotl32(r0, 7)
        r3 = r3 ^ r2 ^ r0
        r1 = r1 ^ r0 ^ (r2 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 5)
        r1 = rotl32(r1, 22)
        r3 ^= self.serpent24_sub_keys[88]
        r2 ^= self.serpent24_sub_keys[88 + 1]
        r1 ^= self.serpent24_sub_keys[88 + 2]
        r0 ^= self.serpent24_sub_keys[88 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r4 = r0
        r0 &amp;= r3
        r3 ^= r4
        r0 ^= r1
        r1 |= r4
        r2 ^= r0
        r1 ^= r3
        r3 |= r2
        r1 ^= r2
        r4 ^= r3
        r3 |= r0
        r3 ^= r1
        r4 ^= r0
        r4 ^= r3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r1 &amp;= r4
        r1 ^= r0
        r3 = rotl32(r3, 13)
        r4 = rotl32(r4, 3)
        r2 = r2 ^ r3 ^ r4
        r1 = r1 ^ r4 ^ (r3 &lt;&lt; 3)
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r1 = rotl32(r1, 7)
        r3 = r3 ^ r2 ^ r1
        r4 = r4 ^ r1 ^ (r2 &lt;&lt; 7)
        r4 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 5)
        r4 = rotl32(r4, 22)
        r3 ^= self.serpent24_sub_keys[92]
        r2 ^= self.serpent24_sub_keys[92 + 1]
        r4 ^= self.serpent24_sub_keys[92 + 2]
        r1 ^= self.serpent24_sub_keys[92 + 3]
        r0 = r2
        r2 |= r4
        r2 ^= r1
        r0 ^= r4
        r4 ^= r2
        r1 |= r0
        r1 &amp;= r3
        r0 ^= r4
        r1 ^= r2
        r2 |= r0
        r2 ^= r3
        r3 |= r0
        r3 ^= r4
        r2 ^= r0
        r4 ^= r2
        r2 &amp;= r3
        r2 ^= r0
        r4 = ~r4 &amp; 0xFFFFFFFF
        r4 |= r3
        r0 ^= r4
        r0 = rotl32(r0, 13)
        r2 = rotl32(r2, 3)
        r1 = r1 ^ r0 ^ r2
        r3 = r3 ^ r2 ^ (r0 &lt;&lt; 3)
        r3 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r3 = rotl32(r3, 7)
        r0 = r0 ^ r1 ^ r3
        r2 = r2 ^ r3 ^ (r1 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 5)
        r2 = rotl32(r2, 22)
        r0 ^= self.serpent24_sub_keys[96]
        r1 ^= self.serpent24_sub_keys[96 + 1]
        r2 ^= self.serpent24_sub_keys[96 + 2]
        r3 ^= self.serpent24_sub_keys[96 + 3]
        self.lfsr3 = r0
        self.lfsr2 = r1
        self.lfsr1 = r2
        self.lfsr0 = r3

    def generate_block(self):
        s0 = self.lfsr0
        s1 = self.lfsr1
        s2 = self.lfsr2
        s3 = self.lfsr3
        s4 = self.lfsr4
        s5 = self.lfsr5
        s6 = self.lfsr6
        s7 = self.lfsr7
        s8 = self.lfsr8
        s9 = self.lfsr9
        r1 = self.fsmR1
        r2 = self.fsmR2

        ma = self.mul_alpha
        da = self.div_alpha

        tt = r1
        r1 = r2 + (s1 ^ (s8 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v0 = s0
        s0 = ((s0 &lt;&lt; 8) ^ ma[s0 &gt;&gt; 24]) ^ ((s3 &gt;&gt; 8) ^ da[s3 &amp; 0xFF]) ^ s9
        s0 &amp;= 0xFFFFFFFF
        f0 = (s9 + r1) ^ r2
        f0 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s2 ^ (s9 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v1 = s1
        s1 = ((s1 &lt;&lt; 8) ^ ma[s1 &gt;&gt; 24]) ^ ((s4 &gt;&gt; 8) ^ da[s4 &amp; 0xFF]) ^ s0
        s1 &amp;= 0xFFFFFFFF
        f1 = (s0 + r1) ^ r2
        f1 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s3 ^ (s0 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v2 = s2
        s2 = ((s2 &lt;&lt; 8) ^ ma[s2 &gt;&gt; 24]) ^ ((s5 &gt;&gt; 8) ^ da[s5 &amp; 0xFF]) ^ s1
        s2 &amp;= 0xFFFFFFFF
        f2 = (s1 + r1) ^ r2
        f2 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s4 ^ (s1 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v3 = s3
        s3 = ((s3 &lt;&lt; 8) ^ ma[s3 &gt;&gt; 24]) ^ ((s6 &gt;&gt; 8) ^ da[s6 &amp; 0xFF]) ^ s2
        s3 &amp;= 0xFFFFFFFF
        f3 = (s2 + r1) ^ r2
        f3 &amp;= 0xFFFFFFFF

        f4 = f0
        f0 &amp;= f2
        f0 ^= f3
        f2 ^= f1
        f2 ^= f0
        f3 |= f4
        f3 ^= f1
        f4 ^= f2
        f1 = f3
        f3 |= f4
        f3 ^= f0
        f0 &amp;= f1
        f4 ^= f0
        f1 ^= f3
        f1 ^= f4
        f4 = ~f4 &amp; 0xFFFFFFFF

        yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

        tt = r1
        r1 = r2 + (s5 ^ (s2 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v0 = s4
        s4 = ((s4 &lt;&lt; 8) ^ ma[s4 &gt;&gt; 24]) ^ ((s7 &gt;&gt; 8) ^ da[s7 &amp; 0xFF]) ^ s3
        s4 &amp;= 0xFFFFFFFF
        f0 = (s3 + r1) ^ r2
        f0 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s6 ^ (s3 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v1 = s5
        s5 = ((s5 &lt;&lt; 8) ^ ma[s5 &gt;&gt; 24]) ^ ((s8 &gt;&gt; 8) ^ da[s8 &amp; 0xFF]) ^ s4
        s5 &amp;= 0xFFFFFFFF
        f1 = (s4 + r1) ^ r2
        f1 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s7 ^ (s4 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v2 = s6
        s6 = ((s6 &lt;&lt; 8) ^ ma[s6 &gt;&gt; 24]) ^ ((s9 &gt;&gt; 8) ^ da[s9 &amp; 0xFF]) ^ s5
        s6 &amp;= 0xFFFFFFFF
        f2 = (s5 + r1) ^ r2
        f2 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s8 ^ (s5 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v3 = s7
        s7 = ((s7 &lt;&lt; 8) ^ ma[s7 &gt;&gt; 24]) ^ ((s0 &gt;&gt; 8) ^ da[s0 &amp; 0xFF]) ^ s6
        s7 &amp;= 0xFFFFFFFF
        f3 = (s6 + r1) ^ r2
        f3 &amp;= 0xFFFFFFFF

        f4 = f0
        f0 &amp;= f2
        f0 ^= f3
        f2 ^= f1
        f2 ^= f0
        f3 |= f4
        f3 ^= f1
        f4 ^= f2
        f1 = f3
        f3 |= f4
        f3 ^= f0
        f0 &amp;= f1
        f4 ^= f0
        f1 ^= f3
        f1 ^= f4
        f4 = ~f4 &amp; 0xFFFFFFFF

        yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

        tt = r1
        r1 = r2 + (s9 ^ (s6 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v0 = s8
        s8 = ((s8 &lt;&lt; 8) ^ ma[s8 &gt;&gt; 24]) ^ ((s1 &gt;&gt; 8) ^ da[s1 &amp; 0xFF]) ^ s7
        s8 &amp;= 0xFFFFFFFF
        f0 = (s7 + r1) ^ r2
        f0 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s0 ^ (s7 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v1 = s9
        s9 = ((s9 &lt;&lt; 8) ^ ma[s9 &gt;&gt; 24]) ^ ((s2 &gt;&gt; 8) ^ da[s2 &amp; 0xFF]) ^ s8
        s9 &amp;= 0xFFFFFFFF
        f1 = (s8 + r1) ^ r2
        f1 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s1 ^ (s8 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v2 = s0
        s0 = ((s0 &lt;&lt; 8) ^ ma[s0 &gt;&gt; 24]) ^ ((s3 &gt;&gt; 8) ^ da[s3 &amp; 0xFF]) ^ s9
        s0 &amp;= 0xFFFFFFFF
        f2 = (s9 + r1) ^ r2
        f2 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s2 ^ (s9 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v3 = s1
        s1 = ((s1 &lt;&lt; 8) ^ ma[s1 &gt;&gt; 24]) ^ ((s4 &gt;&gt; 8) ^ da[s4 &amp; 0xFF]) ^ s0
        s1 &amp;= 0xFFFFFFFF
        f3 = (s0 + r1) ^ r2
        f3 &amp;= 0xFFFFFFFF

        f4 = f0
        f0 &amp;= f2
        f0 ^= f3
        f2 ^= f1
        f2 ^= f0
        f3 |= f4
        f3 ^= f1
        f4 ^= f2
        f1 = f3
        f3 |= f4
        f3 ^= f0
        f0 &amp;= f1
        f4 ^= f0
        f1 ^= f3
        f1 ^= f4
        f4 = ~f4 &amp; 0xFFFFFFFF

        yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

        tt = r1
        r1 = r2 + (s3 ^ (s0 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v0 = s2
        s2 = ((s2 &lt;&lt; 8) ^ ma[s2 &gt;&gt; 24]) ^ ((s5 &gt;&gt; 8) ^ da[s5 &amp; 0xFF]) ^ s1
        s2 &amp;= 0xFFFFFFFF
        f0 = (s1 + r1) ^ r2
        f0 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s4 ^ (s1 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v1 = s3
        s3 = ((s3 &lt;&lt; 8) ^ ma[s3 &gt;&gt; 24]) ^ ((s6 &gt;&gt; 8) ^ da[s6 &amp; 0xFF]) ^ s2
        s3 &amp;= 0xFFFFFFFF
        f1 = (s2 + r1) ^ r2
        f1 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s5 ^ (s2 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v2 = s4
        s4 = ((s4 &lt;&lt; 8) ^ ma[s4 &gt;&gt; 24]) ^ ((s7 &gt;&gt; 8) ^ da[s7 &amp; 0xFF]) ^ s3
        s4 &amp;= 0xFFFFFFFF
        f2 = (s3 + r1) ^ r2
        f2 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s6 ^ (s3 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v3 = s5
        s5 = ((s5 &lt;&lt; 8) ^ ma[s5 &gt;&gt; 24]) ^ ((s8 &gt;&gt; 8) ^ da[s8 &amp; 0xFF]) ^ s4
        s5 &amp;= 0xFFFFFFFF
        f3 = (s4 + r1) ^ r2
        f3 &amp;= 0xFFFFFFFF

        f4 = f0
        f0 &amp;= f2
        f0 ^= f3
        f2 ^= f1
        f2 ^= f0
        f3 |= f4
        f3 ^= f1
        f4 ^= f2
        f1 = f3
        f3 |= f4
        f3 ^= f0
        f0 &amp;= f1
        f4 ^= f0
        f1 ^= f3
        f1 ^= f4
        f4 = ~f4 &amp; 0xFFFFFFFF

        yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

        tt = r1
        r1 = r2 + (s7 ^ (s4 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v0 = s6
        s6 = ((s6 &lt;&lt; 8) ^ ma[s6 &gt;&gt; 24]) ^ ((s9 &gt;&gt; 8) ^ da[s9 &amp; 0xFF]) ^ s5
        s6 &amp;= 0xFFFFFFFF
        f0 = (s5 + r1) ^ r2
        f0 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s8 ^ (s5 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v1 = s7
        s7 = ((s7 &lt;&lt; 8) ^ ma[s7 &gt;&gt; 24]) ^ ((s0 &gt;&gt; 8) ^ da[s0 &amp; 0xFF]) ^ s6
        s7 &amp;= 0xFFFFFFFF
        f1 = (s6 + r1) ^ r2
        f1 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s9 ^ (s6 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v2 = s8
        s8 = ((s8 &lt;&lt; 8) ^ ma[s8 &gt;&gt; 24]) ^ ((s1 &gt;&gt; 8) ^ da[s1 &amp; 0xFF]) ^ s7
        s8 &amp;= 0xFFFFFFFF
        f2 = (s7 + r1) ^ r2
        f2 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s0 ^ (s7 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v3 = s9
        s9 = ((s9 &lt;&lt; 8) ^ ma[s9 &gt;&gt; 24]) ^ ((s2 &gt;&gt; 8) ^ da[s2 &amp; 0xFF]) ^ s8
        s9 &amp;= 0xFFFFFFFF
        f3 = (s8 + r1) ^ r2
        f3 &amp;= 0xFFFFFFFF

        f4 = f0
        f0 &amp;= f2
        f0 ^= f3
        f2 ^= f1
        f2 ^= f0
        f3 |= f4
        f3 ^= f1
        f4 ^= f2
        f1 = f3
        f3 |= f4
        f3 ^= f0
        f0 &amp;= f1
        f4 ^= f0
        f1 ^= f3
        f1 ^= f4
        f4 = ~f4 &amp; 0xFFFFFFFF

        yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

        self.lfsr0 = s0
        self.lfsr1 = s1
        self.lfsr2 = s2
        self.lfsr3 = s3
        self.lfsr4 = s4
        self.lfsr5 = s5
        self.lfsr6 = s6
        self.lfsr7 = s7
        self.lfsr8 = s8
        self.lfsr9 = s9
        self.fsmR1 = r1
        self.fsmR2 = r2

    def __iter__(self):
        while True:
            yield from self.generate_block()


class sosemanuk(StreamCipherUnit):

    def __init__(
        self, key, stateful=False, discard=0,
        nonce: Param[buf, Arg(help=&#39;The nonce. Default is empty, which is equivalent to 16 null bytes.&#39;)] = B&#39;&#39;,
    ):
        super().__init__(key=key, nonce=nonce, stateful=stateful, discard=discard)

    def keystream(self):
        yield from Sosemanuk(self.args.key, self.args.nonce)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk"><code class="flex name class">
<span>class <span class="ident">Sosemanuk</span></span>
<span>(</span><span>key, nonce)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/2c887cef6f2560025a1ac871b535f0d84fa3f321/refinery/units/crypto/cipher/sosemanuk.py#L11-L2217" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Sosemanuk:

    lfsr0: int
    lfsr1: int
    lfsr2: int
    lfsr3: int
    lfsr4: int
    lfsr5: int
    lfsr6: int
    lfsr7: int
    lfsr8: int
    lfsr9: int
    fsmR1: int
    fsmR2: int

    def __init__(self, key: bytearray, nonce: bytearray):
        self.mul_alpha = array(&#39;I&#39;)
        self.div_alpha = array(&#39;I&#39;)
        self.serpent24_sub_keys = [0] * 100
        expb = bytearray(0x100)
        logb = bytearray(0x100)
        x = 1
        for i in range(0xFF):
            expb[i] = x
            x &lt;&lt;= 1
            if x &gt; 0xFF:
                x ^= 0x1A9
        expb[0xFF] = 0
        assert set(expb) == set(range(0x100))
        for i in range(0x100):
            logb[expb[i]] = i
        self.mul_alpha.append(0x00000000)
        self.div_alpha.append(0x00000000)
        for x in range(1, 0x100):
            ma, da, ex = 0, 0, logb[x]
            ma |= expb[(ex + 0x17) % 255] &lt;&lt; 0x18
            ma |= expb[(ex + 0xF5) % 255] &lt;&lt; 0x10
            ma |= expb[(ex + 0x30) % 255] &lt;&lt; 0x08
            ma |= expb[(ex + 0xEF) % 255] &lt;&lt; 0x00
            da |= expb[(ex + 0x10) % 255] &lt;&lt; 0x18
            da |= expb[(ex + 0x27) % 255] &lt;&lt; 0x10
            da |= expb[(ex + 0x06) % 255] &lt;&lt; 0x08
            da |= expb[(ex + 0x40) % 255] &lt;&lt; 0x00
            self.mul_alpha.append(ma)
            self.div_alpha.append(da)

        self._set_secret(key)
        self._set_vector(nonce)

    def _set_secret(self, key: bytearray):
        n = len(key)
        if not 1 &lt;= n &lt;= 32:
            raise ValueError(&#39;bad key length&#39;)
        lkey = bytearray(32)
        lkey[:n] = key
        if n &lt; 32:
            lkey[n] = 0x01

        i = 0

        w0, w1, w2, w3, w4, w5, w6, w7 = chunks.unpack(lkey, 4)
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779b9
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779b8
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779bb
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779ba
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r0
        r0 |= r3
        r3 ^= r1
        r1 &amp;= r4
        r4 ^= r2
        r2 ^= r3
        r3 &amp;= r0
        r4 |= r1
        r3 ^= r4
        r0 ^= r1
        r4 &amp;= r0
        r1 ^= r3
        r4 ^= r2
        r1 |= r0
        r1 ^= r2
        r0 ^= r3
        r2 = r1
        r1 |= r3
        r1 ^= r0
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779bd
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779bc
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779bf
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779be
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r4 = r0
        r0 &amp;= r2
        r0 ^= r3
        r2 ^= r1
        r2 ^= r0
        r3 |= r4
        r3 ^= r1
        r4 ^= r2
        r1 = r3
        r3 |= r4
        r3 ^= r0
        r0 &amp;= r1
        r4 ^= r0
        r1 ^= r3
        r1 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779b1
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779b0
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779b3
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779b2
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r0
        r0 &amp;= r1
        r2 ^= r0
        r0 |= r3
        r3 ^= r2
        r1 ^= r0
        r0 ^= r4
        r4 |= r1
        r1 ^= r3
        r2 |= r0
        r2 &amp;= r4
        r0 ^= r1
        r1 &amp;= r2
        r1 ^= r0
        r0 &amp;= r2
        r0 ^= r4
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779b5
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779b4
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779b7
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779b6
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r4 ^= r2
        r1 ^= r0
        r0 |= r3
        r0 ^= r4
        r4 ^= r3
        r3 ^= r2
        r2 |= r1
        r2 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        r4 |= r1
        r1 ^= r3
        r1 ^= r4
        r3 |= r0
        r1 ^= r3
        r4 ^= r3
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779a9
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779a8
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779ab
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779aa
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r1
        r1 |= r2
        r1 ^= r3
        r4 ^= r2
        r2 ^= r1
        r3 |= r4
        r3 &amp;= r0
        r4 ^= r2
        r3 ^= r1
        r1 |= r4
        r1 ^= r0
        r0 |= r4
        r0 ^= r2
        r1 ^= r4
        r2 ^= r1
        r1 &amp;= r0
        r1 ^= r4
        r2 = ~r2 &amp; 0xFFFFFFFF
        r2 |= r0
        r4 ^= r2
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779ad
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779ac
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779af
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779ae
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r3
        r3 &amp;= r0
        r0 ^= r4
        r3 ^= r2
        r2 |= r4
        r1 ^= r3
        r2 ^= r0
        r0 |= r1
        r2 ^= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r4 ^= r3
        r4 ^= r0
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 &amp;= r4
        r2 ^= r3
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779a1
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779a0
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779a3
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779a2
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 ^= r1
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r4 = r1
        r1 &amp;= r0
        r2 ^= r3
        r1 ^= r2
        r2 |= r4
        r4 ^= r3
        r3 &amp;= r1
        r3 ^= r0
        r4 ^= r1
        r4 ^= r2
        r2 ^= r0
        r0 &amp;= r3
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 ^= r4
        r4 |= r3
        r2 ^= r4
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779a5
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779a4
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779a7
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779a6
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 ^= r3
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r1 ^= r2
        r4 ^= r3
        r0 ^= r4
        r2 &amp;= r4
        r2 ^= r0
        r0 &amp;= r1
        r3 ^= r0
        r4 |= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r2 &amp;= r3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r4 ^= r2
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e377999
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e377998
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e37799b
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e37799a
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r0
        r0 |= r3
        r3 ^= r1
        r1 &amp;= r4
        r4 ^= r2
        r2 ^= r3
        r3 &amp;= r0
        r4 |= r1
        r3 ^= r4
        r0 ^= r1
        r4 &amp;= r0
        r1 ^= r3
        r4 ^= r2
        r1 |= r0
        r1 ^= r2
        r0 ^= r3
        r2 = r1
        r1 |= r3
        r1 ^= r0
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e37799d
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e37799c
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e37799f
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e37799e
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r4 = r0
        r0 &amp;= r2
        r0 ^= r3
        r2 ^= r1
        r2 ^= r0
        r3 |= r4
        r3 ^= r1
        r4 ^= r2
        r1 = r3
        r3 |= r4
        r3 ^= r0
        r0 &amp;= r1
        r4 ^= r0
        r1 ^= r3
        r1 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e377991
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e377990
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e377993
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e377992
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r0
        r0 &amp;= r1
        r2 ^= r0
        r0 |= r3
        r3 ^= r2
        r1 ^= r0
        r0 ^= r4
        r4 |= r1
        r1 ^= r3
        r2 |= r0
        r2 &amp;= r4
        r0 ^= r1
        r1 &amp;= r2
        r1 ^= r0
        r0 &amp;= r2
        r0 ^= r4
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e377995
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e377994
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e377997
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e377996
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r4 ^= r2
        r1 ^= r0
        r0 |= r3
        r0 ^= r4
        r4 ^= r3
        r3 ^= r2
        r2 |= r1
        r2 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        r4 |= r1
        r1 ^= r3
        r1 ^= r4
        r3 |= r0
        r1 ^= r3
        r4 ^= r3
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e377989
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e377988
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e37798b
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e37798a
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r1
        r1 |= r2
        r1 ^= r3
        r4 ^= r2
        r2 ^= r1
        r3 |= r4
        r3 &amp;= r0
        r4 ^= r2
        r3 ^= r1
        r1 |= r4
        r1 ^= r0
        r0 |= r4
        r0 ^= r2
        r1 ^= r4
        r2 ^= r1
        r1 &amp;= r0
        r1 ^= r4
        r2 = ~r2 &amp; 0xFFFFFFFF
        r2 |= r0
        r4 ^= r2
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e37798d
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e37798c
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e37798f
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e37798e
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r3
        r3 &amp;= r0
        r0 ^= r4
        r3 ^= r2
        r2 |= r4
        r1 ^= r3
        r2 ^= r0
        r0 |= r1
        r2 ^= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r4 ^= r3
        r4 ^= r0
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 &amp;= r4
        r2 ^= r3
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e377981
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e377980
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e377983
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e377982
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 ^= r1
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r4 = r1
        r1 &amp;= r0
        r2 ^= r3
        r1 ^= r2
        r2 |= r4
        r4 ^= r3
        r3 &amp;= r1
        r3 ^= r0
        r4 ^= r1
        r4 ^= r2
        r2 ^= r0
        r0 &amp;= r3
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 ^= r4
        r4 |= r3
        r2 ^= r4
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e377985
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e377984
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e377987
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e377986
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 ^= r3
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r1 ^= r2
        r4 ^= r3
        r0 ^= r4
        r2 &amp;= r4
        r2 ^= r0
        r0 &amp;= r1
        r3 ^= r0
        r4 |= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r2 &amp;= r3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r4 ^= r2
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779f9
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779f8
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779fb
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779fa
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r0
        r0 |= r3
        r3 ^= r1
        r1 &amp;= r4
        r4 ^= r2
        r2 ^= r3
        r3 &amp;= r0
        r4 |= r1
        r3 ^= r4
        r0 ^= r1
        r4 &amp;= r0
        r1 ^= r3
        r4 ^= r2
        r1 |= r0
        r1 ^= r2
        r0 ^= r3
        r2 = r1
        r1 |= r3
        r1 ^= r0
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779fd
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779fc
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779ff
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779fe
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r4 = r0
        r0 &amp;= r2
        r0 ^= r3
        r2 ^= r1
        r2 ^= r0
        r3 |= r4
        r3 ^= r1
        r4 ^= r2
        r1 = r3
        r3 |= r4
        r3 ^= r0
        r0 &amp;= r1
        r4 ^= r0
        r1 ^= r3
        r1 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779f1
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779f0
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779f3
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779f2
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r0
        r0 &amp;= r1
        r2 ^= r0
        r0 |= r3
        r3 ^= r2
        r1 ^= r0
        r0 ^= r4
        r4 |= r1
        r1 ^= r3
        r2 |= r0
        r2 &amp;= r4
        r0 ^= r1
        r1 &amp;= r2
        r1 ^= r0
        r0 &amp;= r2
        r0 ^= r4
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779f5
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779f4
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779f7
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779f6
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r4 ^= r2
        r1 ^= r0
        r0 |= r3
        r0 ^= r4
        r4 ^= r3
        r3 ^= r2
        r2 |= r1
        r2 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        r4 |= r1
        r1 ^= r3
        r1 ^= r4
        r3 |= r0
        r1 ^= r3
        r4 ^= r3
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779e9
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779e8
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779eb
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779ea
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r1
        r1 |= r2
        r1 ^= r3
        r4 ^= r2
        r2 ^= r1
        r3 |= r4
        r3 &amp;= r0
        r4 ^= r2
        r3 ^= r1
        r1 |= r4
        r1 ^= r0
        r0 |= r4
        r0 ^= r2
        r1 ^= r4
        r2 ^= r1
        r1 &amp;= r0
        r1 ^= r4
        r2 = ~r2 &amp; 0xFFFFFFFF
        r2 |= r0
        r4 ^= r2
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779ed
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779ec
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779ef
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779ee
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r3
        r3 &amp;= r0
        r0 ^= r4
        r3 ^= r2
        r2 |= r4
        r1 ^= r3
        r2 ^= r0
        r0 |= r1
        r2 ^= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r4 ^= r3
        r4 ^= r0
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 &amp;= r4
        r2 ^= r3
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779e1
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779e0
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779e3
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779e2
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r0 ^= r1
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r4 = r1
        r1 &amp;= r0
        r2 ^= r3
        r1 ^= r2
        r2 |= r4
        r4 ^= r3
        r3 &amp;= r1
        r3 ^= r0
        r4 ^= r1
        r4 ^= r2
        r2 ^= r0
        r0 &amp;= r3
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 ^= r4
        r4 |= r3
        r2 ^= r4
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        tt = w4 ^ w7 ^ w1 ^ w3 ^ 0x9e3779e5
        w4 = rotl32(tt, 11)
        tt = w5 ^ w0 ^ w2 ^ w4 ^ 0x9e3779e4
        w5 = rotl32(tt, 11)
        tt = w6 ^ w1 ^ w3 ^ w5 ^ 0x9e3779e7
        w6 = rotl32(tt, 11)
        tt = w7 ^ w2 ^ w4 ^ w6 ^ 0x9e3779e6
        w7 = rotl32(tt, 11)
        r0 = w4
        r1 = w5
        r2 = w6
        r3 = w7
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r2 ^= r3
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r1 ^= r2
        r4 ^= r3
        r0 ^= r4
        r2 &amp;= r4
        r2 ^= r0
        r0 &amp;= r1
        r3 ^= r0
        r4 |= r1
        r4 ^= r0
        r0 |= r3
        r0 ^= r2
        r2 &amp;= r3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r4 ^= r2
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1
        self.serpent24_sub_keys[i] = r0
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        tt = w0 ^ w3 ^ w5 ^ w7 ^ 0x9e3779d9
        w0 = rotl32(tt, 11)
        tt = w1 ^ w4 ^ w6 ^ w0 ^ 0x9e3779d8
        w1 = rotl32(tt, 11)
        tt = w2 ^ w5 ^ w7 ^ w1 ^ 0x9e3779db
        w2 = rotl32(tt, 11)
        tt = w3 ^ w6 ^ w0 ^ w2 ^ 0x9e3779da
        w3 = rotl32(tt, 11)
        r0 = w0
        r1 = w1
        r2 = w2
        r3 = w3
        r4 = r0
        r0 |= r3
        r3 ^= r1
        r1 &amp;= r4
        r4 ^= r2
        r2 ^= r3
        r3 &amp;= r0
        r4 |= r1
        r3 ^= r4
        r0 ^= r1
        r4 &amp;= r0
        r1 ^= r3
        r4 ^= r2
        r1 |= r0
        r1 ^= r2
        r0 ^= r3
        r2 = r1
        r1 |= r3
        r1 ^= r0
        self.serpent24_sub_keys[i] = r1
        i += 1
        self.serpent24_sub_keys[i] = r2
        i += 1
        self.serpent24_sub_keys[i] = r3
        i += 1
        self.serpent24_sub_keys[i] = r4
        i += 1

    def _set_vector(self, nonce: bytearray):
        n = len(nonce)
        if n &gt; 16:
            raise ValueError(&#39;bad IV length&#39;)
        pnonce = bytearray(16)
        pnonce[:n] = nonce

        r0, r1, r2, r3 = chunks.unpack(pnonce, 4)

        r0 ^= self.serpent24_sub_keys[0]
        r1 ^= self.serpent24_sub_keys[0 + 1]
        r2 ^= self.serpent24_sub_keys[0 + 2]
        r3 ^= self.serpent24_sub_keys[0 + 3]
        r3 ^= r0
        r4 = r1
        r1 &amp;= r3
        r4 ^= r2
        r1 ^= r0
        r0 |= r3
        r0 ^= r4
        r4 ^= r3
        r3 ^= r2
        r2 |= r1
        r2 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        r4 |= r1
        r1 ^= r3
        r1 ^= r4
        r3 |= r0
        r1 ^= r3
        r4 ^= r3
        r1 = rotl32(r1, 13)
        r2 = rotl32(r2, 3)
        r4 = r4 ^ r1 ^ r2
        r0 = r0 ^ r2 ^ (r1 &lt;&lt; 3)
        r0 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 1)
        r0 = rotl32(r0, 7)
        r1 = r1 ^ r4 ^ r0
        r2 = r2 ^ r0 ^ (r4 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r2 = rotl32(r2, 22)
        r1 ^= self.serpent24_sub_keys[4]
        r4 ^= self.serpent24_sub_keys[4 + 1]
        r2 ^= self.serpent24_sub_keys[4 + 2]
        r0 ^= self.serpent24_sub_keys[4 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r3 = r1
        r1 &amp;= r4
        r2 ^= r1
        r1 |= r0
        r0 ^= r2
        r4 ^= r1
        r1 ^= r3
        r3 |= r4
        r4 ^= r0
        r2 |= r1
        r2 &amp;= r3
        r1 ^= r4
        r4 &amp;= r2
        r4 ^= r1
        r1 &amp;= r2
        r1 ^= r3
        r2 = rotl32(r2, 13)
        r0 = rotl32(r0, 3)
        r1 = r1 ^ r2 ^ r0
        r4 = r4 ^ r0 ^ (r2 &lt;&lt; 3)
        r4 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r4 = rotl32(r4, 7)
        r2 = r2 ^ r1 ^ r4
        r0 = r0 ^ r4 ^ (r1 &lt;&lt; 7)
        r0 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 5)
        r0 = rotl32(r0, 22)
        r2 ^= self.serpent24_sub_keys[8]
        r1 ^= self.serpent24_sub_keys[8 + 1]
        r0 ^= self.serpent24_sub_keys[8 + 2]
        r4 ^= self.serpent24_sub_keys[8 + 3]
        r3 = r2
        r2 &amp;= r0
        r2 ^= r4
        r0 ^= r1
        r0 ^= r2
        r4 |= r3
        r4 ^= r1
        r3 ^= r0
        r1 = r4
        r4 |= r3
        r4 ^= r2
        r2 &amp;= r1
        r3 ^= r2
        r1 ^= r4
        r1 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r0 = rotl32(r0, 13)
        r1 = rotl32(r1, 3)
        r4 = r4 ^ r0 ^ r1
        r3 = r3 ^ r1 ^ (r0 &lt;&lt; 3)
        r3 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 1)
        r3 = rotl32(r3, 7)
        r0 = r0 ^ r4 ^ r3
        r1 = r1 ^ r3 ^ (r4 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 5)
        r1 = rotl32(r1, 22)
        r0 ^= self.serpent24_sub_keys[12]
        r4 ^= self.serpent24_sub_keys[12 + 1]
        r1 ^= self.serpent24_sub_keys[12 + 2]
        r3 ^= self.serpent24_sub_keys[12 + 3]
        r2 = r0
        r0 |= r3
        r3 ^= r4
        r4 &amp;= r2
        r2 ^= r1
        r1 ^= r3
        r3 &amp;= r0
        r2 |= r4
        r3 ^= r2
        r0 ^= r4
        r2 &amp;= r0
        r4 ^= r3
        r2 ^= r1
        r4 |= r0
        r4 ^= r1
        r0 ^= r3
        r1 = r4
        r4 |= r3
        r4 ^= r0
        r4 = rotl32(r4, 13)
        r3 = rotl32(r3, 3)
        r1 = r1 ^ r4 ^ r3
        r2 = r2 ^ r3 ^ (r4 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r2 = rotl32(r2, 7)
        r4 = r4 ^ r1 ^ r2
        r3 = r3 ^ r2 ^ (r1 &lt;&lt; 7)
        r3 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 5)
        r3 = rotl32(r3, 22)
        r4 ^= self.serpent24_sub_keys[16]
        r1 ^= self.serpent24_sub_keys[16 + 1]
        r3 ^= self.serpent24_sub_keys[16 + 2]
        r2 ^= self.serpent24_sub_keys[16 + 3]
        r1 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r3 ^= r2
        r2 ^= r4
        r0 = r1
        r1 &amp;= r2
        r1 ^= r3
        r0 ^= r2
        r4 ^= r0
        r3 &amp;= r0
        r3 ^= r4
        r4 &amp;= r1
        r2 ^= r4
        r0 |= r1
        r0 ^= r4
        r4 |= r2
        r4 ^= r3
        r3 &amp;= r2
        r4 = ~r4 &amp; 0xFFFFFFFF
        r0 ^= r3
        r1 = rotl32(r1, 13)
        r4 = rotl32(r4, 3)
        r0 = r0 ^ r1 ^ r4
        r2 = r2 ^ r4 ^ (r1 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 1)
        r2 = rotl32(r2, 7)
        r1 = r1 ^ r0 ^ r2
        r4 = r4 ^ r2 ^ (r0 &lt;&lt; 7)
        r4 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r4 = rotl32(r4, 22)
        r1 ^= self.serpent24_sub_keys[20]
        r0 ^= self.serpent24_sub_keys[20 + 1]
        r4 ^= self.serpent24_sub_keys[20 + 2]
        r2 ^= self.serpent24_sub_keys[20 + 3]
        r1 ^= r0
        r0 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r3 = r0
        r0 &amp;= r1
        r4 ^= r2
        r0 ^= r4
        r4 |= r3
        r3 ^= r2
        r2 &amp;= r0
        r2 ^= r1
        r3 ^= r0
        r3 ^= r4
        r4 ^= r1
        r1 &amp;= r2
        r4 = ~r4 &amp; 0xFFFFFFFF
        r1 ^= r3
        r3 |= r2
        r4 ^= r3
        r0 = rotl32(r0, 13)
        r1 = rotl32(r1, 3)
        r2 = r2 ^ r0 ^ r1
        r4 = r4 ^ r1 ^ (r0 &lt;&lt; 3)
        r4 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r4 = rotl32(r4, 7)
        r0 = r0 ^ r2 ^ r4
        r1 = r1 ^ r4 ^ (r2 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 5)
        r1 = rotl32(r1, 22)
        r0 ^= self.serpent24_sub_keys[24]
        r2 ^= self.serpent24_sub_keys[24 + 1]
        r1 ^= self.serpent24_sub_keys[24 + 2]
        r4 ^= self.serpent24_sub_keys[24 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r3 = r4
        r4 &amp;= r0
        r0 ^= r3
        r4 ^= r1
        r1 |= r3
        r2 ^= r4
        r1 ^= r0
        r0 |= r2
        r1 ^= r2
        r3 ^= r0
        r0 |= r4
        r0 ^= r1
        r3 ^= r4
        r3 ^= r0
        r4 = ~r4 &amp; 0xFFFFFFFF
        r1 &amp;= r3
        r1 ^= r4
        r0 = rotl32(r0, 13)
        r3 = rotl32(r3, 3)
        r2 = r2 ^ r0 ^ r3
        r1 = r1 ^ r3 ^ (r0 &lt;&lt; 3)
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r1 = rotl32(r1, 7)
        r0 = r0 ^ r2 ^ r1
        r3 = r3 ^ r1 ^ (r2 &lt;&lt; 7)
        r3 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 5)
        r3 = rotl32(r3, 22)
        r0 ^= self.serpent24_sub_keys[28]
        r2 ^= self.serpent24_sub_keys[28 + 1]
        r3 ^= self.serpent24_sub_keys[28 + 2]
        r1 ^= self.serpent24_sub_keys[28 + 3]
        r4 = r2
        r2 |= r3
        r2 ^= r1
        r4 ^= r3
        r3 ^= r2
        r1 |= r4
        r1 &amp;= r0
        r4 ^= r3
        r1 ^= r2
        r2 |= r4
        r2 ^= r0
        r0 |= r4
        r0 ^= r3
        r2 ^= r4
        r3 ^= r2
        r2 &amp;= r0
        r2 ^= r4
        r3 = ~r3 &amp; 0xFFFFFFFF
        r3 |= r0
        r4 ^= r3
        r4 = rotl32(r4, 13)
        r2 = rotl32(r2, 3)
        r1 = r1 ^ r4 ^ r2
        r0 = r0 ^ r2 ^ (r4 &lt;&lt; 3)
        r0 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r0 = rotl32(r0, 7)
        r4 = r4 ^ r1 ^ r0
        r2 = r2 ^ r0 ^ (r1 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 5)
        r2 = rotl32(r2, 22)
        r4 ^= self.serpent24_sub_keys[32]
        r1 ^= self.serpent24_sub_keys[32 + 1]
        r2 ^= self.serpent24_sub_keys[32 + 2]
        r0 ^= self.serpent24_sub_keys[32 + 3]
        r0 ^= r4
        r3 = r1
        r1 &amp;= r0
        r3 ^= r2
        r1 ^= r4
        r4 |= r0
        r4 ^= r3
        r3 ^= r0
        r0 ^= r2
        r2 |= r1
        r2 ^= r3
        r3 = ~r3 &amp; 0xFFFFFFFF
        r3 |= r1
        r1 ^= r0
        r1 ^= r3
        r0 |= r4
        r1 ^= r0
        r3 ^= r0
        r1 = rotl32(r1, 13)
        r2 = rotl32(r2, 3)
        r3 = r3 ^ r1 ^ r2
        r4 = r4 ^ r2 ^ (r1 &lt;&lt; 3)
        r4 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 1)
        r4 = rotl32(r4, 7)
        r1 = r1 ^ r3 ^ r4
        r2 = r2 ^ r4 ^ (r3 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r2 = rotl32(r2, 22)
        r1 ^= self.serpent24_sub_keys[36]
        r3 ^= self.serpent24_sub_keys[36 + 1]
        r2 ^= self.serpent24_sub_keys[36 + 2]
        r4 ^= self.serpent24_sub_keys[36 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 = r1
        r1 &amp;= r3
        r2 ^= r1
        r1 |= r4
        r4 ^= r2
        r3 ^= r1
        r1 ^= r0
        r0 |= r3
        r3 ^= r4
        r2 |= r1
        r2 &amp;= r0
        r1 ^= r3
        r3 &amp;= r2
        r3 ^= r1
        r1 &amp;= r2
        r1 ^= r0
        r2 = rotl32(r2, 13)
        r4 = rotl32(r4, 3)
        r1 = r1 ^ r2 ^ r4
        r3 = r3 ^ r4 ^ (r2 &lt;&lt; 3)
        r3 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r3 = rotl32(r3, 7)
        r2 = r2 ^ r1 ^ r3
        r4 = r4 ^ r3 ^ (r1 &lt;&lt; 7)
        r4 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 5)
        r4 = rotl32(r4, 22)
        r2 ^= self.serpent24_sub_keys[40]
        r1 ^= self.serpent24_sub_keys[40 + 1]
        r4 ^= self.serpent24_sub_keys[40 + 2]
        r3 ^= self.serpent24_sub_keys[40 + 3]
        r0 = r2
        r2 &amp;= r4
        r2 ^= r3
        r4 ^= r1
        r4 ^= r2
        r3 |= r0
        r3 ^= r1
        r0 ^= r4
        r1 = r3
        r3 |= r0
        r3 ^= r2
        r2 &amp;= r1
        r0 ^= r2
        r1 ^= r3
        r1 ^= r0
        r0 = ~r0 &amp; 0xFFFFFFFF
        r4 = rotl32(r4, 13)
        r1 = rotl32(r1, 3)
        r3 = r3 ^ r4 ^ r1
        r0 = r0 ^ r1 ^ (r4 &lt;&lt; 3)
        r0 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 1)
        r0 = rotl32(r0, 7)
        r4 = r4 ^ r3 ^ r0
        r1 = r1 ^ r0 ^ (r3 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 5)
        r1 = rotl32(r1, 22)
        r4 ^= self.serpent24_sub_keys[44]
        r3 ^= self.serpent24_sub_keys[44 + 1]
        r1 ^= self.serpent24_sub_keys[44 + 2]
        r0 ^= self.serpent24_sub_keys[44 + 3]
        r2 = r4
        r4 |= r0
        r0 ^= r3
        r3 &amp;= r2
        r2 ^= r1
        r1 ^= r0
        r0 &amp;= r4
        r2 |= r3
        r0 ^= r2
        r4 ^= r3
        r2 &amp;= r4
        r3 ^= r0
        r2 ^= r1
        r3 |= r4
        r3 ^= r1
        r4 ^= r0
        r1 = r3
        r3 |= r0
        r3 ^= r4
        r3 = rotl32(r3, 13)
        r0 = rotl32(r0, 3)
        r1 = r1 ^ r3 ^ r0
        r2 = r2 ^ r0 ^ (r3 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r2 = rotl32(r2, 7)
        r3 = r3 ^ r1 ^ r2
        r0 = r0 ^ r2 ^ (r1 &lt;&lt; 7)
        r0 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 5)
        r0 = rotl32(r0, 22)
        self.lfsr9 = r3
        self.lfsr8 = r1
        self.lfsr7 = r0
        self.lfsr6 = r2
        r3 ^= self.serpent24_sub_keys[48]
        r1 ^= self.serpent24_sub_keys[48 + 1]
        r0 ^= self.serpent24_sub_keys[48 + 2]
        r2 ^= self.serpent24_sub_keys[48 + 3]
        r1 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 ^= r2
        r2 ^= r3
        r4 = r1
        r1 &amp;= r2
        r1 ^= r0
        r4 ^= r2
        r3 ^= r4
        r0 &amp;= r4
        r0 ^= r3
        r3 &amp;= r1
        r2 ^= r3
        r4 |= r1
        r4 ^= r3
        r3 |= r2
        r3 ^= r0
        r0 &amp;= r2
        r3 = ~r3 &amp; 0xFFFFFFFF
        r4 ^= r0
        r1 = rotl32(r1, 13)
        r3 = rotl32(r3, 3)
        r4 = r4 ^ r1 ^ r3
        r2 = r2 ^ r3 ^ (r1 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 1)
        r2 = rotl32(r2, 7)
        r1 = r1 ^ r4 ^ r2
        r3 = r3 ^ r2 ^ (r4 &lt;&lt; 7)
        r3 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r3 = rotl32(r3, 22)
        r1 ^= self.serpent24_sub_keys[52]
        r4 ^= self.serpent24_sub_keys[52 + 1]
        r3 ^= self.serpent24_sub_keys[52 + 2]
        r2 ^= self.serpent24_sub_keys[52 + 3]
        r1 ^= r4
        r4 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r0 = r4
        r4 &amp;= r1
        r3 ^= r2
        r4 ^= r3
        r3 |= r0
        r0 ^= r2
        r2 &amp;= r4
        r2 ^= r1
        r0 ^= r4
        r0 ^= r3
        r3 ^= r1
        r1 &amp;= r2
        r3 = ~r3 &amp; 0xFFFFFFFF
        r1 ^= r0
        r0 |= r2
        r3 ^= r0
        r4 = rotl32(r4, 13)
        r1 = rotl32(r1, 3)
        r2 = r2 ^ r4 ^ r1
        r3 = r3 ^ r1 ^ (r4 &lt;&lt; 3)
        r3 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r3 = rotl32(r3, 7)
        r4 = r4 ^ r2 ^ r3
        r1 = r1 ^ r3 ^ (r2 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 5)
        r1 = rotl32(r1, 22)
        r4 ^= self.serpent24_sub_keys[56]
        r2 ^= self.serpent24_sub_keys[56 + 1]
        r1 ^= self.serpent24_sub_keys[56 + 2]
        r3 ^= self.serpent24_sub_keys[56 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r0 = r3
        r3 &amp;= r4
        r4 ^= r0
        r3 ^= r1
        r1 |= r0
        r2 ^= r3
        r1 ^= r4
        r4 |= r2
        r1 ^= r2
        r0 ^= r4
        r4 |= r3
        r4 ^= r1
        r0 ^= r3
        r0 ^= r4
        r3 = ~r3 &amp; 0xFFFFFFFF
        r1 &amp;= r0
        r1 ^= r3
        r4 = rotl32(r4, 13)
        r0 = rotl32(r0, 3)
        r2 = r2 ^ r4 ^ r0
        r1 = r1 ^ r0 ^ (r4 &lt;&lt; 3)
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r1 = rotl32(r1, 7)
        r4 = r4 ^ r2 ^ r1
        r0 = r0 ^ r1 ^ (r2 &lt;&lt; 7)
        r0 &amp;= 0xFFFFFFFF
        r4 = rotl32(r4, 5)
        r0 = rotl32(r0, 22)
        r4 ^= self.serpent24_sub_keys[60]
        r2 ^= self.serpent24_sub_keys[60 + 1]
        r0 ^= self.serpent24_sub_keys[60 + 2]
        r1 ^= self.serpent24_sub_keys[60 + 3]
        r3 = r2
        r2 |= r0
        r2 ^= r1
        r3 ^= r0
        r0 ^= r2
        r1 |= r3
        r1 &amp;= r4
        r3 ^= r0
        r1 ^= r2
        r2 |= r3
        r2 ^= r4
        r4 |= r3
        r4 ^= r0
        r2 ^= r3
        r0 ^= r2
        r2 &amp;= r4
        r2 ^= r3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r0 |= r4
        r3 ^= r0
        r3 = rotl32(r3, 13)
        r2 = rotl32(r2, 3)
        r1 = r1 ^ r3 ^ r2
        r4 = r4 ^ r2 ^ (r3 &lt;&lt; 3)
        r4 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r4 = rotl32(r4, 7)
        r3 = r3 ^ r1 ^ r4
        r2 = r2 ^ r4 ^ (r1 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 5)
        r2 = rotl32(r2, 22)
        r3 ^= self.serpent24_sub_keys[64]
        r1 ^= self.serpent24_sub_keys[64 + 1]
        r2 ^= self.serpent24_sub_keys[64 + 2]
        r4 ^= self.serpent24_sub_keys[64 + 3]
        r4 ^= r3
        r0 = r1
        r1 &amp;= r4
        r0 ^= r2
        r1 ^= r3
        r3 |= r4
        r3 ^= r0
        r0 ^= r4
        r4 ^= r2
        r2 |= r1
        r2 ^= r0
        r0 = ~r0 &amp; 0xFFFFFFFF
        r0 |= r1
        r1 ^= r4
        r1 ^= r0
        r4 |= r3
        r1 ^= r4
        r0 ^= r4
        r1 = rotl32(r1, 13)
        r2 = rotl32(r2, 3)
        r0 = r0 ^ r1 ^ r2
        r3 = r3 ^ r2 ^ (r1 &lt;&lt; 3)
        r3 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 1)
        r3 = rotl32(r3, 7)
        r1 = r1 ^ r0 ^ r3
        r2 = r2 ^ r3 ^ (r0 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r2 = rotl32(r2, 22)
        r1 ^= self.serpent24_sub_keys[68]
        r0 ^= self.serpent24_sub_keys[68 + 1]
        r2 ^= self.serpent24_sub_keys[68 + 2]
        r3 ^= self.serpent24_sub_keys[68 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r1
        r1 &amp;= r0
        r2 ^= r1
        r1 |= r3
        r3 ^= r2
        r0 ^= r1
        r1 ^= r4
        r4 |= r0
        r0 ^= r3
        r2 |= r1
        r2 &amp;= r4
        r1 ^= r0
        r0 &amp;= r2
        r0 ^= r1
        r1 &amp;= r2
        r1 ^= r4
        r2 = rotl32(r2, 13)
        r3 = rotl32(r3, 3)
        r1 = r1 ^ r2 ^ r3
        r0 = r0 ^ r3 ^ (r2 &lt;&lt; 3)
        r0 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r0 = rotl32(r0, 7)
        r2 = r2 ^ r1 ^ r0
        r3 = r3 ^ r0 ^ (r1 &lt;&lt; 7)
        r3 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 5)
        r3 = rotl32(r3, 22)
        self.fsmR1 = r2
        self.lfsr4 = r1
        self.fsmR2 = r3
        self.lfsr5 = r0
        r2 ^= self.serpent24_sub_keys[72]
        r1 ^= self.serpent24_sub_keys[72 + 1]
        r3 ^= self.serpent24_sub_keys[72 + 2]
        r0 ^= self.serpent24_sub_keys[72 + 3]
        r4 = r2
        r2 &amp;= r3
        r2 ^= r0
        r3 ^= r1
        r3 ^= r2
        r0 |= r4
        r0 ^= r1
        r4 ^= r3
        r1 = r0
        r0 |= r4
        r0 ^= r2
        r2 &amp;= r1
        r4 ^= r2
        r1 ^= r0
        r1 ^= r4
        r4 = ~r4 &amp; 0xFFFFFFFF
        r3 = rotl32(r3, 13)
        r1 = rotl32(r1, 3)
        r0 = r0 ^ r3 ^ r1
        r4 = r4 ^ r1 ^ (r3 &lt;&lt; 3)
        r4 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 1)
        r4 = rotl32(r4, 7)
        r3 = r3 ^ r0 ^ r4
        r1 = r1 ^ r4 ^ (r0 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 5)
        r1 = rotl32(r1, 22)
        r3 ^= self.serpent24_sub_keys[76]
        r0 ^= self.serpent24_sub_keys[76 + 1]
        r1 ^= self.serpent24_sub_keys[76 + 2]
        r4 ^= self.serpent24_sub_keys[76 + 3]
        r2 = r3
        r3 |= r4
        r4 ^= r0
        r0 &amp;= r2
        r2 ^= r1
        r1 ^= r4
        r4 &amp;= r3
        r2 |= r0
        r4 ^= r2
        r3 ^= r0
        r2 &amp;= r3
        r0 ^= r4
        r2 ^= r1
        r0 |= r3
        r0 ^= r1
        r3 ^= r4
        r1 = r0
        r0 |= r4
        r0 ^= r3
        r0 = rotl32(r0, 13)
        r4 = rotl32(r4, 3)
        r1 = r1 ^ r0 ^ r4
        r2 = r2 ^ r4 ^ (r0 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r2 = rotl32(r2, 7)
        r0 = r0 ^ r1 ^ r2
        r4 = r4 ^ r2 ^ (r1 &lt;&lt; 7)
        r4 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 5)
        r4 = rotl32(r4, 22)
        r0 ^= self.serpent24_sub_keys[80]
        r1 ^= self.serpent24_sub_keys[80 + 1]
        r4 ^= self.serpent24_sub_keys[80 + 2]
        r2 ^= self.serpent24_sub_keys[80 + 3]
        r1 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 ^= r2
        r2 ^= r0
        r3 = r1
        r1 &amp;= r2
        r1 ^= r4
        r3 ^= r2
        r0 ^= r3
        r4 &amp;= r3
        r4 ^= r0
        r0 &amp;= r1
        r2 ^= r0
        r3 |= r1
        r3 ^= r0
        r0 |= r2
        r0 ^= r4
        r4 &amp;= r2
        r0 = ~r0 &amp; 0xFFFFFFFF
        r3 ^= r4
        r1 = rotl32(r1, 13)
        r0 = rotl32(r0, 3)
        r3 = r3 ^ r1 ^ r0
        r2 = r2 ^ r0 ^ (r1 &lt;&lt; 3)
        r2 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 1)
        r2 = rotl32(r2, 7)
        r1 = r1 ^ r3 ^ r2
        r0 = r0 ^ r2 ^ (r3 &lt;&lt; 7)
        r0 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 5)
        r0 = rotl32(r0, 22)
        r1 ^= self.serpent24_sub_keys[84]
        r3 ^= self.serpent24_sub_keys[84 + 1]
        r0 ^= self.serpent24_sub_keys[84 + 2]
        r2 ^= self.serpent24_sub_keys[84 + 3]
        r1 ^= r3
        r3 ^= r2
        r2 = ~r2 &amp; 0xFFFFFFFF
        r4 = r3
        r3 &amp;= r1
        r0 ^= r2
        r3 ^= r0
        r0 |= r4
        r4 ^= r2
        r2 &amp;= r3
        r2 ^= r1
        r4 ^= r3
        r4 ^= r0
        r0 ^= r1
        r1 &amp;= r2
        r0 = ~r0 &amp; 0xFFFFFFFF
        r1 ^= r4
        r4 |= r2
        r0 ^= r4
        r3 = rotl32(r3, 13)
        r1 = rotl32(r1, 3)
        r2 = r2 ^ r3 ^ r1
        r0 = r0 ^ r1 ^ (r3 &lt;&lt; 3)
        r0 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r0 = rotl32(r0, 7)
        r3 = r3 ^ r2 ^ r0
        r1 = r1 ^ r0 ^ (r2 &lt;&lt; 7)
        r1 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 5)
        r1 = rotl32(r1, 22)
        r3 ^= self.serpent24_sub_keys[88]
        r2 ^= self.serpent24_sub_keys[88 + 1]
        r1 ^= self.serpent24_sub_keys[88 + 2]
        r0 ^= self.serpent24_sub_keys[88 + 3]
        r1 = ~r1 &amp; 0xFFFFFFFF
        r4 = r0
        r0 &amp;= r3
        r3 ^= r4
        r0 ^= r1
        r1 |= r4
        r2 ^= r0
        r1 ^= r3
        r3 |= r2
        r1 ^= r2
        r4 ^= r3
        r3 |= r0
        r3 ^= r1
        r4 ^= r0
        r4 ^= r3
        r0 = ~r0 &amp; 0xFFFFFFFF
        r1 &amp;= r4
        r1 ^= r0
        r3 = rotl32(r3, 13)
        r4 = rotl32(r4, 3)
        r2 = r2 ^ r3 ^ r4
        r1 = r1 ^ r4 ^ (r3 &lt;&lt; 3)
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(r2, 1)
        r1 = rotl32(r1, 7)
        r3 = r3 ^ r2 ^ r1
        r4 = r4 ^ r1 ^ (r2 &lt;&lt; 7)
        r4 &amp;= 0xFFFFFFFF
        r3 = rotl32(r3, 5)
        r4 = rotl32(r4, 22)
        r3 ^= self.serpent24_sub_keys[92]
        r2 ^= self.serpent24_sub_keys[92 + 1]
        r4 ^= self.serpent24_sub_keys[92 + 2]
        r1 ^= self.serpent24_sub_keys[92 + 3]
        r0 = r2
        r2 |= r4
        r2 ^= r1
        r0 ^= r4
        r4 ^= r2
        r1 |= r0
        r1 &amp;= r3
        r0 ^= r4
        r1 ^= r2
        r2 |= r0
        r2 ^= r3
        r3 |= r0
        r3 ^= r4
        r2 ^= r0
        r4 ^= r2
        r2 &amp;= r3
        r2 ^= r0
        r4 = ~r4 &amp; 0xFFFFFFFF
        r4 |= r3
        r0 ^= r4
        r0 = rotl32(r0, 13)
        r2 = rotl32(r2, 3)
        r1 = r1 ^ r0 ^ r2
        r3 = r3 ^ r2 ^ (r0 &lt;&lt; 3)
        r3 &amp;= 0xFFFFFFFF
        r1 = rotl32(r1, 1)
        r3 = rotl32(r3, 7)
        r0 = r0 ^ r1 ^ r3
        r2 = r2 ^ r3 ^ (r1 &lt;&lt; 7)
        r2 &amp;= 0xFFFFFFFF
        r0 = rotl32(r0, 5)
        r2 = rotl32(r2, 22)
        r0 ^= self.serpent24_sub_keys[96]
        r1 ^= self.serpent24_sub_keys[96 + 1]
        r2 ^= self.serpent24_sub_keys[96 + 2]
        r3 ^= self.serpent24_sub_keys[96 + 3]
        self.lfsr3 = r0
        self.lfsr2 = r1
        self.lfsr1 = r2
        self.lfsr0 = r3

    def generate_block(self):
        s0 = self.lfsr0
        s1 = self.lfsr1
        s2 = self.lfsr2
        s3 = self.lfsr3
        s4 = self.lfsr4
        s5 = self.lfsr5
        s6 = self.lfsr6
        s7 = self.lfsr7
        s8 = self.lfsr8
        s9 = self.lfsr9
        r1 = self.fsmR1
        r2 = self.fsmR2

        ma = self.mul_alpha
        da = self.div_alpha

        tt = r1
        r1 = r2 + (s1 ^ (s8 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v0 = s0
        s0 = ((s0 &lt;&lt; 8) ^ ma[s0 &gt;&gt; 24]) ^ ((s3 &gt;&gt; 8) ^ da[s3 &amp; 0xFF]) ^ s9
        s0 &amp;= 0xFFFFFFFF
        f0 = (s9 + r1) ^ r2
        f0 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s2 ^ (s9 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v1 = s1
        s1 = ((s1 &lt;&lt; 8) ^ ma[s1 &gt;&gt; 24]) ^ ((s4 &gt;&gt; 8) ^ da[s4 &amp; 0xFF]) ^ s0
        s1 &amp;= 0xFFFFFFFF
        f1 = (s0 + r1) ^ r2
        f1 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s3 ^ (s0 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v2 = s2
        s2 = ((s2 &lt;&lt; 8) ^ ma[s2 &gt;&gt; 24]) ^ ((s5 &gt;&gt; 8) ^ da[s5 &amp; 0xFF]) ^ s1
        s2 &amp;= 0xFFFFFFFF
        f2 = (s1 + r1) ^ r2
        f2 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s4 ^ (s1 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v3 = s3
        s3 = ((s3 &lt;&lt; 8) ^ ma[s3 &gt;&gt; 24]) ^ ((s6 &gt;&gt; 8) ^ da[s6 &amp; 0xFF]) ^ s2
        s3 &amp;= 0xFFFFFFFF
        f3 = (s2 + r1) ^ r2
        f3 &amp;= 0xFFFFFFFF

        f4 = f0
        f0 &amp;= f2
        f0 ^= f3
        f2 ^= f1
        f2 ^= f0
        f3 |= f4
        f3 ^= f1
        f4 ^= f2
        f1 = f3
        f3 |= f4
        f3 ^= f0
        f0 &amp;= f1
        f4 ^= f0
        f1 ^= f3
        f1 ^= f4
        f4 = ~f4 &amp; 0xFFFFFFFF

        yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

        tt = r1
        r1 = r2 + (s5 ^ (s2 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v0 = s4
        s4 = ((s4 &lt;&lt; 8) ^ ma[s4 &gt;&gt; 24]) ^ ((s7 &gt;&gt; 8) ^ da[s7 &amp; 0xFF]) ^ s3
        s4 &amp;= 0xFFFFFFFF
        f0 = (s3 + r1) ^ r2
        f0 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s6 ^ (s3 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v1 = s5
        s5 = ((s5 &lt;&lt; 8) ^ ma[s5 &gt;&gt; 24]) ^ ((s8 &gt;&gt; 8) ^ da[s8 &amp; 0xFF]) ^ s4
        s5 &amp;= 0xFFFFFFFF
        f1 = (s4 + r1) ^ r2
        f1 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s7 ^ (s4 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v2 = s6
        s6 = ((s6 &lt;&lt; 8) ^ ma[s6 &gt;&gt; 24]) ^ ((s9 &gt;&gt; 8) ^ da[s9 &amp; 0xFF]) ^ s5
        s6 &amp;= 0xFFFFFFFF
        f2 = (s5 + r1) ^ r2
        f2 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s8 ^ (s5 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v3 = s7
        s7 = ((s7 &lt;&lt; 8) ^ ma[s7 &gt;&gt; 24]) ^ ((s0 &gt;&gt; 8) ^ da[s0 &amp; 0xFF]) ^ s6
        s7 &amp;= 0xFFFFFFFF
        f3 = (s6 + r1) ^ r2
        f3 &amp;= 0xFFFFFFFF

        f4 = f0
        f0 &amp;= f2
        f0 ^= f3
        f2 ^= f1
        f2 ^= f0
        f3 |= f4
        f3 ^= f1
        f4 ^= f2
        f1 = f3
        f3 |= f4
        f3 ^= f0
        f0 &amp;= f1
        f4 ^= f0
        f1 ^= f3
        f1 ^= f4
        f4 = ~f4 &amp; 0xFFFFFFFF

        yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

        tt = r1
        r1 = r2 + (s9 ^ (s6 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v0 = s8
        s8 = ((s8 &lt;&lt; 8) ^ ma[s8 &gt;&gt; 24]) ^ ((s1 &gt;&gt; 8) ^ da[s1 &amp; 0xFF]) ^ s7
        s8 &amp;= 0xFFFFFFFF
        f0 = (s7 + r1) ^ r2
        f0 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s0 ^ (s7 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v1 = s9
        s9 = ((s9 &lt;&lt; 8) ^ ma[s9 &gt;&gt; 24]) ^ ((s2 &gt;&gt; 8) ^ da[s2 &amp; 0xFF]) ^ s8
        s9 &amp;= 0xFFFFFFFF
        f1 = (s8 + r1) ^ r2
        f1 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s1 ^ (s8 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v2 = s0
        s0 = ((s0 &lt;&lt; 8) ^ ma[s0 &gt;&gt; 24]) ^ ((s3 &gt;&gt; 8) ^ da[s3 &amp; 0xFF]) ^ s9
        s0 &amp;= 0xFFFFFFFF
        f2 = (s9 + r1) ^ r2
        f2 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s2 ^ (s9 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v3 = s1
        s1 = ((s1 &lt;&lt; 8) ^ ma[s1 &gt;&gt; 24]) ^ ((s4 &gt;&gt; 8) ^ da[s4 &amp; 0xFF]) ^ s0
        s1 &amp;= 0xFFFFFFFF
        f3 = (s0 + r1) ^ r2
        f3 &amp;= 0xFFFFFFFF

        f4 = f0
        f0 &amp;= f2
        f0 ^= f3
        f2 ^= f1
        f2 ^= f0
        f3 |= f4
        f3 ^= f1
        f4 ^= f2
        f1 = f3
        f3 |= f4
        f3 ^= f0
        f0 &amp;= f1
        f4 ^= f0
        f1 ^= f3
        f1 ^= f4
        f4 = ~f4 &amp; 0xFFFFFFFF

        yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

        tt = r1
        r1 = r2 + (s3 ^ (s0 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v0 = s2
        s2 = ((s2 &lt;&lt; 8) ^ ma[s2 &gt;&gt; 24]) ^ ((s5 &gt;&gt; 8) ^ da[s5 &amp; 0xFF]) ^ s1
        s2 &amp;= 0xFFFFFFFF
        f0 = (s1 + r1) ^ r2
        f0 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s4 ^ (s1 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v1 = s3
        s3 = ((s3 &lt;&lt; 8) ^ ma[s3 &gt;&gt; 24]) ^ ((s6 &gt;&gt; 8) ^ da[s6 &amp; 0xFF]) ^ s2
        s3 &amp;= 0xFFFFFFFF
        f1 = (s2 + r1) ^ r2
        f1 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s5 ^ (s2 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v2 = s4
        s4 = ((s4 &lt;&lt; 8) ^ ma[s4 &gt;&gt; 24]) ^ ((s7 &gt;&gt; 8) ^ da[s7 &amp; 0xFF]) ^ s3
        s4 &amp;= 0xFFFFFFFF
        f2 = (s3 + r1) ^ r2
        f2 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s6 ^ (s3 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v3 = s5
        s5 = ((s5 &lt;&lt; 8) ^ ma[s5 &gt;&gt; 24]) ^ ((s8 &gt;&gt; 8) ^ da[s8 &amp; 0xFF]) ^ s4
        s5 &amp;= 0xFFFFFFFF
        f3 = (s4 + r1) ^ r2
        f3 &amp;= 0xFFFFFFFF

        f4 = f0
        f0 &amp;= f2
        f0 ^= f3
        f2 ^= f1
        f2 ^= f0
        f3 |= f4
        f3 ^= f1
        f4 ^= f2
        f1 = f3
        f3 |= f4
        f3 ^= f0
        f0 &amp;= f1
        f4 ^= f0
        f1 ^= f3
        f1 ^= f4
        f4 = ~f4 &amp; 0xFFFFFFFF

        yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

        tt = r1
        r1 = r2 + (s7 ^ (s4 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v0 = s6
        s6 = ((s6 &lt;&lt; 8) ^ ma[s6 &gt;&gt; 24]) ^ ((s9 &gt;&gt; 8) ^ da[s9 &amp; 0xFF]) ^ s5
        s6 &amp;= 0xFFFFFFFF
        f0 = (s5 + r1) ^ r2
        f0 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s8 ^ (s5 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v1 = s7
        s7 = ((s7 &lt;&lt; 8) ^ ma[s7 &gt;&gt; 24]) ^ ((s0 &gt;&gt; 8) ^ da[s0 &amp; 0xFF]) ^ s6
        s7 &amp;= 0xFFFFFFFF
        f1 = (s6 + r1) ^ r2
        f1 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s9 ^ (s6 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v2 = s8
        s8 = ((s8 &lt;&lt; 8) ^ ma[s8 &gt;&gt; 24]) ^ ((s1 &gt;&gt; 8) ^ da[s1 &amp; 0xFF]) ^ s7
        s8 &amp;= 0xFFFFFFFF
        f2 = (s7 + r1) ^ r2
        f2 &amp;= 0xFFFFFFFF

        tt = r1
        r1 = r2 + (s0 ^ (s7 if r1 &amp; 1 else 0))
        r1 &amp;= 0xFFFFFFFF
        r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
        v3 = s9
        s9 = ((s9 &lt;&lt; 8) ^ ma[s9 &gt;&gt; 24]) ^ ((s2 &gt;&gt; 8) ^ da[s2 &amp; 0xFF]) ^ s8
        s9 &amp;= 0xFFFFFFFF
        f3 = (s8 + r1) ^ r2
        f3 &amp;= 0xFFFFFFFF

        f4 = f0
        f0 &amp;= f2
        f0 ^= f3
        f2 ^= f1
        f2 ^= f0
        f3 |= f4
        f3 ^= f1
        f4 ^= f2
        f1 = f3
        f3 |= f4
        f3 ^= f0
        f0 &amp;= f1
        f4 ^= f0
        f1 ^= f3
        f1 ^= f4
        f4 = ~f4 &amp; 0xFFFFFFFF

        yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

        self.lfsr0 = s0
        self.lfsr1 = s1
        self.lfsr2 = s2
        self.lfsr3 = s3
        self.lfsr4 = s4
        self.lfsr5 = s5
        self.lfsr6 = s6
        self.lfsr7 = s7
        self.lfsr8 = s8
        self.lfsr9 = s9
        self.fsmR1 = r1
        self.fsmR2 = r2

    def __iter__(self):
        while True:
            yield from self.generate_block()</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.lfsr0"><code class="name">var <span class="ident">lfsr0</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.lfsr1"><code class="name">var <span class="ident">lfsr1</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.lfsr2"><code class="name">var <span class="ident">lfsr2</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.lfsr3"><code class="name">var <span class="ident">lfsr3</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.lfsr4"><code class="name">var <span class="ident">lfsr4</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.lfsr5"><code class="name">var <span class="ident">lfsr5</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.lfsr6"><code class="name">var <span class="ident">lfsr6</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.lfsr7"><code class="name">var <span class="ident">lfsr7</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.lfsr8"><code class="name">var <span class="ident">lfsr8</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.lfsr9"><code class="name">var <span class="ident">lfsr9</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.fsmR1"><code class="name">var <span class="ident">fsmR1</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.fsmR2"><code class="name">var <span class="ident">fsmR2</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.generate_block"><code class="name flex">
<span>def <span class="ident">generate_block</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/2c887cef6f2560025a1ac871b535f0d84fa3f321/refinery/units/crypto/cipher/sosemanuk.py#L1890-L2213" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def generate_block(self):
    s0 = self.lfsr0
    s1 = self.lfsr1
    s2 = self.lfsr2
    s3 = self.lfsr3
    s4 = self.lfsr4
    s5 = self.lfsr5
    s6 = self.lfsr6
    s7 = self.lfsr7
    s8 = self.lfsr8
    s9 = self.lfsr9
    r1 = self.fsmR1
    r2 = self.fsmR2

    ma = self.mul_alpha
    da = self.div_alpha

    tt = r1
    r1 = r2 + (s1 ^ (s8 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v0 = s0
    s0 = ((s0 &lt;&lt; 8) ^ ma[s0 &gt;&gt; 24]) ^ ((s3 &gt;&gt; 8) ^ da[s3 &amp; 0xFF]) ^ s9
    s0 &amp;= 0xFFFFFFFF
    f0 = (s9 + r1) ^ r2
    f0 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s2 ^ (s9 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v1 = s1
    s1 = ((s1 &lt;&lt; 8) ^ ma[s1 &gt;&gt; 24]) ^ ((s4 &gt;&gt; 8) ^ da[s4 &amp; 0xFF]) ^ s0
    s1 &amp;= 0xFFFFFFFF
    f1 = (s0 + r1) ^ r2
    f1 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s3 ^ (s0 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v2 = s2
    s2 = ((s2 &lt;&lt; 8) ^ ma[s2 &gt;&gt; 24]) ^ ((s5 &gt;&gt; 8) ^ da[s5 &amp; 0xFF]) ^ s1
    s2 &amp;= 0xFFFFFFFF
    f2 = (s1 + r1) ^ r2
    f2 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s4 ^ (s1 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v3 = s3
    s3 = ((s3 &lt;&lt; 8) ^ ma[s3 &gt;&gt; 24]) ^ ((s6 &gt;&gt; 8) ^ da[s6 &amp; 0xFF]) ^ s2
    s3 &amp;= 0xFFFFFFFF
    f3 = (s2 + r1) ^ r2
    f3 &amp;= 0xFFFFFFFF

    f4 = f0
    f0 &amp;= f2
    f0 ^= f3
    f2 ^= f1
    f2 ^= f0
    f3 |= f4
    f3 ^= f1
    f4 ^= f2
    f1 = f3
    f3 |= f4
    f3 ^= f0
    f0 &amp;= f1
    f4 ^= f0
    f1 ^= f3
    f1 ^= f4
    f4 = ~f4 &amp; 0xFFFFFFFF

    yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

    tt = r1
    r1 = r2 + (s5 ^ (s2 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v0 = s4
    s4 = ((s4 &lt;&lt; 8) ^ ma[s4 &gt;&gt; 24]) ^ ((s7 &gt;&gt; 8) ^ da[s7 &amp; 0xFF]) ^ s3
    s4 &amp;= 0xFFFFFFFF
    f0 = (s3 + r1) ^ r2
    f0 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s6 ^ (s3 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v1 = s5
    s5 = ((s5 &lt;&lt; 8) ^ ma[s5 &gt;&gt; 24]) ^ ((s8 &gt;&gt; 8) ^ da[s8 &amp; 0xFF]) ^ s4
    s5 &amp;= 0xFFFFFFFF
    f1 = (s4 + r1) ^ r2
    f1 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s7 ^ (s4 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v2 = s6
    s6 = ((s6 &lt;&lt; 8) ^ ma[s6 &gt;&gt; 24]) ^ ((s9 &gt;&gt; 8) ^ da[s9 &amp; 0xFF]) ^ s5
    s6 &amp;= 0xFFFFFFFF
    f2 = (s5 + r1) ^ r2
    f2 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s8 ^ (s5 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v3 = s7
    s7 = ((s7 &lt;&lt; 8) ^ ma[s7 &gt;&gt; 24]) ^ ((s0 &gt;&gt; 8) ^ da[s0 &amp; 0xFF]) ^ s6
    s7 &amp;= 0xFFFFFFFF
    f3 = (s6 + r1) ^ r2
    f3 &amp;= 0xFFFFFFFF

    f4 = f0
    f0 &amp;= f2
    f0 ^= f3
    f2 ^= f1
    f2 ^= f0
    f3 |= f4
    f3 ^= f1
    f4 ^= f2
    f1 = f3
    f3 |= f4
    f3 ^= f0
    f0 &amp;= f1
    f4 ^= f0
    f1 ^= f3
    f1 ^= f4
    f4 = ~f4 &amp; 0xFFFFFFFF

    yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

    tt = r1
    r1 = r2 + (s9 ^ (s6 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v0 = s8
    s8 = ((s8 &lt;&lt; 8) ^ ma[s8 &gt;&gt; 24]) ^ ((s1 &gt;&gt; 8) ^ da[s1 &amp; 0xFF]) ^ s7
    s8 &amp;= 0xFFFFFFFF
    f0 = (s7 + r1) ^ r2
    f0 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s0 ^ (s7 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v1 = s9
    s9 = ((s9 &lt;&lt; 8) ^ ma[s9 &gt;&gt; 24]) ^ ((s2 &gt;&gt; 8) ^ da[s2 &amp; 0xFF]) ^ s8
    s9 &amp;= 0xFFFFFFFF
    f1 = (s8 + r1) ^ r2
    f1 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s1 ^ (s8 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v2 = s0
    s0 = ((s0 &lt;&lt; 8) ^ ma[s0 &gt;&gt; 24]) ^ ((s3 &gt;&gt; 8) ^ da[s3 &amp; 0xFF]) ^ s9
    s0 &amp;= 0xFFFFFFFF
    f2 = (s9 + r1) ^ r2
    f2 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s2 ^ (s9 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v3 = s1
    s1 = ((s1 &lt;&lt; 8) ^ ma[s1 &gt;&gt; 24]) ^ ((s4 &gt;&gt; 8) ^ da[s4 &amp; 0xFF]) ^ s0
    s1 &amp;= 0xFFFFFFFF
    f3 = (s0 + r1) ^ r2
    f3 &amp;= 0xFFFFFFFF

    f4 = f0
    f0 &amp;= f2
    f0 ^= f3
    f2 ^= f1
    f2 ^= f0
    f3 |= f4
    f3 ^= f1
    f4 ^= f2
    f1 = f3
    f3 |= f4
    f3 ^= f0
    f0 &amp;= f1
    f4 ^= f0
    f1 ^= f3
    f1 ^= f4
    f4 = ~f4 &amp; 0xFFFFFFFF

    yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

    tt = r1
    r1 = r2 + (s3 ^ (s0 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v0 = s2
    s2 = ((s2 &lt;&lt; 8) ^ ma[s2 &gt;&gt; 24]) ^ ((s5 &gt;&gt; 8) ^ da[s5 &amp; 0xFF]) ^ s1
    s2 &amp;= 0xFFFFFFFF
    f0 = (s1 + r1) ^ r2
    f0 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s4 ^ (s1 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v1 = s3
    s3 = ((s3 &lt;&lt; 8) ^ ma[s3 &gt;&gt; 24]) ^ ((s6 &gt;&gt; 8) ^ da[s6 &amp; 0xFF]) ^ s2
    s3 &amp;= 0xFFFFFFFF
    f1 = (s2 + r1) ^ r2
    f1 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s5 ^ (s2 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v2 = s4
    s4 = ((s4 &lt;&lt; 8) ^ ma[s4 &gt;&gt; 24]) ^ ((s7 &gt;&gt; 8) ^ da[s7 &amp; 0xFF]) ^ s3
    s4 &amp;= 0xFFFFFFFF
    f2 = (s3 + r1) ^ r2
    f2 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s6 ^ (s3 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v3 = s5
    s5 = ((s5 &lt;&lt; 8) ^ ma[s5 &gt;&gt; 24]) ^ ((s8 &gt;&gt; 8) ^ da[s8 &amp; 0xFF]) ^ s4
    s5 &amp;= 0xFFFFFFFF
    f3 = (s4 + r1) ^ r2
    f3 &amp;= 0xFFFFFFFF

    f4 = f0
    f0 &amp;= f2
    f0 ^= f3
    f2 ^= f1
    f2 ^= f0
    f3 |= f4
    f3 ^= f1
    f4 ^= f2
    f1 = f3
    f3 |= f4
    f3 ^= f0
    f0 &amp;= f1
    f4 ^= f0
    f1 ^= f3
    f1 ^= f4
    f4 = ~f4 &amp; 0xFFFFFFFF

    yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

    tt = r1
    r1 = r2 + (s7 ^ (s4 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v0 = s6
    s6 = ((s6 &lt;&lt; 8) ^ ma[s6 &gt;&gt; 24]) ^ ((s9 &gt;&gt; 8) ^ da[s9 &amp; 0xFF]) ^ s5
    s6 &amp;= 0xFFFFFFFF
    f0 = (s5 + r1) ^ r2
    f0 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s8 ^ (s5 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v1 = s7
    s7 = ((s7 &lt;&lt; 8) ^ ma[s7 &gt;&gt; 24]) ^ ((s0 &gt;&gt; 8) ^ da[s0 &amp; 0xFF]) ^ s6
    s7 &amp;= 0xFFFFFFFF
    f1 = (s6 + r1) ^ r2
    f1 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s9 ^ (s6 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v2 = s8
    s8 = ((s8 &lt;&lt; 8) ^ ma[s8 &gt;&gt; 24]) ^ ((s1 &gt;&gt; 8) ^ da[s1 &amp; 0xFF]) ^ s7
    s8 &amp;= 0xFFFFFFFF
    f2 = (s7 + r1) ^ r2
    f2 &amp;= 0xFFFFFFFF

    tt = r1
    r1 = r2 + (s0 ^ (s7 if r1 &amp; 1 else 0))
    r1 &amp;= 0xFFFFFFFF
    r2 = rotl32(tt * 0x54655307 &amp; 0xFFFFFFFF, 7)
    v3 = s9
    s9 = ((s9 &lt;&lt; 8) ^ ma[s9 &gt;&gt; 24]) ^ ((s2 &gt;&gt; 8) ^ da[s2 &amp; 0xFF]) ^ s8
    s9 &amp;= 0xFFFFFFFF
    f3 = (s8 + r1) ^ r2
    f3 &amp;= 0xFFFFFFFF

    f4 = f0
    f0 &amp;= f2
    f0 ^= f3
    f2 ^= f1
    f2 ^= f0
    f3 |= f4
    f3 ^= f1
    f4 ^= f2
    f1 = f3
    f3 |= f4
    f3 ^= f0
    f0 &amp;= f1
    f4 ^= f0
    f1 ^= f3
    f1 ^= f4
    f4 = ~f4 &amp; 0xFFFFFFFF

    yield from chunks.pack([f2 ^ v0, f3 ^ v1, f1 ^ v2, f4 ^ v3], 4)

    self.lfsr0 = s0
    self.lfsr1 = s1
    self.lfsr2 = s2
    self.lfsr3 = s3
    self.lfsr4 = s4
    self.lfsr5 = s5
    self.lfsr6 = s6
    self.lfsr7 = s7
    self.lfsr8 = s8
    self.lfsr9 = s9
    self.fsmR1 = r1
    self.fsmR2 = r2</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.sosemanuk"><code class="flex name class">
<span>class <span class="ident">sosemanuk</span></span>
<span>(</span><span>key, stateful=False, discard=0, nonce=b'')</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/2c887cef6f2560025a1ac871b535f0d84fa3f321/refinery/units/crypto/cipher/sosemanuk.py#L2220-L2229" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class sosemanuk(StreamCipherUnit):

    def __init__(
        self, key, stateful=False, discard=0,
        nonce: Param[buf, Arg(help=&#39;The nonce. Default is empty, which is equivalent to 16 null bytes.&#39;)] = B&#39;&#39;,
    ):
        super().__init__(key=key, nonce=nonce, stateful=stateful, discard=discard)

    def keystream(self):
        yield from Sosemanuk(self.args.key, self.args.nonce)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.StreamCipherUnit" href="index.html#refinery.units.crypto.cipher.StreamCipherUnit">StreamCipherUnit</a></li>
<li><a title="refinery.units.crypto.cipher.CipherUnit" href="index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></li>
<li><a title="refinery.units.Unit" href="../../index.html#refinery.units.Unit">Unit</a></li>
<li><a title="refinery.units.UnitBase" href="../../index.html#refinery.units.UnitBase">UnitBase</a></li>
<li><a title="refinery.units.Entry" href="../../index.html#refinery.units.Entry">Entry</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="refinery.units.crypto.cipher.sosemanuk.sosemanuk" href="#refinery.units.crypto.cipher.sosemanuk.sosemanuk">sosemanuk</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="refinery.units.crypto.cipher.sosemanuk.sosemanuk.key_size"><code class="name">var <span class="ident">key_size</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
<dt id="refinery.units.crypto.cipher.sosemanuk.sosemanuk.block_size"><code class="name">var <span class="ident">block_size</span></code></dt>
<dd>
<section class="desc"></section>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="refinery.units.crypto.cipher.sosemanuk.sosemanuk.keystream"><code class="name flex">
<span>def <span class="ident">keystream</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/2c887cef6f2560025a1ac871b535f0d84fa3f321/refinery/units/crypto/cipher/sosemanuk.py#L2228-L2229" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def keystream(self):
    yield from Sosemanuk(self.args.key, self.args.nonce)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="refinery.units.crypto.cipher.StreamCipherUnit" href="index.html#refinery.units.crypto.cipher.StreamCipherUnit">StreamCipherUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.Requires" href="../../index.html#refinery.units.Unit.Requires">Requires</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.assemble" href="../../index.html#refinery.units.Unit.assemble">assemble</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.finish" href="../../index.html#refinery.units.UnitBase.finish">finish</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.handles" href="../../index.html#refinery.units.UnitBase.handles">handles</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.is_quiet" href="../../index.html#refinery.units.Unit.is_quiet">is_quiet</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.labelled" href="../../index.html#refinery.units.Unit.labelled">labelled</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.leniency" href="../../index.html#refinery.units.Unit.leniency">leniency</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_always" href="../../index.html#refinery.units.Unit.log_always">log_always</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_debug" href="../../index.html#refinery.units.Unit.log_debug">log_debug</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_detach" href="../../index.html#refinery.units.Unit.log_detach">log_detach</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_fail" href="../../index.html#refinery.units.Unit.log_fail">log_fail</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_info" href="../../index.html#refinery.units.Unit.log_info">log_info</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_level" href="../../index.html#refinery.units.Unit.log_level">log_level</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.log_warn" href="../../index.html#refinery.units.Unit.log_warn">log_warn</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.nozzle" href="../../index.html#refinery.units.Unit.nozzle">nozzle</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.process" href="../../index.html#refinery.units.UnitBase.process">process</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.read" href="../../index.html#refinery.units.Unit.read">read</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.read1" href="../../index.html#refinery.units.Unit.read1">read1</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.run" href="../../index.html#refinery.units.Unit.run">run</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.source" href="../../index.html#refinery.units.Unit.source">source</a></code></li>
<li><code><a title="refinery.units.crypto.cipher.StreamCipherUnit.superinit" href="../../index.html#refinery.units.Unit.superinit">superinit</a></code></li>
</ul>
</li>
<li><code><b><a title="refinery.units.crypto.cipher.CipherUnit" href="index.html#refinery.units.crypto.cipher.CipherUnit">CipherUnit</a></b></code>:
<ul class="hlist">
<li><code><a title="refinery.units.crypto.cipher.CipherUnit.filter" href="../../index.html#refinery.units.UnitBase.filter">filter</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="refinery.units.crypto.cipher" href="index.html">refinery.units.crypto.cipher</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="refinery.units.crypto.cipher.sosemanuk.Sosemanuk" href="#refinery.units.crypto.cipher.sosemanuk.Sosemanuk">Sosemanuk</a></code></h4>
<ul class="">
<li><code><a title="refinery.units.crypto.cipher.sosemanuk.Sosemanuk.generate_block" href="#refinery.units.crypto.cipher.sosemanuk.Sosemanuk.generate_block">generate_block</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.units.crypto.cipher.sosemanuk.sosemanuk" href="#refinery.units.crypto.cipher.sosemanuk.sosemanuk">sosemanuk</a></code></h4>
<ul class="">
<li><code><a title="refinery.units.crypto.cipher.sosemanuk.sosemanuk.keystream" href="#refinery.units.crypto.cipher.sosemanuk.sosemanuk.keystream">keystream</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>
hljs.configure({languages: []})
hljs.initHighlightingOnLoad()
</script>
</body>
</html>
