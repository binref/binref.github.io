<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.11.6" />
<title>the refinery.lib.thirdparty.pcode2code documentation</title>
<meta name="description" content="On a Mission to Refine Binaries" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow-night-bright.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{background-color:#0D0D0D;color:#EEEEEE;font-size:16pt}@font-face{font-family:"FixedSysEx";src:local('Fixedsys Excelsior 3.01-L2'),local('Fixedsys Excelsior 3.01'),local('FixedSysEx'),url(../../FixedSysEx.ttf) format('truetype')}code,pre,body,html{font-family:FixedSysEx,monospace}b,strong{font-weight:normal}#content{padding:20px}#sidebar{padding:1vw;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #EEEEEE;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}hr{display:none}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#EE8080;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#EEEEEE}// .title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#BB4040}pre code{background:#000000;display:block;padding:1px 0px 4px 0px;line-height:100%}code{background:#000000;padding:1px 0px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#000000;border:0;border-top:1px solid #EEEEEE;border-bottom:1px solid #EEEEEE;margin:1em 0;padding:1ex;overflow-x:auto}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index ul{list-style-type:square;padding:0}// #index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 10px}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#000000;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#0D0D0D}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#EEEEEE;border-left:5px solid #EEEEEE;padding-left:1em}.inheritance em{font-style:normal}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1ch}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition.note,.admonition.info,.admonition.todo,.admonition.versionadded,.admonition.important,.admonition.tip,.admonition.hint{background:#054000}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#998800}.admonition.error,.admonition.danger,.admonition.caution{background:#300000}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:1vw}main{display:flex;flex-direction:row;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #EEEEEE;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>refinery.lib.thirdparty.pcode2code</code></h1>
</header>
<section id="section-intro">
<p>The code of this module is based on the source code of pcode2code, originally
available at the following location:</p>
<p><a href="https://github.com/Big5-sec/pcode2code">https://github.com/Big5-sec/pcode2code</a></p>
<p>The following is the original docstring:</p>
<p>pcode2code is a module aiming at decompiling VBA pcode. It's based on Dr. Vesselin
Vladimirov Bontchev(@VessOnSecurity)'s tool pcodedmp, which makes the disassembly,
while this module is only an interface to print out readable VBA code.
How it works:
Basically, pcodedmp gives out a bytecode interpretation, representing operations
made on a somewhat stack, with opcodes translation. This program simply parses the
opcodes and manipulates the stack to rectonstruct the original VBA code.
Author: Nicolas Zilio - @Big5_sec
License: GPL</p>
<p>The code was altered and modified for work within Binary Refinery, but remains
subject to the original license text, which is as follows:</p>
<pre><code>                 GNU GENERAL PUBLIC LICENSE
                  Version 3, 29 June 2007

a vba p-code decompiler based on pcodedmp
Copyright (C) 2019  Nicolas Zilio

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program. If not, see &lt;http://www.gnu.org/licenses/.&gt;
</code></pre>
<p>Also add information on how to contact you by electronic and paper mail.</p>
<p>You should also get your employer (if you work as a programmer) or school,
if any, to sign a "copyright disclaimer" for the program, if necessary.
For more information on this, and how to apply and follow the GNU GPL, see:
<a href="http://www.gnu.org/licenses/.">http://www.gnu.org/licenses/.</a></p>
<p>The GNU General Public License does not permit incorporating your program
into proprietary programs.
If your program is a subroutine library, you
may consider it more useful to permit linking proprietary applications with
the library. If this is what you want to do, use the GNU Lesser General
Public License instead of this License. But first, please read:
<a href="http://www.gnu.org/philosophy/why-not-lgpl.html.">http://www.gnu.org/philosophy/why-not-lgpl.html.</a></p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1-L3937" class="git-link">Browse git</a>
</summary>
<pre><code class="python">&#34;&#34;&#34;
The code of this module is based on the source code of pcode2code, originally
available at the following location:

https://github.com/Big5-sec/pcode2code

The following is the original docstring:

pcode2code is a module aiming at decompiling VBA pcode. It&#39;s based on Dr. Vesselin
Vladimirov Bontchev(@VessOnSecurity)&#39;s tool pcodedmp, which makes the disassembly,
while this module is only an interface to print out readable VBA code.
 How it works:
Basically, pcodedmp gives out a bytecode interpretation, representing operations
made on a somewhat stack, with opcodes translation. This program simply parses the
opcodes and manipulates the stack to rectonstruct the original VBA code.
 Author: Nicolas Zilio - @Big5_sec
 License: GPL

The code was altered and modified for work within Binary Refinery, but remains
subject to the original license text, which is as follows:

                     GNU GENERAL PUBLIC LICENSE
                      Version 3, 29 June 2007

    a vba p-code decompiler based on pcodedmp
    Copyright (C) 2019  Nicolas Zilio

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
    General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program. If not, see http://www.gnu.org/licenses/.

Also add information on how to contact you by electronic and paper mail.

  You should also get your employer (if you work as a programmer) or school,
if any, to sign a &#34;copyright disclaimer&#34; for the program, if necessary.
For more information on this, and how to apply and follow the GNU GPL, see:
  http://www.gnu.org/licenses/.

  The GNU General Public License does not permit incorporating your program
into proprietary programs.  If your program is a subroutine library, you
may consider it more useful to permit linking proprietary applications with
the library. If this is what you want to do, use the GNU Lesser General
Public License instead of this License. But first, please read:
  http://www.gnu.org/philosophy/why-not-lgpl.html.
&#34;&#34;&#34;
import struct


class Pcode2codeException(Exception):
    &#34;&#34;&#34;
    Simply a custom exception class, permitting to make the difference between generic python exceptions and the one we are pushing
    &#34;&#34;&#34;


class Stack:
    &#34;&#34;&#34;
    Our stack class. Used to implement the operations made in the VBA bytecode, which is somehow stack based
    &#34;&#34;&#34;

    def __init__(self):
        self.stack = []

    def pop(self):
        if len(self.stack) == 0:
            return None
        return self.stack.pop()

    def push(self, item):
        self.stack.append(item)

    def size(self):
        return len(self.stack)

    def top(self):
        return self.stack[-1]

    def bottom(self):
        return self.stack[0]

    def clearstack(self):
        self.stack = []


class Operations:

    def __init__(self, opstack: Stack):
        self.opstack = opstack
        # number of blocks that will be ignored for indentation
        self.unindented = 0
        # current indentation level
        self.indentlevel = 0
        # boolean indicating if indentation level should be increased after the current command
        self.indentincrease_future = False
        # boolean indicating to print all stack, like in one liner cases
        self.has_bos = False
        # boolean indicating if we are on a onelineif. In this case, closing should not be treated the same as other if blocks
        self.onelineif = False
        self.ops = {
            &#39;Imp&#39;                   : self.imp,
            &#39;Eqv&#39;                   : self.eqv,
            &#39;Xor&#39;                   : self.xor,
            &#39;Or&#39;                    : self.or_,
            &#39;And&#39;                   : self.and_,
            &#39;Eq&#39;                    : self.eq,
            &#39;Ne&#39;                    : self.ne,
            &#39;Le&#39;                    : self.le,
            &#39;Ge&#39;                    : self.ge,
            &#39;Lt&#39;                    : self.lt,
            &#39;Gt&#39;                    : self.gt,
            &#39;Add&#39;                   : self.add,
            &#39;Sub&#39;                   : self.sub,
            &#39;Mod&#39;                   : self.mod,
            &#39;IDiv&#39;                  : self.idiv,
            &#39;Mul&#39;                   : self.mul,
            &#39;Div&#39;                   : self.div,
            &#39;Concat&#39;                : self.concat,
            &#39;Like&#39;                  : self.like,
            &#39;Pwr&#39;                   : self.pwr,
            &#39;Is&#39;                    : self.is_,
            &#39;Not&#39;                   : self.not_,
            &#39;UMi&#39;                   : self.umi,
            &#39;FnAbs&#39;                 : self.fnabs,
            &#39;FnFix&#39;                 : self.fnfix,
            &#39;FnInt&#39;                 : self.fnint,
            &#39;FnSgn&#39;                 : self.fnsgn,
            &#39;FnLen&#39;                 : self.fnlen,
            &#39;FnLenB&#39;                : self.fnlenb,
            &#39;Paren&#39;                 : self.paren,
            &#39;Sharp&#39;                 : self.sharp,
            &#39;LdLHS&#39;                 : self.ldlhs,
            &#39;Ld&#39;                    : self.ld,
            &#39;MemLd&#39;                 : self.memld,
            &#39;DictLd&#39;                : self.dictld,
            &#39;IndexLd&#39;               : self.indexld,
            &#39;ArgsLd&#39;                : self.argsld,
            &#39;ArgsMemLd&#39;             : self.argsmemld,
            &#39;ArgsDictLd&#39;            : self.argsdictld,
            &#39;St&#39;                    : self.st,
            &#39;MemSt&#39;                 : self.memst,
            &#39;DictSt&#39;                : self.dictst,
            &#39;IndexSt&#39;               : self.indexst,
            &#39;ArgsSt&#39;                : self.argsst,
            &#39;ArgsMemSt&#39;             : self.argsmemst,
            &#39;ArgsDictSt&#39;            : self.argsdictst,
            &#39;Set&#39;                   : self.set_,
            &#39;Memset&#39;                : self.memset,
            &#39;Dictset&#39;               : self.dictset,
            &#39;Indexset&#39;              : self.indexset,
            &#39;ArgsSet&#39;               : self.argsset,
            &#39;ArgsMemSet&#39;            : self.argsmemset,
            &#39;ArgsDictSet&#39;           : self.argsdictset,
            &#39;MemLdWith&#39;             : self.memldwith,
            &#39;DictLdWith&#39;            : self.dictldwith,
            &#39;ArgsMemLdWith&#39;         : self.argsmemldwith,
            &#39;ArgsDictLdWith&#39;        : self.argsdictldwith,
            &#39;MemStWith&#39;             : self.memstwith,
            &#39;DictStWith&#39;            : self.dictstwith,
            &#39;ArgsMemStWith&#39;         : self.argsmemstwith,
            &#39;ArgsDictStWith&#39;        : self.argsdictstwith,
            &#39;MemSetWith&#39;            : self.memsetwith,
            &#39;DictSetWith&#39;           : self.dictsetwith,
            &#39;ArgsMemSetWith&#39;        : self.argsmemsetwith,
            &#39;ArgsDictSetWith&#39;       : self.argsdictsetwith,
            &#39;ArgsCall&#39;              : self.argscall,
            &#39;ArgsMemCall&#39;           : self.argsmemcall,
            &#39;ArgsMemCallWith&#39;       : self.argsmemcallwith,
            &#39;ArgsArray&#39;             : self.argsarray,
            &#39;Assert&#39;                : self.assert_,
            &#39;BoS&#39;                   : self.bos,
            &#39;BoSImplicit&#39;           : self.bosimplicit,
            &#39;BoL&#39;                   : self.bol,
            &#39;LdAddressOf&#39;           : self.ldaddressof,
            &#39;MemAddressOf&#39;          : self.memaddressof,
            &#39;Case&#39;                  : self.case,
            &#39;CaseTo&#39;                : self.caseto,
            &#39;CaseGt&#39;                : self.casegt,
            &#39;CaseLt&#39;                : self.caselt,
            &#39;CaseGe&#39;                : self.casege,
            &#39;CaseLe&#39;                : self.casele,
            &#39;CaseNe&#39;                : self.casene,
            &#39;CaseEq&#39;                : self.caseeq,
            &#39;CaseElse&#39;              : self.caseelse,
            &#39;CaseDone&#39;              : self.casedone,
            &#39;Circle&#39;                : self.circle,
            &#39;Close&#39;                 : self.close,
            &#39;CloseAll&#39;              : self.closeall,
            &#39;Coerce&#39;                : self.coerce_,
            &#39;CoerceVar&#39;             : self.coercevar,
            &#39;Context&#39;               : self.context,
            &#39;Debug&#39;                 : self.debug,
            &#39;DefType&#39;               : self.deftype,
            &#39;Dim&#39;                   : self.dim,
            &#39;DimImplicit&#39;           : self.dimimplicit,
            &#39;Do&#39;                    : self.do,
            &#39;DoEvents&#39;              : self.doevents,
            &#39;DoUnitil&#39;              : self.dounitil,
            &#39;DoWhile&#39;               : self.dowhile,
            &#39;Else&#39;                  : self.else_,
            &#39;ElseBlock&#39;             : self.elseblock,
            &#39;ElseIfBlock&#39;           : self.elseifblock,
            &#39;ElseIfTypeBlock&#39;       : self.elseiftypeblock,
            &#39;End&#39;                   : self.end,
            &#39;EndContext&#39;            : self.endcontext,
            &#39;EndFunc&#39;               : self.endfunc,
            &#39;EndIf&#39;                 : self.endif,
            &#39;EndIfBlock&#39;            : self.endifblock,
            &#39;EndImmediate&#39;          : self.endimmediate,
            &#39;EndProp&#39;               : self.endprop,
            &#39;EndSelect&#39;             : self.endselect,
            &#39;EndSub&#39;                : self.endsub,
            &#39;EndType&#39;               : self.endtype,
            &#39;EndWith&#39;               : self.endwith,
            &#39;Erase&#39;                 : self.erase,
            &#39;Error&#39;                 : self.error,
            &#39;EventDecl&#39;             : self.eventdecl,
            &#39;RaiseEvent&#39;            : self.raiseevent,
            &#39;ArgsMemRaiseEvent&#39;     : self.argsmemraiseevent,
            &#39;ArgsMemRaiseEventWith&#39; : self.argsmemraiseeventwith,
            &#39;ExitDo&#39;                : self.exitdo,
            &#39;ExitFor&#39;               : self.exitfor,
            &#39;ExitFunc&#39;              : self.exitfunc,
            &#39;ExitProp&#39;              : self.exitprop,
            &#39;ExitSub&#39;               : self.exitsub,
            &#39;FnCurDir&#39;              : self.fncurdir,
            &#39;FnDir&#39;                 : self.fndir,
            &#39;Empty0&#39;                : self.empty0,
            &#39;Empty1&#39;                : self.empty1,
            &#39;FnError&#39;               : self.fnerror,
            &#39;FnFormat&#39;              : self.fnformat,
            &#39;FnFreeFile&#39;            : self.fnfreefile,
            &#39;FnInStr&#39;               : self.fninstr,
            &#39;FnInStr3&#39;              : self.fninstr3,
            &#39;FnInStr4&#39;              : self.fninstr4,
            &#39;FnInStrB&#39;              : self.fninstrb,
            &#39;FnInStrB3&#39;             : self.fninstrb3,
            &#39;FnInStrB4&#39;             : self.fninstrb4,
            &#39;FnLBound&#39;              : self.fnlbound,
            &#39;FnMid&#39;                 : self.fnmid,
            &#39;FnMidB&#39;                : self.fnmidb,
            &#39;FnStrComp&#39;             : self.fnstrcomp,
            &#39;FnStrComp3&#39;            : self.fnstrcomp3,
            &#39;FnStringVar&#39;           : self.fnstringvar,
            &#39;FnStringStr&#39;           : self.fnstringstr,
            &#39;FnUBound&#39;              : self.fnubound,
            &#39;For&#39;                   : self.for_,
            &#39;ForEach&#39;               : self.foreach,
            &#39;ForEachAs&#39;             : self.foreachas,
            &#39;ForStep&#39;               : self.forstep,
            &#39;FuncDefn&#39;              : self.funcdefn,
            &#39;FuncDefnSave&#39;          : self.funcdefnsave,
            &#39;GetRec&#39;                : self.getrec,
            &#39;GoSub&#39;                 : self.gosub,
            &#39;GoTo&#39;                  : self.goto,
            &#39;If&#39;                    : self.if_,
            &#39;IfBlock&#39;               : self.ifblock,
            &#39;TypeOf&#39;                : self.typeof,
            &#39;IfTypeBlock&#39;           : self.iftypeblock,
            &#39;Implements&#39;            : self.implements,
            &#39;Input&#39;                 : self.input_,
            &#39;InputDone&#39;             : self.inputdone,
            &#39;InputItem&#39;             : self.inputItem,
            &#39;Label&#39;                 : self.label,
            &#39;Let&#39;                   : self.let,
            &#39;Line&#39;                  : self.line,
            &#39;LineCont&#39;              : self.linecont,
            &#39;LineInput&#39;             : self.lineInput,
            &#39;LineNum&#39;               : self.linenum,
            &#39;LitCy&#39;                 : self.litcy,
            &#39;LitDate&#39;               : self.litdate,
            &#39;LitDefault&#39;            : self.litdefault,
            &#39;LitDI2&#39;                : self.litdi2,
            &#39;LitDI4&#39;                : self.litdi4,
            &#39;LitDI8&#39;                : self.litdi8,
            &#39;LitHI2&#39;                : self.lithi2,
            &#39;LitHI4&#39;                : self.lithi4,
            &#39;LitHI8&#39;                : self.lithi8,
            &#39;LitNothing&#39;            : self.litnothing,
            &#39;LitOI2&#39;                : self.litoi2,
            &#39;LitOI4&#39;                : self.litoi4,
            &#39;LitOI8&#39;                : self.litoi8,
            &#39;LitR4&#39;                 : self.litr4,
            &#39;LitR8&#39;                 : self.litr8,
            &#39;LitSmallI2&#39;            : self.litsmalli2,
            &#39;LitStr&#39;                : self.litstr,
            &#39;LitVarSpecial&#39;         : self.litvarspecial,
            &#39;Lock&#39;                  : self.lock,
            &#39;Loop&#39;                  : self.loop,
            &#39;LoopUntil&#39;             : self.loopuntil,
            &#39;LoopWhile&#39;             : self.loopwhile,
            &#39;LSet&#39;                  : self.lset,
            &#39;Me&#39;                    : self.me,
            &#39;MeImplicit&#39;            : self.meimplicit,
            &#39;MemRedim&#39;              : self.memredim,
            &#39;MemRedimWith&#39;          : self.memredimwith,
            &#39;MemRedimAs&#39;            : self.memredimas,
            &#39;MemRedimAsWith&#39;        : self.memredimaswith,
            &#39;Mid&#39;                   : self.mid,
            &#39;MidB&#39;                  : self.midb,
            &#39;Name&#39;                  : self.name,
            &#39;New&#39;                   : self.new,
            &#39;Next&#39;                  : self.next_,
            &#39;NextVar&#39;               : self.nextvar,
            &#39;OnError&#39;               : self.onerror,
            &#39;OnGosub&#39;               : self.ongosub,
            &#39;OnGoto&#39;                : self.ongoto,
            &#39;Open&#39;                  : self.open_,
            &#39;Option&#39;                : self.option,
            &#39;OptionBase&#39;            : self.optionbase,
            &#39;ParamByVal&#39;            : self.parambyval,
            &#39;ParamOmitted&#39;          : self.paramomitted,
            &#39;ParamNamed&#39;            : self.paramnamed,
            &#39;PrintChan&#39;             : self.printchan,
            &#39;PrintComma&#39;            : self.printcomma,
            &#39;PrintEoS&#39;              : self.printeos,
            &#39;PrintItemComma&#39;        : self.printitemcomma,
            &#39;PrintItemNL&#39;           : self.printitemnl,
            &#39;PrintItemSemi&#39;         : self.printitemsemi,
            &#39;PrintNL&#39;               : self.printnl,
            &#39;PrintObj&#39;              : self.printobj,
            &#39;PrintSemi&#39;             : self.printsemi,
            &#39;PrintSpc&#39;              : self.printspc,
            &#39;PrintTab&#39;              : self.printtab,
            &#39;PrintTabComma&#39;         : self.printtabcomma,
            &#39;PSet&#39;                  : self.pset,
            &#39;PutRec&#39;                : self.putrec,
            &#39;QuoteRem&#39;              : self.quoterem,
            &#39;Redim&#39;                 : self.redim,
            &#39;RedimAs&#39;               : self.redimas,
            &#39;Reparse&#39;               : self.reparse,
            &#39;Rem&#39;                   : self.rem,
            &#39;Resume&#39;                : self.resume,
            &#39;Return&#39;                : self.return_,
            &#39;RSet&#39;                  : self.rset,
            &#39;Scale&#39;                 : self.scale,
            &#39;Seek&#39;                  : self.seek,
            &#39;SelectCase&#39;            : self.selectcase,
            &#39;SelectIs&#39;              : self.selectis,
            &#39;SelectType&#39;            : self.selecttype,
            &#39;SetStmt&#39;               : self.setstmt,
            &#39;Stack&#39;                 : self.stack,
            &#39;Stop&#39;                  : self.stop,
            &#39;Type&#39;                  : self.type_,
            &#39;Unlock&#39;                : self.unlock,
            &#39;VarDefn&#39;               : self.vardefn,
            &#39;Wend&#39;                  : self.wend,
            &#39;While&#39;                 : self.while_,
            &#39;With&#39;                  : self.with_,
            &#39;WriteChan&#39;             : self.writechan,
            &#39;ConstFuncExpr&#39;         : self.constfuncexpr,
            &#39;LbConst&#39;               : self.lbconst,
            &#39;LbIf&#39;                  : self.lbif,
            &#39;LbElse&#39;                : self.lbelse,
            &#39;LbElseIf&#39;              : self.lbelseif,
            &#39;LbEndIf&#39;               : self.lbendif,
            &#39;LbMark&#39;                : self.lbmark,
            &#39;EndForVariable&#39;        : self.endforvariable,
            &#39;StartForVariable&#39;      : self.startforvariable,
            &#39;NewRedim&#39;              : self.newredim,
            &#39;StartWithExpr&#39;         : self.startwithexpr,
            &#39;SetOrSt&#39;               : self.setorst,
            &#39;EndEnum&#39;               : self.endenum,
            &#39;Illegal&#39;               : self.illegal,
            &#39;NewLine&#39;               : self.newline
        }

    def imp(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Imp &#39; + arg2
        self.opstack.push(val)

    def eqv(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Eqv &#39; + arg2
        self.opstack.push(val)

    def xor(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Xor &#39; + arg2
        self.opstack.push(val)

    def or_(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Or &#39; + arg2
        self.opstack.push(val)

    def and_(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; And &#39; + arg2
        self.opstack.push(val)

    def eq(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; = &#39; + arg2
        self.opstack.push(val)

    def ne(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &lt;&gt; &#39; + arg2
        self.opstack.push(val)

    def le(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &lt;= &#39; + arg2
        self.opstack.push(val)

    def ge(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &gt;= &#39; + arg2
        self.opstack.push(val)

    def lt(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &lt; &#39; + arg2
        self.opstack.push(val)

    def gt(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &gt; &#39; + arg2
        self.opstack.push(val)

    # ex opeline: &#34;Add&#34;
    # gets the two values on stack, pop them, add them and push again
    def add(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; + &#39; + arg2
        self.opstack.push(val)

    def sub(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; - &#39; + arg2
        self.opstack.push(val)

    def mod(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Mod &#39; + arg2
        self.opstack.push(val)

    def idiv(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; \\ &#39; + arg2
        self.opstack.push(val)

    def mul(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; * &#39; + arg2
        self.opstack.push(val)

    def div(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; / &#39; + arg2
        self.opstack.push(val)

    def concat(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &amp; &#39; + arg2
        self.opstack.push(val)

    def like(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Like &#39; + arg2
        self.opstack.push(val)

    def pwr(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; ^ &#39; + arg2
        self.opstack.push(val)

    def is_(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Is &#39; + arg2
        self.opstack.push(val)

    def not_(self):
        val = &#39;Not &#39; + self.opstack.pop()
        self.opstack.push(val)

    def umi(self):
        val = &#39;-&#39; + self.opstack.pop()
        self.opstack.push(val)

    def fnabs(self):
        arg = self.opstack.pop()
        val = &#39;Abs(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def fnfix(self):
        arg = self.opstack.pop()
        val = &#39;Fix(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def fnint(self):
        arg = self.opstack.pop()
        val = &#39;int(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def fnsgn(self):
        arg = self.opstack.pop()
        val = &#39;Sgn(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def fnlen(self):
        arg = self.opstack.pop()
        val = &#39;Len(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def fnlenb(self):
        arg = self.opstack.pop()
        val = &#39;LenB(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def paren(self):
        arg = self.opstack.pop()
        val = &#39;(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def sharp(self):
        arg = self.opstack.pop()
        val = &#39;#&#39; + arg
        self.opstack.push(val)

    def ldlhs(self):
        raise Pcode2codeException(&#39;not implemented ldlhs&#39;)

    def ld(self, var):
        &#34;&#34;&#34;
        command defining a variable
        example: X = Y
        gives:
             # Ld Y
             # St X
        &#34;&#34;&#34;
        if var == &#39;id_FFFF&#39;: #hacky way to do it because me does not seem to be fully
            var = &#39;Me&#39;       #parsed by pcodedmp
        self.opstack.push(var)

    def memld(self, var):
        val = self.opstack.pop() + &#39;.&#39; + var
        self.opstack.push(val)

    def dictld(self, var):
        &#34;&#34;&#34;
        cf fields and collections, also index???
        example: Debug.Print rsTable!Title
        gives:
             # Debug
             # PrintObj
             # Ld rsTable
             # DictLd Title
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(self.opstack.pop()+ &#39;!&#39; + var)

    def indexld(self, *args):
        raise Pcode2codeException(&#39;not implemented indexld&#39;)

    def argsld(self, varname, numparams):
        val = varname + &#39;(&#39;
        nb_parameters = int(numparams, 16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)

    def argsmemld(self, var, numparams):
        nb_parameters = int(numparams, 16)
        val = self.opstack.pop() + &#39;.&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)

    def argsdictld(self, var, numparams):
        &#34;&#34;&#34;
        command used when an index of an object with an argument is accessed
        example: Debug.Print myobj!toto(&#34;titi&#34;) 
        gives:
             # Debug
             # PrintObj
             # LitStr 0x0004 &#34;titi&#34;
             # Ld myobj
             # ArgsDictLd toto 0x0001
             # PrintItemNL
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = self.opstack.pop() + &#39;!&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)

    # example line : Function giqw(str As String) As Variant: Dim bytes() As Byte: bytes = str: giqw = bytes: End Function
    # op line:
    # Line #13:
    #     FuncDefn (Function giqw(str As String) As Variant)
    #     BoS 0x0000 
    #     Dim 
    #     VarDefn bytes (As Byte)
    #     BoS 0x0000 
    #     Ld str 
    #     St bytes 
    #     BoS 0x0000 
    #     Ld bytes 
    #     St giqw 
    #     BoS 0x0000 
    #     EndFunc 
    def st(self, arg):
        param = self.opstack.pop()
        val = arg + &#39; = &#39; + param
        self.opstack.push(val)

    def memst(self, var):
        val = self.opstack.pop() + &#39;.&#39; + var
        val = val + &#39; = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def dictst(self, var):
        &#34;&#34;&#34;
        command used when an index is defined directly
        example: myobj!titi = &#34;toto&#34;
        gives:
             # LitStr 0x0004 &#34;toto&#34;
             # Ld myobj
             # DictSt titi
        &#34;&#34;&#34;
        val = self.opstack.pop() + &#39;!&#39; + var + &#39; = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def indexst(self, *args):
        raise Pcode2codeException(&#39;not implemented indexst&#39;)

    # TODO: to check
    def argsst(self, var, numparams):
        nb_parameters = int(numparams, 16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = var + &#39;(&#39; + params[0]
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;

        param2 = self.opstack.pop()
        val += &#39; = &#39; + param2
        self.opstack.push(val)

    def argsmemst(self, var, numparams):
        #TODO: to check
        val = self.opstack.pop() + &#39;.&#39;
        nb_parameters = int(numparams,16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + var + &#39;(&#39; + params[0]
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;

        param2 = self.opstack.pop()
        val += &#39; = &#39; + param2
        self.opstack.push(val)

    def argsdictst(self, var, numparams):
        &#34;&#34;&#34;
        used when an index of an obj with an argument is defined
        example: myobj!titi2(&#34;toto&#34;) = &#34;toto&#34;
        gives:
             # LitStr 0x0004 &#34;toto&#34;
             # LitStr 0x0004 &#34;toto&#34;
             # Ld myobj
             # ArgsDictSt titi2 0x0001
        &#34;&#34;&#34;
        val = self.opstack.pop() + &#39;!&#39; 
        nb_parameters = int(numparams,16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + var + &#39;(&#39; + params[0]
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;

        param2 = self.opstack.pop()
        val += &#39; = &#39; + param2
        self.opstack.push(val)
        
        
        
    def set_(self, var):
        val = &#39;Set &#39; + var + &#39; = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def memset(self, var):
        &#34;&#34;&#34;
        obtained when a property of an object is set
        example: Set YourObject.Text = lobject
        gives:
             # SetStmt
             # Ld lobject
             # Ld YourObject
             # Memset Text
        &#34;&#34;&#34;
        val = &#39;Set &#39; + self.opstack.pop() + &#39;.&#39; + var + &#39; = &#39; + self.opstack.pop()
        self.opstack.push(val)
        
    def dictset(self, var):
        &#34;&#34;&#34;
        obtained when an index of an object is set
        example: Set YourObject!Text = lobject
        gives:
             # SetStmt
             # Ld lobject
             # Ld YourObject
             # Dictset Text
        &#34;&#34;&#34;
        val = &#39;Set &#39; + self.opstack.pop() + &#39;!&#39; + var + &#39; = &#39; + self.opstack.pop()
        self.opstack.push(val)


    def indexset(self, *args):
        raise Pcode2codeException(&#39;not implemented indexset&#39;)

    def argsset(self, var, nb):
        &#34;&#34;&#34;
        obtained when an argument of an object is set
        example: Set YourObject(ggg) = lobject
        gives:
             # SetStmt
             # Ld lobject
             # Ld ggg
             # ArgsSet YourObject 0x0001
        &#34;&#34;&#34;
        val = &#39;Set &#39; + var + &#39;(&#39; + self.opstack.pop() + &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def argsmemset(self, var, numparams):
        &#34;&#34;&#34;
        obtained when an argument of a property of an object is set
        example: Set YourObject.Text2(&#34;titi&#34;) = lobject
        gives:
             # SetStmt
             # Ld lobject
             # LitStr 0x0004 &#34;titi&#34;
             # Ld YourObject
             # ArgsMemSet Text2 0x0001
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;Set &#39; + self.opstack.pop() + &#39;.&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)

        
    def argsdictset(self, var, numparams):
        &#34;&#34;&#34;
        obtained when an argument of a property of an object is set
        example: Set YourObject.Text2(&#34;titi&#34;) = lobject
        gives:
             # SetStmt
             # Ld lobject
             # LitStr 0x0004 &#34;titi&#34;
             # Ld YourObject
             # ArgsMemSet Text2 0x0001
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;Set &#39; + self.opstack.pop() + &#39;!&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)


    def memldwith(self, var):
        &#34;&#34;&#34;
        command defining a part of an object like .&lt;prop&gt;
        example: with blah &lt;....&gt; .Name 
        gives:  # MemLdWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;.&#39; + var)

    def dictldwith(self, var):
        &#34;&#34;&#34;
        accessing an index in a with block
        example: With &lt;smth&gt;.... Debug.Print !au_lname ... end with
        gives:
             # Debug
             # PrintObj
             # DictLdWith au_lname
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;!&#39; + var)

    def argsmemldwith(self, var, numparams):
        &#34;&#34;&#34;
        example: .CodePane.SetSelection .ProcStartLine(sProc, ProcType) + lLine, 1, .ProcStartLine(sProc, ProcType) + lLine + 1, 1
        gives:
             # Ld sProc
             # Ld ProcType
             # ArgsMemLdWith ProcStartLine 0x0002
             # Ld lLine
             # Add
             # LitDI2 0x0001
             # Ld sProc
             # Ld ProcType
             # ArgsMemLdWith ProcStartLine 0x0002
             # Ld lLine
             # Add
             # LitDI2 0x0001
             # Add
             # LitDI2 0x0001
             # MemLdWith CodePane
             # ArgsMemCall SetSelection 0x0004
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;.&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)

        
    def argsdictldwith(self, var, numparams):
        &#34;&#34;&#34;
        command used when an index of an object with an argument is accessed with a with block
        example: With myobj ... Debug.Print !toto(&#34;titi&#34;) ... end with
        gives:
             # Debug
             # PrintObj
             # LitStr 0x0004 &#34;titi&#34;
             # ArgsDictLdWith toto 0x0001
             # PrintItemNL
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;!&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)


    def memstwith(self, var):
        &#34;&#34;&#34;
        command defining a part of an object like .&lt;prop&gt; = &lt;smthg&gt;
        example: .Name = &#34;Coho Vineyard&#34;
        gives:
             # LitStr 0x000D &#34;Coho Vineyard&#34;
             # MemStWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;.&#39; + var + &#39; = &#39; + self.opstack.pop())

        
    def dictstwith(self, var):
        &#34;&#34;&#34;
        command defining a part of an object like !&lt;index&gt; = &lt;smthg&gt;
        example: With ... !Name = &#34;Coho Vineyard&#34; ... end with
        gives:
             # LitStr 0x000D &#34;Coho Vineyard&#34;
             # DictStWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;!&#39; + var + &#39; = &#39; + self.opstack.pop())

        
    def argsmemstwith(self, var, numparams):
        &#34;&#34;&#34;
        command defining a property of an object with arguments in a with statement
        example: With ... .Name(1,2) = b ... end with
        gives:
             # Ld B
             # LitDI2 0x0001
             # LitDI2 0x0002
             # ArgsMemStWith Name 0x0002
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;.&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def argsdictstwith(self, var, *args):
        &#34;&#34;&#34;
        command defining a part of an object like !&lt;index&gt; = &lt;smthg&gt; in a with block
        example: !Name = &#34;Coho Vineyard&#34;
        gives:
             # LitStr 0x000D &#34;Coho Vineyard&#34;
             # DictStWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;!&#39; + var + &#39; = &#39; + self.opstack.pop())


    def memsetwith(self, var):
        &#34;&#34;&#34;
        command defining a set on an index of an object in a with block
        example: with &lt;smth&gt; ... Set .Name = &#34;Coho Vineyard&#34;
        gives:
             # SetStmt
             # LitStr 0x000D &#34;Coho Vineyard&#34;
             # memSetWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;Set .&#39; + var + &#39; = &#39; + self.opstack.pop())

        
    def dictsetwith(self, var):
        &#34;&#34;&#34;
        command defining a set on an index of an object in a with block
        example: with &lt;smth&gt; ... Set !Name = &#34;Coho Vineyard&#34;
        gives:
             # SetStmt
             # LitStr 0x000D &#34;Coho Vineyard&#34;
             # DictSetWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;Set !&#39; + var + &#39; = &#39; + self.opstack.pop())

    def argsmemsetwith(self, var, numparams):
        &#34;&#34;&#34;
        command defining a set on an index with an argument of an object in a with block
        example: with &lt;smth&gt; ... Set .nini(&#34;gg&#34;, &#34;ff&#34;, &#34;uu&#34;) = &#34;toto&#34;
        gives:
             # SetStmt
             # LitStr 0x0004 &#34;toto&#34;
             # LitStr 0x0002 &#34;gg&#34;
             # LitStr 0x0002 &#34;ff&#34;
             # LitStr 0x0002 &#34;uu&#34;
             # ArgsMemSetWith nini 0x0003
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;Set !&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def argsdictsetwith(self, var, numparams):
        &#34;&#34;&#34;
        command defining a set on an index with an argument of an object in a with block
        example: with &lt;smth&gt; ... Set !nini(&#34;gg&#34;, &#34;ff&#34;, &#34;uu&#34;) = &#34;toto&#34;
        gives:
             # SetStmt
             # LitStr 0x0004 &#34;toto&#34;
             # LitStr 0x0002 &#34;gg&#34;
             # LitStr 0x0002 &#34;ff&#34;
             # LitStr 0x0002 &#34;uu&#34;
             # ArgsDictSetWith nini 0x0003
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;Set !&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)

    
    def argscall(self, *args):

        if args[0] == &#39;(Call)&#39;:
            nb_parameters = int(args[2],16)
            val = &#39;Call &#39; + args[1] + &#39;(&#39;
            end_val = &#39;)&#39;
        else:
            val = args[0]
            nb_parameters = int(args[1],16)           
            end_val = &#39;&#39;
            
        params = []
        #print &#39;func:&#39; + funcname
        #print &#39;nbparameters : &#39; + str(nb_parameters)
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            if ((params[0].startswith(&#39;(&#39;)) or (args[0] == &#39;(Call)&#39;)):               
                val = val + params[0]
            else:
                val = val + &#39; &#39; + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += end_val
        self.opstack.push(val)

    def argsmemcall(self, *args):
        &#34;&#34;&#34;
        command to call a function of an object
        example: a43g0xT.run ayUBnLK01, 0
        gives : 
           # Ld ayUBnLK01
           # LitDI2 0x0000
           # Ld a43g0xT
           # ArgsMemCall run 0x0002
        &#34;&#34;&#34;
        args = list(args)
        parenthesis = False
        if args[0] == &#39;(Call)&#39;:
            args.pop(0)
            val = &#39;Call &#39; + self.opstack.pop() + &#39;.&#39; + args[0] + &#39;(&#39;
            parenthesis = True
        else:
            val = self.opstack.pop() + &#39;.&#39; + args[0]

        nb_parameters = int(args[1],16)           
        end_val = &#39;&#39;
            
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            if params[0].startswith(&#39;(&#39;):               
                val = val + params[0]
                end_val = &#39;)&#39;
            else:
                if not parenthesis:
                    val = val + &#39; &#39; +params[0]
                else:
                    val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        if parenthesis == True:
            end_val = &#39;)&#39;
        self.opstack.push(val + end_val)

    def argsmemcallwith(self, *args):
        &#34;&#34;&#34;
        command when a function of an object is called in a with definition
        example: With a ... call .a(1,2) ... end with
        gives: 
             # LitDI2 0x0001
             # LitDI2 0x0002
             # ArgsMemCallWith (Call) a 0x0002
        &#34;&#34;&#34;
        parenthesis = False
        args = list(args)
        if args[0] == &#39;(Call)&#39;:
            args.pop(0)
            parenthesis = True
            val = &#39;Call .&#39; + args[0] + &#39;(&#39;
        else:
            val = &#39;.&#39; + args[0]
            
        nb_parameters = int(args[1],16)           
        end_val = &#39;&#39;
            
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            if params[0].startswith(&#39;(&#39;):               
                val = val + params[0]
                end_val = &#39;)&#39;
            else:
                if not parenthesis:
                    val = val + &#39; &#39; + params[0]
                else:
                    val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param

        if parenthesis:
            end_val = &#39;)&#39;
        self.opstack.push(val + end_val)
        

    def argsarray(self, var, numparams):
        val = var + &#39;(&#39;
        nb_parameters = int(numparams,16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)

    def assert_(self):
        &#34;&#34;&#34;
        command for debug.asser
        example: Debug.Assert blnAssert
        gives : 
              # Ld blnAssert
              # Assert
        &#34;&#34;&#34;
        self.opstack.push(&#39;Debug.Assert &#39; + self.opstack.pop())

    def bos(self, valarg):
        arg = int(valarg,16)
        if arg == 0:
            val = self.opstack.pop() + &#39;:&#39;
        self.opstack.push(val)
        self.has_bos = True

    def bosimplicit(self, *args):
        &#34;&#34;&#34;
        appears useless, but in this case we still need to print whole stack
        example: If Mid$(theString, i, 1) &lt;&gt; Chr$(0) Then Exit For
        gives:
             # Ld theString
             # Ld i
             # LitDI2 0x0001
             # ArgsLd Mid$ 0x0003
             # LitDI2 0x0000
             # ArgsLd Chr$ 0x0001
             # Ne
             # If
             # BoSImplicit
             # ExitFor
             # EndIf
        &#34;&#34;&#34;
        self.has_bos = True
        
    def bol(self, *args):
        raise Pcode2codeException(&#39;not implemented bol&#39;)

    def ldaddressof(self, var):
        &#34;&#34;&#34;
        command for AddressOf keyword
        example: EnumFontFamilies hDC, vbNullString, AddressOf EnumFontFamProc, LB
        gives:
             # Ld hDC
             # Ld vbNullString
             # LdAddressOf EnumFontFamProc
             # Ld LB
             # ArgsCall EnumFontFamilies 0x0004
        &#34;&#34;&#34;
        self.opstack.push(&#39;AddressOf &#39; + var)

    def memaddressof(self, var):
        &#34;&#34;&#34;
        command for AddressOf keyword on a property of an object
        example: MsgBox AddressOf myobj.toto
        gives:
             # Ld myobj
             # MemAddressOf toto
             # ArgsCall MsgBox 0x0001
        &#34;&#34;&#34;
        self.opstack.push(&#39;AddressOf &#39; + self.opstack.pop() + &#39;.&#39; + var)

    def case(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is one value 
        example: Case 0
        gives:
             # LitDI2 0x0000
             # Case
             # CaseDone

        &#34;&#34;&#34;
        self.opstack.push(&#39;Case &#39; + self.opstack.pop())

    def caseto(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is from one value to one other value
        example: Case 0 To 30
        gives:
             # LitDI2 0x0000
             # LitDI2 0x001E
             # CaseTo
             # CaseDone
        &#34;&#34;&#34;
        val = self.opstack.pop()
        self.opstack.push(&#39;Case &#39; + self.opstack.pop() + &#39; To &#39; + val)


    def casegt(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is lower than a value
        example: Case Is &gt; 100
        gives:
             # LitDI2 0x0064
             # CaseGt
             # CaseDone
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is &gt; &#39; + self.opstack.pop())

    def caselt(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is lower than a value
        example: Case Is &lt; 0
        gives:
             # LitDI2 0x0002
             # CaseLt
             # CaseDone
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is &lt; &#39; + self.opstack.pop())

    def casege(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is greater or equal than a value
        example: TODO: to check
        gives:
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is &gt;= &#39; + self.opstack.pop())

    def casele(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is lower or equal than a value
        example: TODO: to check
        gives:
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is &lt;= &#39; + self.opstack.pop())

    def casene(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is different to a value
        example: TODO: to check
        gives:
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is &lt;&gt; &#39; + self.opstack.pop())

    def caseeq(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is equal to a value
        example: TODO: to check
        gives:
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is = &#39; + self.opstack.pop())

    def caseelse(self):
        &#34;&#34;&#34;
        command defining a &#34;Case Else&#34; stmt
        example: Case Else
        gives: 
             # CaseElse
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Else&#39;)

    def casedone(self):
        #pass on purpose, please see previous examples
        pass

    def circle(self, useless):
        &#34;&#34;&#34;
        command used when the circle method of an object is called
        example: Me.Circle (sngHCtr, sngVCtr), sngRadius
        gives:
             # Ld sngHCtr
             # Ld sngVCtr
             # Ld sngRadius
             # LitDI2 0x0000
             # LitDI2 0x0000
             # LitDI2 0x0000
             # LitDI2 0x0000
             # Ld id_FFFF
             # Circle 0x001E
        &#34;&#34;&#34;
        val = self.opstack.pop() + &#39;.Circle (&#39;
        params = []
        for i in range(7):
            params.append(self.opstack.pop())
        params = params[::-1]

        val += params[0] + &#39;, &#39; + params[1] + &#39;), &#39; + params[2]
        all_empty = True
        for param in params[3:]:
            if param != &#39;0&#39;:
                all_empty = False

        if all_empty:
            self.opstack.push(val)
        else:
            for param in params[3:]:
                if param == &#39;0&#39;:
                    val = val + &#39;, &lt;tbr&gt;&#39;
                else:
                    val = val + &#39;, &#39; + param
            val = val.replace(&#39;, &lt;tbr&gt;&#39; , &#39;&#39;)
            self.opstack.push(val)


    def close(self, numparams):
        val = &#39;Close &#39;
        nb_parameters = int(numparams,16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        self.opstack.push(val)

    def closeall(self):
        &#34;&#34;&#34;
        command used when close is called with no arguments, effectively closing all files
        example: Close
        gives: # CloseAll
        &#34;&#34;&#34;
        self.opstack.push(&#39;Close&#39;)

    def coerce_(self, arg):
        &#34;&#34;&#34;
        command used for variable conversion
        example1: MyLong2 = CLng(MyVal2)
        gives:
             # Ld MyVal2
             # Coerce (Lng)
             # St MyLong2
        example2: MyInt = CInt(MyDouble)
        gives:
             # Ld MyDouble
             # Coerce (Int)
             # St MyInt
        &#34;&#34;&#34;
        if arg == &#39;(Str)&#39;:
            self.opstack.push(&#39;CStr(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Var)&#39;:
            self.opstack.push(&#39;CVar(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Sng)&#39;:
            self.opstack.push(&#39;CSng(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Lng)&#39;:
            self.opstack.push(&#39;CLng(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Int)&#39;:
            self.opstack.push(&#39;CInt(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Dbl)&#39;:
            self.opstack.push(&#39;CDbl(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Date)&#39;:
            self.opstack.push(&#39;CDate(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Cur)&#39;:
            self.opstack.push(&#39;CCur(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Byte)&#39;:
            self.opstack.push(&#39;CByte(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Bool)&#39;:
            self.opstack.push(&#39;CBool(&#39; + self.opstack.pop() + &#39;)&#39;)
        else:
            raise Pcode2codeException(&#39;not implemented coerce&#39;)
        
    def coercevar(self, arg):
        &#34;&#34;&#34;
        example1: MyError = CVErr(32767)
        gives: # CoerceVar (Err)
        &#34;&#34;&#34;
        if arg == &#39;(Err)&#39;:
            self.opstack.push(&#39;CVErr(&#39; + self.opstack.pop() + &#39;)&#39;)
        else:
            raise Pcode2codeException(&#39;not implemented coercevar&#39;)

    def context(self, *args):
        raise Pcode2codeException(&#39;not implemented context&#39;)

    def debug(self):
        &#34;&#34;&#34;
        seems used to invoke debug object
        example: Debug.Print MyVar
        gives:
             # Debug
             # PrintObj
             # Ld MyVar
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Debug&#39;)

    def deftype(self, *args):
        &#34;&#34;&#34;
        command used when def&lt;type&gt; is used.
        TODO: bytes to know ranges appear random. How to do it?
        &#34;&#34;&#34;
        raise Pcode2codeException(&#39;not implemented deftype&#39;)

    # Dim hiz7dgus As String
    # Private Const DefaultBufferSize&amp; = 32768
    # Private CRC_32_Tab(0 To 255) As Long
    # ======================
    # Line #7:
    #   Dim 
    #   VarDefn hiz7dgus (As String)
    # Line #8:
    # Line #9:
    #   Dim (Private Const) 
    #   LitDI4 0x8000 0x0000 
    #   VarDefn DefaultBufferSize
    # Line #10:
    # Line #11:
    #   Dim (Private) 
    #   LitDI2 0x0000 
    #   LitDI2 0x00FF 
    #   VarDefn CRC_32_Tab (As Long)
    def dim(self, *args):
        # args is a tuple, we treat it only when its not empty
        # example of args : (As String), (As Long)...
        if args != ():
            val = args[0]
            for arg in args[1:]:
                val += &#39; &#39; + arg
            val = val[1:-1]
        else:
            val = &#39;Dim&#39;
        self.opstack.push(val)

    def dimimplicit(self):
        self.opstack.push(&#39;DimImplicit&#39;)

    def do(self):
        &#34;&#34;&#34;
        command handling &#34;Do&#34; keyword
        example: Do (we have then the loop and so on)
        gives:
             # Do
        &#34;&#34;&#34;
        self.opstack.push(&#39;Do&#39;)
        self.indentincrease_future = True

    def doevents(self, *args):
        raise Pcode2codeException(&#39;not implemented doevents&#39;)

    def dounitil(self):
        &#34;&#34;&#34;
        command handling &#34;do until&#34; definitions
        example: Do Until Response = &#34;youpi&#34;
        gives:
             # Ld Response
             # ListStr 0x0005 &#34;youpi&#34;
             # Eq
             # DoUnitil
        &#34;&#34;&#34;
        self.opstack.push(&#39;Do Until &#39; + self.opstack.pop())
        self.indentincrease_future = True

    def dowhile(self):
        &#34;&#34;&#34;
        command handling &#34;do while&#34; definitions
        example: Do While Reponse &lt;&gt; &#34;youpi&#34;
        gives:
             # Ld Response
             # LitStr 0x0005 &#34;youpi&#34;
             # Ne
             # DoWhile
        &#34;&#34;&#34;
        self.opstack.push(&#39;Do While &#39; + self.opstack.pop())
        self.indentincrease_future = True

    def else_(self):
        &#34;&#34;&#34;
        command used for a &#34;else&#34; in a if oneliner
        example: If X &lt; 4 Then MsgBox &#34;hi&#34; Else MsgBox &#34;ho&#34;
        gives:
             # Ld X
             # LitDI2 0x0004
             # Lt
             # If
             # BoSImplicit
             # LitStr 0x0002 &#34;hi&#34;
             # ArgsCall MsgBox 0x0001
             # Else
             # BoSImplicit
             # LitStr 0x0002 &#34;Ho&#34;
             # ArgsCall MsgBox 0x0001
             # EndIf
        &#34;&#34;&#34;
        self.opstack.push(&#39;Else&#39;)

    def elseblock(self):
        &#34;&#34;&#34;
        command defining a new &#34;else&#34; for a block
        example: Else
        gives: #Else
        &#34;&#34;&#34;
        self.opstack.push(&#39;Else&#39;)
        self.indentlevel = self.indentlevel - 1
        self.indentincrease_future = True

    def elseifblock(self):
        &#34;&#34;&#34;
        command defining a new &#34;else if&#34; block
        example: ElseIf dayW = DayOfWeek.Thursday Then
        gives:
             # Ld dayW
             # Ld DayOfWeek
             # MemLd Thursday
             # Eq
             # ElseIfBlock
        &#34;&#34;&#34;
        self.opstack.push(&#39;ElseIf &#39; + self.opstack.pop() + &#39; Then&#39;)
        self.indentlevel = self.indentlevel - 1
        self.indentincrease_future = True

    def elseiftypeblock(self, *args):
        raise Pcode2codeException(&#39;not implemented elseiftypeblock&#39;)

    def end(self):
        self.opstack.push(&#39;End&#39;)

    def endcontext(self, *args):
        raise Pcode2codeException(&#39;not implemented endcontext&#39;)

    def endfunc(self):
        self.opstack.push(&#39;End Function&#39;)
        self.indentlevel = self.indentlevel - 1

    def endif(self):
        if self.onelineif == True:
            self.onelineif = False
        else:
            self.opstack.push(&#39;End If&#39;)
            self.indentlevel = self.indentlevel - 1

    def endifblock(self):
        self.opstack.push(&#39;End If&#39;)
        self.indentlevel = self.indentlevel - 1

    def endimmediate(self, *args):
        raise Pcode2codeException(&#39;not implemented endimmediate&#39;)

    def endprop(self):
        &#34;&#34;&#34;
        command handling the end of a property
        example: End Property
        gives: 
             #EndProp
        &#34;&#34;&#34;
        self.opstack.push(&#39;End Property&#39;)
        self.indentlevel = self.indentlevel -1

    def endselect(self):
        &#34;&#34;&#34;
        command defining a stmt of &#34;End Select&#34;, closing a select case.
        example: End Select
        gives: 
             # EndSelect
        &#34;&#34;&#34;
        self.opstack.push(&#39;End Select&#39;)
        self.indentlevel = self.indentlevel - 1

    def endsub(self):
        self.opstack.push(&#39;End Sub&#39;)
        self.indentlevel = self.indentlevel - 1

    def endtype(self):
        &#34;&#34;&#34;
        command to end a new type definition
        example: End Type
        gives:
             #EndType
        &#34;&#34;&#34;
        self.opstack.push(&#39;End Type&#39;)
        self.indentlevel = self.indentlevel - 1

    def endwith(self):
        &#34;&#34;&#34;
        command to end a new with definition
        example: End With
        gives: #EndWith
        &#34;&#34;&#34;
        self.opstack.push(&#39;End With&#39;)
        self.indentlevel = self.indentlevel - 1
        

    def erase(self, nb_params):
        &#34;&#34;&#34;
        command for Erase function keyword
        example: Erase threeDimArray, twoDimArray
        gives:
             # Ld threeDimArray
             # Ld twoDimArray
             # Erase 0x0002
        &#34;&#34;&#34;
        nb_args = int(nb_params, 16)
        val = &#39;&#39;
        params = []
        for i in range(nb_args):
            params.append(self.opstack.pop())
            params = params[::-1]
        val = params[0]
            
        if nb_args &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param

        self.opstack.push(&#39;Erase &#39; + val)


    def error(self):
        &#34;&#34;&#34;
        command used for Error keyword
        example: Error 11
        gives:
             # LitDI2 0x000B
             # Error
        &#34;&#34;&#34;
        self.opstack.push(&#39;Error &#39; + self.opstack.pop())

    def eventdecl(self, *args):
        &#34;&#34;&#34;
        command for declaring a new event in VBA
        example: Event LogonCompleted(UserName As String)
        gives : 
           # EventDecl (Sub LogonCompleted(UserName As String))
        &#34;&#34;&#34;
        val = args[1]
        for arg in args[2:-1]: #strip parenthesis
            val += &#39; &#39; + arg
        self.opstack.push(&#39;Event &#39; + val + &#39; &#39; + args[-1][:-1])

    def raiseevent(self, evt_name, nb_params):
        &#34;&#34;&#34;
        command when RaiseEvent is used
        example: RaiseEvent LogonCompleted(&#34;AntoineJean&#34;)
        gives:
             # LitStr 0x000A &#34;AntoineJan&#34;
             # RaiseEvent LogonCompleted 0x0001
        &#34;&#34;&#34;
        nb_args = int(nb_params, 16)
        val = &#39;&#39;
        params = []
        if nb_args &gt; 0:
            for i in range(nb_args):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = &#39;(&#39;+ params[0]
            
            if nb_args &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;
                    
        self.opstack.push(&#39;RaiseEvent &#39; + evt_name + val)
            

    def argsmemraiseevent(self, var, numparams):
        &#34;&#34;&#34;
        command used when a raiseevent is called on a property of an object
        example: RaiseEvent myobj.LogonCompleted(&#34;AntoineJan&#34;)
        gives:
             # LitStr 0x000A &#34;AntoineJan&#34;
             # Ld myobj
             # ArgsMemRaiseEvent LogonCompleted 0x0001
        &#34;&#34;&#34;
        nb_args = int(numparams, 16)
        val = &#39;RaiseEvent &#39; + self.opstack.pop() + &#39;.&#39; + var + &#39;(&#39;
        params = []
        if nb_args &gt; 0:
            for i in range(nb_args):
                params.append(self.opstack.pop())
            params = params[::-1]
            val += params[0]
            
            if nb_args &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;
        self.opstack.push(val)

    def argsmemraiseeventwith(self, var, numparams):
        &#34;&#34;&#34;
        command used when a raiseevent is called on a property of an object within a with block
        example: with myobj ... RaiseEvent .LogonCompleted(&#34;AntoineJan&#34;) ... end with
        gives:
             # LitStr 0x000A &#34;AntoineJan&#34;
             # ArgsMemRaiseEventWith LogonCompleted 0x0001
        &#34;&#34;&#34;
        nb_args = int(numparams, 16)
        val = &#39;RaiseEvent .&#39; + var + &#39;(&#39;
        params = []
        if nb_args &gt; 0:
            for i in range(nb_args):
                params.append(self.opstack.pop())
            params = params[::-1]
            val += params[0]
            
            if nb_args &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;
        self.opstack.push(val)
    
    def exitdo(self):
        #TODO: comment
        self.opstack.push(&#39;Exit Do&#39;)

    def exitfor(self):
        #TODO: comment
        self.opstack.push(&#39;Exit For&#39;)

    def exitfunc(self):
        #TODO: comment
        self.opstack.push(&#39;Exit Function&#39;)
    
    def exitprop(self):
        #TODO: comment
        self.opstack.push(&#39;Exit Property&#39;)
    
    def exitsub(self):
        #TODO: comment
        self.opstack.push(&#39;Exit Sub&#39;)
    
    def fncurdir(self, *args):
        #val = &#39;CurDir(&#39; + self.opstack.pop() + &#39;)&#39;
        #self.opstack.push(val)
        raise Pcode2codeException(&#39;not implemented fncurdir&#39;)
    
    def fndir(self, *args):
        raise Pcode2codeException(&#39;not implemented fndir&#39;)
    
    def empty0(self, *args):
        raise Pcode2codeException(&#39;not implemented empty0&#39;)
    
    def empty1(self, *args):
        raise Pcode2codeException(&#39;not implemented empty1&#39;)
    
    def fnerror(self, *args):
        raise Pcode2codeException(&#39;not implemented fnerror&#39;)
    
    def fnformat(self, *args):
        raise Pcode2codeException(&#39;not implemented format&#39;)
    
    def fnfreefile(self, *args):
        raise Pcode2codeException(&#39;not implemented fnfreefile&#39;)
    
    def fninstr(self):
        &#34;&#34;&#34;
        command used when calling Instr function with 2 arguments
        example: MyPos = InStr(SearchString, SearchChar)
        gives:
             # Ld SearchString
             # Ld SearchChar
             # FnInStr
             # St MyPos
        &#34;&#34;&#34;
        arg2 = self.opstack.pop()
        self.opstack.push(&#39;Instr(&#39; + self.opstack.pop() + &#39;, &#39; + arg2 + &#39;)&#39;)
    
    def fninstr3(self):
        &#34;&#34;&#34;
        command used when calling Instr function with 3 arguments
        example: MyPos = InStr(1, SearchString, &#34;W&#34;)
        gives:
             # LitDI2 0x0001
             # Ld SearchString
             # LitStr 0x0001 &#34;W&#34;
             # FnInStr3
             # St MyPos
        &#34;&#34;&#34;
        arg3 = self.opstack.pop()
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        self.opstack.push(&#39;Instr(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;)&#39;)
    
    def fninstr4(self):
        &#34;&#34;&#34;
        command used when calling Instr function with 4 arguments
        example: MyPos = InStr(4, SearchString, SearchChar, 1)
        gives:
             # LitDI2 0x0004
             # Ld SearchString
             # Ld SearchChar
             # LitDI2 0x0001
             # FnInStr4
             # St MyPos
        &#34;&#34;&#34;
        arg4 = self.opstack.pop()
        arg3 = self.opstack.pop()
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        self.opstack.push(&#39;Instr(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;, &#39; + arg4 + &#39;)&#39;)
    
    def fninstrb(self):
        &#34;&#34;&#34;
        command used when calling InstrB function with 2 arguments
        example: TODO: make sure here
        gives:
        &#34;&#34;&#34;
        arg2 = self.opstack.pop()
        self.opstack.push(&#39;InstrB(&#39; + self.opstack.pop() + &#39;, &#39; + arg2 + &#39;)&#39;)

        
    def fninstrb3(self):
        &#34;&#34;&#34;
        command used when calling InstrB function with 3 arguments
        example: TODO: make sure here
        gives:

        &#34;&#34;&#34;
        arg3 = self.opstack.pop()
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        self.opstack.push(&#39;InstrB(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;)&#39;)

        
    def fninstrb4(self):
        &#34;&#34;&#34;
        command used when calling InstrB function with 4 arguments
        example: TODO: make sure here
        gives:

        &#34;&#34;&#34;
        arg4 = self.opstack.pop()
        arg3 = self.opstack.pop()
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        self.opstack.push(&#39;Instr(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;, &#39; + arg4 + &#39;)&#39;)
    
    def fnlbound(self, arg):
        &#34;&#34;&#34;
        command indicating the use of the LBound function
        strangely enough, there is an indication of the number of arguments to be popped out of the stack
        but this number is not good.
        example: Lower = LBound(TwoDArray, 2)
        gives: 
             # Ld TwoDArray
             # LitDI2 0x0002
             # FnLBound 0x0001
             # St Lower
        &#34;&#34;&#34;
        nb_parameters = int(arg,16) + 1
        params = []
        val = &#39;(&#39;
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        val = &#39;LBound&#39; + val
        self.opstack.push(val)
    
    def fnmid(self):
        val = &#39;Mid(&#39; + self.opstack.pop() + &#39;)&#39;
        self.opstack.push(val)
    
    def fnmidb(self):
        val = &#39;MidB(&#39; + self.opstack.pop() + &#39;)&#39;
        self.opstack.push(val)
    
    def fnstrcomp(self):
        &#34;&#34;&#34;
        command used when strcomp function with 2 arguments is called
        example: MyComp = StrComp(MyStr2, MyStr1)
        gives:
             # Ld MyStr2
             # Ld MyStr1
             # FnStrComp
             # St MyComp
        &#34;&#34;&#34;
        str2 = self.opstack.pop()
        str1 = self.opstack.pop()
        self.opstack.push(&#39;StrComp(&#39; + str1 + &#39;, &#39; + str2 + &#39;)&#39;)
            
    def fnstrcomp3(self):
        &#34;&#34;&#34;
        command used when strcomp function with 3 arguments is called
        example: MyComp = StrComp(MyStr1, MyStr2, 0)
        gives:
             # Ld MyStr1
             # Ld MyStr2
             # LitDI2 0x0000
             # FnStrComp3
             # St MyComp
        &#34;&#34;&#34;
        third_arg = self.opstack.pop()
        str2 = self.opstack.pop()
        str1 = self.opstack.pop()
        self.opstack.push(&#39;StrComp(&#39; + str1 + &#39;, &#39; + str2 + &#39;, &#39; + third_arg + &#39;)&#39;)
    
    def fnstringvar(self, *args):
        raise Pcode2codeException(&#39;not implemented fnstringvar&#39;)
    
    def fnstringstr(self, *args):
        raise Pcode2codeException(&#39;not implemented fnstringstr&#39;)
   
    def fnubound(self, arg):
        &#34;&#34;&#34;
        command used when calling Ubound function
        example: uL = UBound(sb_)
        gives:     
             # Ld sb_ 
             # FnUBound 0x0000 
             # St uL
        &#34;&#34;&#34;
        nb_parameters = int(arg,16) + 1
        params = []
        val = &#39;(&#39;
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        val = &#39;UBound&#39; + val
        self.opstack.push(val)
            
    def for_(self):
        maxvar = self.opstack.pop()
        minvar = self.opstack.pop()
        loopvar = self.opstack.pop()
        val = &#39;For &#39; + loopvar + &#39; = &#39; + minvar + &#39; To &#39; + maxvar
        self.opstack.push(val)
        self.indentincrease_future = True
            
    def foreach(self):
        &#34;&#34;&#34;
        command defining a new for each loop definition
        example: For Each MyObject In MyClasses
        gives:
             # StartForVariable
             # Ld MyObject
             # EndForVariable
             # Ld MyClasses
             # ForEach
        &#34;&#34;&#34;
        collect = self.opstack.pop()
        loopvar = self.opstack.pop()
        val = &#39;For Each &#39; + loopvar + &#39; In &#39; + collect
        self.opstack.push(val)
        self.indentincrease_future = True
    
    def foreachas(self, *args):
        raise Pcode2codeException(&#39;not implemented foreachas&#39;)
            
    def forstep(self):
        step = self.opstack.pop()
        maxvar = self.opstack.pop()
        minvar = self.opstack.pop()
        loopvar = self.opstack.pop()
        val = &#39;For &#39; + loopvar + &#39; = &#39; + minvar + &#39; To &#39; + maxvar + &#39; Step &#39; + step
        self.opstack.push(val)
        self.indentincrease_future = True
            
    def funcdefn(self, *args: str):
        val = args[0]
        for arg in args[1:]:
            val += &#39; &#39; + arg
        val = val[1:-1]
        self.opstack.push(val)
        if not val.startswith(&#39;Declare&#39;):
            self.indentincrease_future = True
            
    def funcdefnsave(self, *args):
        raise Pcode2codeException(&#39;not implemented funcdefnsave&#39;)
            
    def getrec(self):
        &#34;&#34;&#34;
        command to Get from a channel with a record: get channel, record, var
        example: Get #1, RecordNumber, MyRecord
        gives:
             # LitDI2 0x0001
             # Sharp
             # Ld RecordNumber
             # Ld MyRecord
             # GetRec
        &#34;&#34;&#34;
        record = self.opstack.pop()
        record_num = self.opstack.pop()
        chan = self.opstack.pop()
        if chan is not None:
            self.opstack.push(&#39;Get &#39; + chan + &#39;, &#39; + record_num + &#39;, &#39; + record)
        else:
            self.opstack.push(&#39;Get &#39; + record_num + &#39;, , &#39; + record) # kindly ugly
            
    def gosub(self, var):
        &#34;&#34;&#34;
        command used when gosub is used
        example: If Num &gt; 0 Then GoSub MyRoutine 
        gives:
             # Ld Num
             # LitDI2 0x0000
             # Gt
             # If
             # BoSImplicit
             # GoSub MyRoutine
             # EndIf
        &#34;&#34;&#34;
        self.opstack.push(&#39;GoSub &#39; + var)
            
    def goto(self, var):
        &#34;&#34;&#34;
        command used when a goto &lt;label&gt; is defined
        example: GoTo label1
        gives: # GoTo label1
        &#34;&#34;&#34;
        self.opstack.push(&#39;GoTo &#39; + var)

            
    def if_(self, *args):
        val = &#39;If &#39; + self.opstack.pop() + &#39; Then&#39;
        self.onelineif = True
        self.opstack.push(val)
    
    def ifblock(self):
        val = &#39;If &#39; + self.opstack.pop() + &#39; Then&#39;
        self.opstack.push(val)
        self.indentincrease_future = True
    
    def typeof(self, *args):
        &#34;&#34;&#34;
        command used when TypeOf function is used
        TODO: associated type is obscure for now
        &#34;&#34;&#34;
        raise Pcode2codeException(&#39;not implemented typeof&#39;)
            
    def iftypeblock(self, *args):
        raise Pcode2codeException(&#39;not implemented iftypeblock&#39;)
            
    def implements(self, *args):
        &#34;&#34;&#34;
        command used when Implements instruction is used
        TODO: associated type is obscure for now        
        &#34;&#34;&#34;
        raise Pcode2codeException(&#39;not implemented implements&#39;)
            
    def input_(self):
        &#34;&#34;&#34;
        command used when Input function is called
        example : Input #1, MyString, MyNumber
        gives: 
             # LitDI2 0x0001
             # Sharp
             # Input
             # Ld MyString
             # InputItem
             # Ld MyNumber
             # InputItem
             # InputDone        
        &#34;&#34;&#34;
        self.opstack.push(&#39;Input &#39; + self.opstack.pop())
        
    def inputdone(self):
        &#34;&#34;&#34;
        command used when Input function is called
        example : Input #1, MyString, MyNumber
        gives: 
             # LitDI2 0x0001
             # Sharp
             # Input
             # Ld MyString
             # InputItem
             # Ld MyNumber
             # InputItem
             # InputDone        
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            val += elmt
        self.opstack.push(val)

            
    def inputItem(self):
        &#34;&#34;&#34;
        command used when Input function is called
        example : Input #1, MyString, MyNumber
        gives: 
             # LitDI2 0x0001
             # Sharp
             # Input
             # Ld MyString
             # InputItem
             # Ld MyNumber
             # InputItem
             # InputDone        
        &#34;&#34;&#34;
        self.opstack.push(&#39;, &#39; + self.opstack.pop())
            
    def label(self, arg):
        &#34;&#34;&#34;
        command defining a new label
        example: MyString:
        gives:
             # Label MyString
        &#34;&#34;&#34;
        self.opstack.push(arg+&#39;:&#39;)
            
    def let(self, *args):
        &#34;&#34;&#34;
        command used when let keywork is used
        example: Let MyStr  = &#34;Hello World&#34;
        gives:
             # Let
             # LitStr 0x000B &#34;Hello World&#34;
             # St MyStr
        &#34;&#34;&#34;
        self.opstack.push(&#39;Let&#39;)
        self.has_bos = True #we use this hackish way to print it even if not in stack top

            
    def line(self, *args):
        raise Pcode2codeException(&#39;not implemented line&#39;)
            
    def linecont(self, *args):
        #pass on purpose
        pass
            
    def lineInput(self):
        &#34;&#34;&#34;
        command used when Line Input instruction is used (to read one line at a time a file)
        example: Line Input #1, TextLine
        gives:
             # LitDI2 0x0001
             # Ld TextLine
             # LineInput
        &#34;&#34;&#34;
        var = self.opstack.pop()
        num_file = self.opstack.pop()
        self.opstack.push(&#39;Line Input #&#39; + num_file + &#39;, &#39; + var)
            
    def linenum(self, *args):
        # ignoring this seems to work fine.
        return
            
    def litcy(self, *args):
        raise Pcode2codeException(&#39;not implemented litcy&#39;)
            
    def litdate(self, *args):
        &#34;&#34;&#34;
        command to define a date literal
        TODO: but wtf how to get date?
        example1: MyDate = #2/12/1969#
        gives: LitDate 0x0000 0x0000 0xA780 0x40D8
        example2: MyDate = #2/12/1970#
        gives: LitDate 0x0000 0x0000 0x02C0 0x40D9
        example3: MyDate = #2/12/1971#
        gives: LitDate 0x0000 0x0000 0x5E00 0x40D9
        example4: MyDate = #2/11/1969#
        gives: LitDate 0x0000 0x0000 0xA740 0x40D8
        example5: MyDate = #2/10/1969#
        gives: LitDate 0x0000 0x0000 0xA700 0x40D8
        example6: MyDate = #3/12/1969#
        gives: LitDate 0x0000 0x0000 0xAE80 0x40D8
        example7: MyDate = #4/12/1969#
        gives: LitDate 0x0000 0x0000 0xB640 0x40D8


        1 year = 23360 (0x5b40) si on fait last2bytes.first2bytes
        1 month = 64 (0x40) sur second octet
        1 day = 
        &#34;&#34;&#34;
        raise Pcode2codeException(&#39;a date is defined here, but it cannot be reconstructed&#39;)
            
    def litdefault(self):
        &#34;&#34;&#34;
        appears to be useless
        example: Open &#34;TESTFILE&#34; For Output As #1 
        gives:
             # LitStr 0x0008 &#34;TESTFILE&#34;
             # LitDI2 0x0001
             # Sharp
             # LitDefault
             # Open (For Output)
        example2: Lock #1, RecordNumber
        gives:
             # LitDI2 0x0001
             # Sharp
             # Ld RecordNumber
             # LitDefault
             # Lock
        example3: same for unlock
        &#34;&#34;&#34;
        #pass on purpose

    # integer representation on 2 bytes (decimal base10)
    def litdi2(self, value):
        self.opstack.push(str(int(value,16)))

    # integer representation on 4 bytes (decimal base10)
    def litdi4(self, byte1, byte2):
        val = int(byte2+byte1[2:], 16)
        self.opstack.push(str(val))
        
    def litdi8(self, *args):
        raise Pcode2codeException(&#39;not implemented litdi8&#39;)
            
    def lithi2(self, byte):
        val = byte[2:]
        while val.startswith(&#39;0&#39;) and len(val) &gt; 1:
            val = val[1:]
        val = &#39;&amp;H&#39; + val
        self.opstack.push(val)
            
    def lithi4(self, byte1, byte2):
        val = byte2[2:]+byte1[2:]
        while val.startswith(&#39;0&#39;) and len(val) &gt; 1:
            val = val[1:]
        val = &#39;&amp;H&#39; + val
        self.opstack.push(val)
            
    def lithi8(self, *args):
        raise Pcode2codeException(&#39;not implemented lithi8&#39;)
            
    def litnothing(self):
        &#34;&#34;&#34;
        command defining the &#34;Nothing&#34; variable
        example: Set Inst = Nothing
        gives:
             # SetStmt
             # LitNothing
             # Set Inst
        &#34;&#34;&#34;
        self.opstack.push(&#39;Nothing&#39;)
            
    def litoi2(self, value):
        &#34;&#34;&#34;
        command used when an octal is defined on a two bytes byte array
        example: B = &amp;O1
        gives:
             # LitOI2 0x0001
             # St B
        &#34;&#34;&#34;
        var = int(value,16)
        var2 = str(oct(var))[2:]
        self.opstack.push(&#39;&amp;O&#39; + var2)
            
    def litoi4(self, byte1, byte2):
        &#34;&#34;&#34;
        command used when an octal is defined on a two bytes byte array
        example: B = &amp;O12345644444
        gives:
             # LitOI4 0x4924 0x5397
             # St B
        &#34;&#34;&#34;        
        val = byte2[2:]+byte1[2:]
        var = int(val,16)
        var2 = str(oct(var))[2:]
        self.opstack.push(&#39;&amp;O&#39; + var2)
        
            
    def litoi8(self, *args):
        raise Pcode2codeException(&#39;not implemented litoi8&#39;)
            
    def litr4(self, byte1, byte2):
        &#34;&#34;&#34;
        command used when a floating point on 32 bit is declared
        &#34;&#34;&#34;
        val = byte2[2:]+byte1[2:]
        self.opstack.push(str(struct.unpack(&#34;!f&#34;, bytes.fromhex(val))[0]))
            
    def litr8(self, byte1, byte2, byte3, byte4):
        &#34;&#34;&#34;
        command used when a floating point on 64 bit is declared
        &#34;&#34;&#34;
        val = byte4[2:]+byte3[2:]+byte2[2:]+byte1[2:]
        self.opstack.push(str(struct.unpack(&#34;!d&#34;, bytes.fromhex(val))[0]))
            
    def litsmalli2(self, *args):
        raise Pcode2codeException(&#39;not implemented malli2&#39;)
            
    def litstr(self, mylen, *args):
        val = args[0]
        for arg in args[1:]:
            val += &#39; &#39; + arg
        if len(val)&gt;=2:
            #assert(val[0]==&#39;&#34;&#39; and val[-1]==&#39;&#34;&#39;)
            val = val[1:-1]
            val = val.replace(&#39;&#34;&#39;, &#39;&#34;&#34;&#39;)
            val = &#39;&#34;&#39; + val + &#39;&#34;&#39;

        self.opstack.push(val)
            
    def litvarspecial(self, var):
        self.opstack.push(var[1:-1])
            
    def lock(self):
        &#34;&#34;&#34;
        command to lock a record
        example: Lock #1, RecordNumber
        gives:
             # LitDI2 0x0001
             # Sharp
             # Ld RecordNumber
             # LitDefault
             # Lock
        &#34;&#34;&#34;
        if self.opstack.size() == 3:
            last_record = self.opstack.pop()
            first_record = self.opstack.pop()
            chan = self.opstack.pop()
            self.opstack.push(&#39;Lock &#39; + chan + &#39;, &#39; + first_record + &#39; To &#39; + last_record)
        elif self.opstack.size() == 2:
            record = self.opstack.pop()
            chan = self.opstack.pop()
            self.opstack.push(&#39;Lock &#39; + chan + &#39;, &#39; + record)
        elif self.opstack.size() == 1:
            chan = self.opstack.pop()
            self.opstack.push(&#39;Lock &#39; + chan)
            
    def loop(self):
        self.opstack.push(&#39;Loop&#39;)
        self.indentlevel = self.indentlevel - 1
            
    def loopuntil(self):
        &#34;&#34;&#34;
        command defining a loop until statement for &#34;do&#34;
        example: Loop Until TheName = &#34;&#34;
        gives:
             # Ld TheName
             # LitStr 0x0000 &#34;&#34;
             # Eq
             # LoopUntil
        &#34;&#34;&#34;
        self.opstack.push(&#39;Loop Until &#39; + self.opstack.pop())
        self.indentlevel = self.indentlevel - 1
            
    def loopwhile(self):
        &#34;&#34;&#34;
        command handling &#34; while&#34; definitions
        example: Loop While Reponse = 5
        gives:
             # Ld Response
             # LitDI2  0x0005
             # Eq
             # LoopWhile
        &#34;&#34;&#34;
        self.opstack.push(&#39;Loop While &#39; + self.opstack.pop())
        self.indentlevel = self.indentlevel - 1

            
    def lset(self):
        &#34;&#34;&#34;
        command for RSet keyword
        example: LSet MyString = &#34;Right-&gt;&#34;
        gives:
             # LitStr 0x0007 &#34;Right-&gt;&#34;
             # Ld MyString
             # RSet
        &#34;&#34;&#34;
        var = self.opstack.pop()
        val = self.opstack.pop()
        self.opstack.push(&#39;LSet &#39; + var + &#39; = &#39; + val)
            
    def me(self, *args):
        raise Pcode2codeException(&#39;not implemented me&#39;)
            
    def meimplicit(self, *args):
        &#34;&#34;&#34;
        command used when the object is the current form
        example: Print 
        gives:
             # MeImplicit
             # PrintObj
             # PrintNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;MeImplicit&#39;) #just pushing a specific marker to change treatment later
            
    def memredim(self, *args):
        &#34;&#34;&#34;
        command used when a property of an object is redim
        example: ReDim myobj.foo(30)
        gives:
             # OptionBase
             # LitDI2 0x001E
             # Ld myobj
             # MemRedim foo 0x0001 (As Variant)
        &#34;&#34;&#34;
        val = self.opstack.pop()
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + val + &#39;.&#39; + args[0] + &#39;(&#39;
        else:
            val2 = &#39;ReDim &#39;
            if preserve:
                val2 += &#39;Preserve &#39;
            val2 += val + &#39;.&#39; + args[0] + &#39;(&#39;
            val = val2

        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;
        self.opstack.push(val)
            
    def memredimwith(self, *args):
        &#34;&#34;&#34;
        command used when a property of an object is redim within a with
        example: with myobj ... ReDim .foo(30) .. end with
        gives:
             # OptionBase
             # LitDI2 0x001E
             # MemRedimWith foo 0x0001 (As Variant)
        &#34;&#34;&#34;
        val = &#39;&#39;
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + &#39;.&#39; + args[0] + &#39;(&#39;
        else:
            val += &#39;ReDim &#39;
            if preserve:
                val += &#39;Preserve &#39;
            val += &#39;.&#39; + args[0] + &#39;(&#39;

        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;
        self.opstack.push(val)

            
    def memredimas(self, *args):
        &#34;&#34;&#34;
        command used when a redim is defined on a property of an object with a As in the end
        example: ReDim myobj.mytab(50) As Double
        gives:
             # OptionBase
             # LitDI2 0x003C
             # Ld myobj
             # MemRedimAs Tab 0x0001 (As Double)
        &#34;&#34;&#34;
        val = self.opstack.pop()
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + val + &#39;.&#39; + args[0] + &#39;(&#39;
        else:
            val2 = &#39;ReDim &#39;
            if preserve:
                val2 += &#39;Preserve &#39;
            val2 += val + &#39;.&#39; + args[0] + &#39;(&#39;
            val = val2
            
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;

        args.pop(0) #remove var
        args.pop(0) # remove nb_params
        if len(args)&gt; 0: # do we have smthng like &#34;(As &lt;type&gt;)&#34;
            if args[-1] != &#39;Variant)&#39;:
                val += &#39; &#39; + args[0][1:] + &#39; &#39; + args[1][:-1]
        self.opstack.push(val)
            
    def memredimaswith(self, *args):
        &#34;&#34;&#34;
        command used when a redim is defined on a property of an object with a As in the end, within a with block
        example: With myobj ... ReDim .mytab(70) As Integer ... End With 
        gives:
             # OptionBase
             # LitDI2 0x0046
             # MemRedimAsWith Tab 0x0001 (As Integer)
        &#34;&#34;&#34;
        val = &#39;&#39;
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + &#39;.&#39; + args[0] + &#39;(&#39;
        else:
            val += &#39;ReDim &#39;
            if preserve:
                val += &#39;Preserve &#39;
            val += &#39;.&#39; + args[0] + &#39;(&#39;
            
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;

        args.pop(0) #remove var
        args.pop(0) # remove nb_params
        if len(args)&gt; 0: # do we have smthng like &#34;(As &lt;type&gt;)&#34;
            if args[-1] != &#39;Variant)&#39;:
                val += &#39; &#39; + args[0][1:] + &#39; &#39; + args[1][:-1]
        self.opstack.push(val)
            
    def mid(self):
        &#34;&#34;&#34;
        command used when Mid funtion is used to set a sub string part, e.g. as an instruction
        example: Mid(MyString, 5, 3) = &#34;fox&#34;
        gives:
             # LitStr 0x0003 &#34;fox&#34;
             # Ld MyString
             # LitDI2 0x0005
             # LitDI2 0x0003
             # Mid
        &#34;&#34;&#34;
        if self.opstack.size() &gt; 3:
            length = self.opstack.pop()
            start = self.opstack.pop()
            obj = self.opstack.pop()
            str1 = self.opstack.pop()
            self.opstack.push(&#39;Mid(&#39; + obj + &#39;, &#39; + start + &#39;, &#39; + length + &#39;) = &#39; + str1)
        else:
            start = self.opstack.pop()
            obj = self.opstack.pop()
            str1 = self.opstack.pop()
            self.opstack.push(&#39;Mid(&#39; + obj + &#39;, &#39; + start + &#39;) = &#39; + str1)            
            
    def midb(self):
        &#34;&#34;&#34;
        command used when Mid funtion is used to set a sub string part, e.g as an instruction
        example: MidB(MyString, 5, 3) = &#34;fox&#34;
        gives:
             # LitStr 0x0003 &#34;fox&#34;
             # Ld MyString
             # LitDI2 0x0005
             # LitDI2 0x0003
             # MidB
        &#34;&#34;&#34;
        if self.opstack.size() &gt; 3:
            length = self.opstack.pop()
            start = self.opstack.pop()
            obj = self.opstack.pop()
            str1 = self.opstack.pop()
            self.opstack.push(&#39;MidB(&#39; + obj + &#39;, &#39; + start + &#39;, &#39; + length + &#39;) = &#39; + str1)
        else:
            start = self.opstack.pop()
            obj = self.opstack.pop()
            str1 = self.opstack.pop()
            self.opstack.push(&#39;MidB(&#39; + obj + &#39;, &#39; + start + &#39;) = &#39; + str1)            

            
    def name(self):
        &#34;&#34;&#34;
        command for the name keyword, permitting to rename variables
        example: Name OldName As NewName
        gives:
             # Ld OldName
             # Ld NewName
             # Name
        &#34;&#34;&#34;
        newname = self.opstack.pop()
        oldname = self.opstack.pop()
        self.opstack.push(&#39;Name &#39; + oldname + &#39; As &#39; + newname) 
            
    def new(self, var):
        self.opstack.push(&#39;New &#39; + var)
            
    def next_(self):
        self.opstack.push(&#39;Next&#39;)
        self.indentlevel = self.indentlevel - 1
        self.indentincrease_future = False
            
    def nextvar(self):
        self.opstack.push(&#39;Next &#39; + self.opstack.pop())
        self.indentlevel = self.indentlevel - 1
            
    def onerror(self, *args):
        &#34;&#34;&#34;
        command defining &#34;on error&#34; statements
        example1: On Error GoTo ErrorHandler
        gives:
             # OnError ErrorHandler
        example2: On Error GoTo 0
        gives: 
             # OnError (GoTo 0)
        example3: On Error Resume Next
        gives: 
             # OnError (Resume Next)
        &#34;&#34;&#34;
        if args[0] == &#39;(Resume&#39;:
            self.opstack.push(&#39;On Error Resume Next&#39;)
        elif args[0] == &#39;(GoTo&#39;:
            self.opstack.push(&#39;On Error GoTo 0&#39;)
        else:
            #TODO: to check
            self.opstack.push(&#39;On Error GoTo &#39; + args[0])
            
    def ongosub(self, nb, *args):
        &#34;&#34;&#34;
        command used for gosub on a variable
        example: On Number GoSub Sub1, Sub2
        gives:
             # Ld Number
             # OnGoSub 0x0004 Sub1, Sub2
        &#34;&#34;&#34;
        val = &#39;On &#39; + self.opstack.pop() + &#39; GoSub &#39;
        val2 = args[0]
        for arg in args[1:]:
            val2 += &#39; &#39; + arg
        self.opstack.push(val + val2)
            
    def ongoto(self, nb, *args):
        &#34;&#34;&#34;
        command used for goto on a variable
        example: On Number GoTo Line1, Line2
        gives:
             # Ld Number
             # OnGoto 0x0004 Line1, Line2
        &#34;&#34;&#34;
        val = &#39;On &#39; + self.opstack.pop() + &#39; GoTo &#39;
        val2 = args[0]
        for arg in args[1:]:
            val2 += &#39; &#39; + arg
        self.opstack.push(val + val2)
            
    def open_(self, *args):
        &#34;&#34;&#34;
        command used for Open function
        example: Open &#34;TESTFILE&#34; For Output As #1
        gives:
             # LitStr 0x0008 &#34;TESTFILE&#34;
             # LitDI2 0x0001
             # Sharp
             # LitDefault
             # Open (For Output)
        example2: Open &#34;TESTFILE&#34; For Binary Access Write Lock Write As #1
        gives:
             # LitStr 0x0008 &#34;TESTFILE&#34;
             # LitDI2 0x0001
             # Sharp
             # LitDefault
             # Open (For Binary Access Write Lock Write)
        &#34;&#34;&#34;
        chan = self.opstack.pop()
        val = args[0][1:] # avoid parenthesis
        for arg in args[1:]:
            val += &#39; &#39; + arg
        val = val[:-1] #avoid parenthesis
        self.opstack.push(&#39;Open &#39; + self.opstack.pop() + &#39; &#39; + val + &#39; As &#39; + chan)
            
    def option(self, *args):
        &#34;&#34;&#34;
        command for option keyword
        example: Option Explicit
        gives : 
           # Option (Explicit)
        example2: Option Compare Binary
        gives :
           # Option (Compare Binary)
        &#34;&#34;&#34;
        val = args[0][1:]
        if len(args)&gt;1:
            for arg in args[1:]: #strip parenthesis
                val += &#39; &#39; + arg
        self.opstack.push(&#39;Option &#39; + val[:-1])
            
    def optionbase(self):
        &#34;&#34;&#34;
        used in the following case: when a table dimension is not declared from base to end, but only size;
        to treat it, we will push a magic value on stack like for dim and dimimplicit, and vardef will treat it directly
        example1: Dim MyArray(20)
        gives: 
             # Dim
             # OptionBase
             # LitDI2 0x0014
             # VarDefn MyArray
        &#34;&#34;&#34;
        self.opstack.push(&#39;OptionBase&#39;)
            
    def parambyval(self):
        &#34;&#34;&#34;
        command used when Byval keyword is used
        example: a ByVal b
        gives:
             # Ld B
             # ParamByVal
             # ArgsCall a 0x0001
        &#34;&#34;&#34;
        self.opstack.push(&#39;ByVal &#39; + self.opstack.pop())
            
    def paramomitted(self):
        &#34;&#34;&#34;
        command used when a parameter is left blank in a function call
        example: MsgBox Msg, , &#34;Deferred Error Test&#34;
        gives:
             # Ld Msg
             # ParamOmitted
             # LitStr 0x0013 &#34;Deferred Error Test&#34;
             # ArgsCall MsgBox 0x0003
        &#34;&#34;&#34;
        self.opstack.push(&#39;&#39;)
            
    def paramnamed(self, var):
        &#34;&#34;&#34;
        command used when a call is made with named parameters
        example: MyClasses.Add Item:=Inst, Key:=CStr(Num)
        gives:
             # Ld Inst
             # ParamNamed Item
             # Ld Num
             # Coerce (Str)
             # ParamNamed Key
             # Ld MyClasses
             # ArgsMemCall Add 0x0002
        &#34;&#34;&#34;
        self.opstack.push(var + &#39;:=&#39; + self.opstack.pop())
            
    def printchan(self):
        &#34;&#34;&#34;
        command defining &#34;print&#34; to a channel
        example: Print #1, MyBool; &#34; is a Boolean value&#34;
        gives:
             # LitDI2 0x0001
             # Sharp
             # PrintChan
             # Ld MyBool
             # PrintItemSemi
             # LitStr 0x0013 &#34; is a Boolean value&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Print &#39; +self.opstack.pop() + &#39;,&#39;)
    
    def printcomma(self, *args):
        &#34;&#34;&#34;
        command used when a colon is used in Print
        example: Debug.Print Spc(30), &#34;Thirty spaces later...
        gives:
             # Debug
             # PrintObj
             # LitDI2 0x001E
             # PrintSpc
             # PrintComma
             # LitStr 0x0016 &#34;Thirty spaces later...&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;,&#39;)
            
    def printeos(self):
        &#34;&#34;&#34;
        used at the end of some print when there is nothing, instead of printitemnl
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            if ((elmt == &#39;;&#39;) or (elmt == &#39;,&#39;)) and (elmts.index(elmt) != 1):
                val+= elmt
            else:
                val += &#39; &#39; + elmt
        self.opstack.push(val)

            
    def printitemcomma(self):
        &#34;&#34;&#34;
        command defining &#34;,&#34;, used for example when writing 
        example: Write #1, &#34;Hello World&#34;, 234
        gives:
             # LitDI2 0x0001
             # Sharp
             # WriteChan
             # LitStr 0x000B &#34;Hello World&#34;
             # PrintItemComma
             # LitDI2 0x00EA
             # PrintItemNL
             # QuoteRem 0x0020 0x001C &#34; Write comma-delimited data.&#34;
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            val += &#39; &#39; + elmt
        self.opstack.push(val + &#39;,&#39;)
            
    def printitemnl(self):
        &#34;&#34;&#34;
        TODO: not sure what&#39;s it is used for
        example1: Write #1, MyBool; &#34; is a Boolean value&#34;
        gives:
             # LitDI2 0x0001
             # Sharp
             # WriteChan
             # Ld MyBool
             # PrintItemSemi
             # LitStr 0x0013 &#34; is a Boolean value&#34;
             # PrintItemNL
        example2:  Debug.Print i
        gives:
             # Debug
             # PrintObj
             # Ld i
             # PrintItemNL
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            if ((elmt == &#39;;&#39;) or (elmt == &#39;,&#39;)) and (elmts.index(elmt) != 1):
                val+= elmt
            else:
                val += &#39; &#39; + elmt
        self.opstack.push(val)
            
    def printitemsemi(self):
        &#34;&#34;&#34;
        command defining &#34;;&#34;, used for example when writing 
        example: Write #1, MyBool; &#34; is a Boolean value&#34;
        gives:
             # LitDI2 0x0001
             # Sharp
             # WriteChan
             # Ld MyBool
             # PrintItemSemi
             # LitStr 0x0013 &#34; is a Boolean value&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            val += &#39; &#39; + elmt
        self.opstack.push(val + &#39;;&#39;)
            
    def printnl(self):
        &#34;&#34;&#34;
        really not sure about this one
        example: Write #1,     
        gives:
             # LitDI2 0x0001
             # Sharp
             # WriteChan
             # PrintNL
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            val += &#39; &#39; + elmt
        self.opstack.push(val)
    
    def printobj(self):
        &#34;&#34;&#34;
        appears to call the print method of an object
        example:  Debug.Print i
        gives:
             # Debug
             # PrintObj
             # Ld i
             # PrintItemNL
        &#34;&#34;&#34;
        if self.opstack.top() == &#39;MeImplicit&#39;:
            self.opstack.pop()
            self.opstack.push(&#39;Print&#39;)
        else:
            self.opstack.push(self.opstack.pop() + &#39;.Print&#39;)
            
    def printsemi(self, *args):
        &#34;&#34;&#34;
        command used when a semicolon is used in Print
        example: Debug.Print Spc(30); &#34;Thirty spaces later...
        gives:
             # Debug
             # PrintObj
             # LitDI2 0x001E
             # PrintSpc
             # PrintSemi
             # LitStr 0x0016 &#34;Thirty spaces later...&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;;&#39;)
            
    def printspc(self):
        &#34;&#34;&#34;
        command used when SPC(n) is used in Print
        example: Debug.Print Spc(30); &#34;Thirty spaces later...
        gives:
             # Debug
             # PrintObj
             # LitDI2 0x001E
             # PrintSpc
             # PrintSemi
             # LitStr 0x0016 &#34;Thirty spaces later...&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Spc(&#39; + self.opstack.pop() + &#39;)&#39;)
            
    def printtab(self, *args):
        &#34;&#34;&#34;
        command used when Tab(n) is used in Print
        example: Debug.Print Tab(30); &#34;Thirty spaces later...
        gives:
             # Debug
             # PrintObj
             # LitDI2 0x001E
             # PrintTab
             # PrintSemi
             # LitStr 0x0016 &#34;Thirty spaces later...&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Tab(&#39; + self.opstack.pop() + &#39;)&#39;)
            
    def printtabcomma(self):
        &#34;&#34;&#34;
        command used when Tab with no arg is used in Print
        example: Debug.Print Tab, &#34;Thirty spaces later...
        gives:
             # Debug
             # PrintObj
             # PrintTabComma
             # PrintComma
             # LitStr 0x0016 &#34;Thirty spaces later...&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Tab&#39;)
            
    def pset(self, numparams):
        &#34;&#34;&#34;
        command used when the pset method of an object is called
        example: Me.PSet (intI, sngMidPt)
        gives:
             # Ld intI
             # Ld sngMidPt
             # LitDI2 0x0000
             # Ld id_FFFF
             # PSet 0x0002
        &#34;&#34;&#34;
        val = self.opstack.pop() + &#39;.PSet(&#39;
        first_arg = self.opstack.pop()
        if first_arg != &#39;0&#39;:
            val += first_arg + &#39;, &#39;
            
        nb_args = int(numparams, 16)
        params = []
        if nb_args &gt; 0:
            for i in range(nb_args):
                params.append(self.opstack.pop())
            params = params[::-1]

            val += params[0]
            for param in params[1:]:
                val = val + &#39;, &#39; + param
        val +=&#39;)&#39;
        self.opstack.push(val)
            
    def putrec(self):
        &#34;&#34;&#34;
        command to Put to a channel with a record: Put channel, record, var
        example: Put #1, RecordNumber, MyRecord
        gives:
             # LitDI2 0x0001
             # Sharp
             # Ld RecordNumber
             # Ld MyRecord
             # PutRec
        &#34;&#34;&#34;
        record = self.opstack.pop()
        record_num = self.opstack.pop()
        chan = self.opstack.pop()
        self.opstack.push(F&#39;Put {chan}, {record_num}, {record}&#39;)
            
    def quoterem(self, val1, lenvar, *args):
        &#34;&#34;&#34;
        command handling comments definition with &#39;
        multiple cases:
        example : MsgBox &#34;toto&#34; &#39;a message to send
        gives:
             # LitStr 0x0004 &#34;toto&#34;
             # ArgsCall MsgBox 0x0001
             # QuoteRem 0x000F 0x11

        example : TODO macaroni
        gives: TODO macaroni
        &#34;&#34;&#34;
        val = &#34;&#39;&#34; + args[0][1:]
        for arg in args[1:] :
            val += &#39; &#39; + arg
        val = val[:-1]
        if self.opstack.size() != 0:
            val = self.opstack.pop() + &#39; &#39; + val
        self.opstack.push(val)


    def redim(self, *args):
        &#34;&#34;&#34;
        command used when redim function is used
        example : ReDim temp(4)
        gives:
             # OptionBase
             # LitDI2 0x0004
             # Redim temp 0x0001 (As Variant)
        &#34;&#34;&#34;
        val = &#39;&#39;
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + args[0] + &#39;(&#39;
        else:
            val += &#39;ReDim &#39;
            if preserve:
                val += &#39;Preserve &#39;
            val += args[0] + &#39;(&#39;
            
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;
        self.opstack.push(val)

        
    def redimas(self, *args):
        &#34;&#34;&#34;
        command used when a redim is defined with a As in the end
        example: ReDim mytab(50) As Double
        gives:
             # OptionBase
             # LitDI2 0x0032
             # RedimAs mytab 0x0001 (As Double)
        &#34;&#34;&#34;
        val = &#39;&#39;
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + args[0] + &#39;(&#39;
        else:
            val += &#39;ReDim &#39;
            if preserve:
                val += &#39;Preserve &#39;
            val += args[0] + &#39;(&#39;
            
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;

        args.pop(0) #remove var
        args.pop(0) # remove nb_params
        if len(args)&gt; 0: # do we have smthng like &#34;(As &lt;type&gt;)&#34;
            if args[-1] != &#39;Variant)&#39;:
                val += &#39; &#39; + args[0][1:] + &#39; &#39; + args[1][:-1]
        self.opstack.push(val)
            
    def reparse(self, *args):
        &#34;&#34;&#34;
        opcode used when a non valid statement is employed
        &#34;&#34;&#34;
        val = args[1][1:]
        for arg in args[2:]:
            val += &#39; &#39; + arg
        val = val[:-1] # avoid double quotes
        self.opstack.push(val)


    def rem(self, *args):
        &#34;&#34;&#34;
        command for Rem keyword
        example: Rem This entire line is a comment
        gives:  # Rem 0x001F &#34; This entire line is a comment.&#34;
        &#34;&#34;&#34;
        val = args[2] # avoid space+double quote
        for arg in args[3:]:
            val += &#39; &#39; + arg
        val = val[:-1] #avoid double quote
        self.opstack.push(&#39;Rem &#39; + val)
        
            
    def resume(self, *args):
        &#34;&#34;&#34;
        command used when resume keyword is used 
        example1: Resume
        gives: # Resume
        example2: Resume Next
        gives: # Resume (Next)
        example3: Resume titi
        gives: # Resume titi
        &#34;&#34;&#34;
        if args == ():
            self.opstack.push(&#39;Resume&#39;)
        else:
            if args[0] == &#39;(Next)&#39;:
                self.opstack.push(&#39;Resume Next&#39;)
            else:
                self.opstack.push(&#39;Resume &#39; + args[0])
            
    def return_(self):
        #TODO: comment
        self.opstack.push(&#39;Return&#39;)
            
    def rset(self):
        &#34;&#34;&#34;
        command for RSet keyword
        example: RSet MyString = &#34;Right-&gt;&#34;
        gives:
             # LitStr 0x0007 &#34;Right-&gt;&#34;
             # Ld MyString
             # RSet
        &#34;&#34;&#34;
        var = self.opstack.pop()
        val = self.opstack.pop()
        self.opstack.push(&#39;RSet &#39; + var + &#39; = &#39; + val)
            
    def scale(self, *args):
        &#34;&#34;&#34;
        command used when an object scale method is used
        example: Me.Scale 
        gives:
             # LitDI2 0x0000
             # LitDI2 0x0000
             # Ld sngNewH
             # Ld sngNewV
             # Ld id_FFFF
             # Scale 0x0000
        TODO: what to do with this command?
        &#34;&#34;&#34;
        raise Pcode2codeException(&#39;not implemented scale&#39;)
            
    def seek(self):
        &#34;&#34;&#34;
        opcode used when seek is used to search in a file
        example: Seek #1, 2
        gives:
             # LitDI2 0x0001
             # Sharp
             # LitDI2 0x0002
             # Seek
        &#34;&#34;&#34;
        data = self.opstack.pop()
        self.opstack.push(&#39;Seek &#39; + self.opstack.pop() + &#39;, &#39; + data)
            
    def selectcase(self):
        &#34;&#34;&#34;
        command handling a &#34;select case&#34; definition against a variable
        example : Select Case x
        gives:
             # Ld x
             # SelectCase
        &#34;&#34;&#34;
        self.opstack.push(&#39;Select Case &#39; + self.opstack.pop())
        self.indentincrease_future = True
    
    def selectis(self, *args):
        raise Pcode2codeException(&#39;not implemented selectis&#39;)
            
    def selecttype(self, *args):
        raise Pcode2codeException(&#39;not implemented selecttype&#39;)
            
    def setstmt(self):
        # TODO: comment
        #pass on purpose
        pass
            
    def stack(self, *args):
        raise Pcode2codeException(&#39;not implemented stack&#39;)
            
    def stop(self):
        #TODO: comment
        self.opstack.push(&#39;Stop&#39;)
            
    def type_(self, *args):
        &#34;&#34;&#34;
        command for Type keyword, #TODO: beware because it&#39;s also used for enum keyword
        example: Type EmployeeRecord
        gives : 
           # Type EmployeeRecord
        &#34;&#34;&#34;
        if args[0] == &#39;(Private)&#39;:
            self.opstack.push(&#39;Private Type &#39; + args[1])
        elif args[0] == &#39;(Public)&#39;:
            self.opstack.push(&#39;Public Type &#39; + args[1])
        else:
            self.opstack.push(&#39;Type &#39; + args[0])
        self.indentincrease_future = True
            
    def unlock(self):
        &#34;&#34;&#34;
        command to unlock a record
        example: Unlock #1, RecordNumber
        gives:
             # LitDI2 0x0001
             # Sharp
             # Ld RecordNumber
             # LitDefault
             # Unlock
        &#34;&#34;&#34;
        if self.opstack.size() == 3:
            last_record = self.opstack.pop()
            first_record = self.opstack.pop()
            chan = self.opstack.pop()
            self.opstack.push(&#39;Unlock &#39; + chan + &#39;, &#39; + first_record + &#39; To &#39; + last_record)
        elif self.opstack.size() == 2:
            record = self.opstack.pop()
            chan = self.opstack.pop()
            self.opstack.push(&#39;Unlock &#39; + chan + &#39;, &#39; + record)
        elif self.opstack.size() == 1:
            chan = self.opstack.pop()
            self.opstack.push(&#39;Unlock &#39; + chan)



    # Dim hiz7dgus As String
    # Private Const DefaultBufferSize&amp; = 32768
    # Private CRC_32_Tab(0 To 255) As Long
    # ======================
    # Line #7:
    #   Dim 
    #   VarDefn hiz7dgus (As String)
    # Line #8:
    # Line #9:
    #   Dim (Private Const) 
    #   LitDI4 0x8000 0x0000 
    #   VarDefn DefaultBufferSize
    # Line #10:
    # Line #11:
    #   Dim (Private) 
    #   LitDI2 0x0000 
    #   LitDI2 0x00FF 
    #   VarDefn CRC_32_Tab (As Long)
    def vardefn(self, *args):      
        ending =&#39;&#39;
        args = list(args) #quite ugly, but fu...
        if args[0] == &#39;(WithEvents)&#39;:
            var = args.pop(0)[1:-1] + &#39; &#39; + args.pop(0)
        else:
            var = args.pop(0)

        spaces = 1
        if len(args) &gt; 0:
            if args[-1].startswith(&#39;0x&#39;):
                spaces = int(args.pop(-1),16) #TODO: treat spaces there
            ending = args[0]
            for arg in args[1:]:
                ending += &#39; &#39; + arg
            ending = &#39; &#39; + ending[1:-1]
            

        # first we check if this is only one literal definition
        # in this case, we get Dim definitions and we are all set up
        stacktop = self.opstack.pop()

        if stacktop == &#39;DimImplicit&#39;: #case where dim is implicit, 
            val = var + ending  # we have pushed in this case &#39;DimImplicit&#39; on stack
            self.opstack.push(val)
            return

        # in this case we have a single variable declaration
        decls = [&#39;Dim&#39;, &#39;Private&#39;, &#39;Public&#39;, &#39;Protected&#39;, &#39;Friend&#39;, &#39;Protected Friend&#39;, &#39;Shared&#39;, &#39;Shadows&#39;, &#39;Static&#39;, &#39;ReadOnly&#39;]
        if stacktop in decls:
            val = stacktop + &#39; &#39; + var + ending
            self.opstack.push(val)
            return

        else:
            # in this case, our variable is either a table, or there is also some const declarations
            # if so, walk the stack and check for declaration
            self.opstack.push(stacktop)
            values = []

            # gather all stack
            while self.opstack.size() &gt; 0:
                values.append(self.opstack.pop())
            values = values[::-1]

            # if we have multiple vardefn with dim, then we are here
            # because all previous vardef should have been pushed correctly on stack
            if len(values) == 1 :
                for decl in decls:
                    if values[0].startswith(decl):
                        val = values[0] +&#39;, &#39; + var + ending
                        self.opstack.push(val)
                        return
                    
            # if const is used for declaration, then a value is attributed to variable
            # appears somehow not possible to declare a table as const, so far so good, no need to check this case
            if &#39;Const&#39; in values[0]:
                val = values.pop(0)
                end_val = &#39; = &#39; + values.pop(0)
                if len(values) &gt; 0:
                    # how to say what is dimensions to what is attribution
                    #val = &#39;Undefined variable declaration&#39;
                    raise Pcode2codeException(&#39;undefined variable declaration&#39;)
                else:
                    val = val + &#39; &#39; + var + ending + end_val
                self.opstack.push(val)
                return
            
            #so here we have a table
            val = &#39;&#39;
            if values[0] in decls: #first we check if this is the first definition
                val += values.pop(0) + &#39; &#39; + var + &#39;(&#39;
            elif values[0] == &#39;DimImplicit&#39;: #not sure about this one
                values.pop(0)
                val += var + &#39;(&#39;
            else:
                #next we check for a previous declaration
                prev_decl = False
                for decl in decls:
                    if values[0].startswith(decl):
                        val += values.pop(0) +&#39;, &#39; + var + &#39;(&#39;
                        prev_decl = True
                if prev_decl is False: #in this case, nothing before
                    val+= var + &#39;(&#39;

            #first occurence
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

            #other occurences
            while len(values) &gt; 0:
                val += &#39;, &#39;
                curr_val1 = values.pop(0)
                curr_val2 = values.pop(0)
                if curr_val1 == &#39;OptionBase&#39;:
                    val += curr_val2 
                else:
                    val += curr_val1 + &#39; To &#39; + curr_val2 

            #closing
            val += &#39;)&#39; + ending
            self.opstack.push(val)

    def wend(self):
        &#34;&#34;&#34;
        command handling end of while loop &#34;Wend&#34;
        example: Wend
        gives : 
              # Wend
        &#34;&#34;&#34;
        self.opstack.push(&#39;Wend&#39;)
        self.indentlevel = self.indentlevel - 1
            
    def while_(self):
        &#34;&#34;&#34;
        command handling &#34;while&#34; loops definitions
        example: While numero &lt;= 12
        gives:
             # Ld numero
             # LitDI2 0x000C
             # Le
             # While
        &#34;&#34;&#34;
        self.opstack.push(&#39;While &#39; + self.opstack.pop())
        self.indentincrease_future = True
            
    def with_(self):
        &#34;&#34;&#34;
        command handling &#34;with&#34; definitions
        example: with theWindow 
        gives:
             # StartWithExpr
             # Ld theWindow
             # With
        &#34;&#34;&#34;
        self.opstack.push(&#39;With &#39; + self.opstack.pop())
        self.indentincrease_future = True
            
    def writechan(self):
        &#34;&#34;&#34;
        command defining &#34;write&#34; to a channel
        example: Write #1, MyBool; &#34; is a Boolean value&#34;
        gives:
             # LitDI2 0x0001
             # Sharp
             # WriteChan
             # Ld MyBool
             # PrintItemSemi
             # LitStr 0x0013 &#34; is a Boolean value&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Write &#39; +self.opstack.pop() + &#39;,&#39;)
            
    def constfuncexpr(self, *args):
        raise Pcode2codeException(&#39;not implemented constfuncexpr&#39;)
            
    def lbconst(self, var):
        &#34;&#34;&#34;
        opcode used when #Const is used
        example: #Const x = y
        gives:
             # LbMark
             # Ld B
             # LbConst a
        &#34;&#34;&#34;
        self.opstack.push(&#39;#Const &#39; + var + &#39; = &#39; + self.opstack.pop())
    
    def lbif(self):
        &#34;&#34;&#34;
        opcode used when #If is used
        example: #If a = b Then
        gives:
             # LbMark
             # Ld a
             # Ld B
             # Eq
             # LbIf
        &#34;&#34;&#34;
        self.opstack.push(&#39;#If &#39; + self.opstack.pop() + &#39; Then&#39;)
        self.indentincrease_future = True
    
    def lbelse(self):
        &#34;&#34;&#34;
        opcode used when #Else is used
        example: #Else 
        gives: lbElse
        &#34;&#34;&#34;
        self.opstack.push(&#39;#Else&#39;)
        self.indentlevel = self.indentlevel - 1
        self.indentincrease_future = True
            
    def lbelseif(self):
        &#34;&#34;&#34;
        opcode used when #Elseif is used
        example: #ElseIf a = c Then
        gives:
             # LbMark
             # Ld a
             # Ld c
             # Eq
             # LbElseIf
        &#34;&#34;&#34;
        self.opstack.push(&#39;#ElseIf &#39; + self.opstack.pop() + &#39; Then&#39;)
        self.indentlevel = self.indentlevel - 1
        self.indentincrease_future = True
            
    def lbendif(self):
        &#34;&#34;&#34;
        opcode used when &#34;#End If&#34; is used
        example: #End If
        gives: #LbEndIf
        &#34;&#34;&#34;
        self.opstack.push(&#39;#End If&#39;)
        self.indentlevel = self.indentlevel - 1
            
    def lbmark(self):
        &#34;&#34;&#34;
        appears to be used to indicate the start of a lb statement, appears quite useless
        &#34;&#34;&#34;
        pass #pass on purposes

    def endforvariable(self):
        &#34;&#34;&#34;
        This command ends out a for loop variable definition. Gives nothing interesting in fact
        example: TODO macaroni
        gives: TODO macaroni
        &#34;&#34;&#34;
        #pass on purposes
            
    def startforvariable(self):
        &#34;&#34;&#34;
        This command starts out a for loop variable definition. Gives nothing interesting in fact
        example: TODO macaroni
        gives: TODO macaroni
        &#34;&#34;&#34;
        #pass on purposes
            
    def newredim(self, *args):
        raise Pcode2codeException(&#39;not implemented newredim&#39;)
            
    def startwithexpr(self):
        &#34;&#34;&#34;
        used like startforvariable, eg, simply an indicator of when a with variable is declared.
        pretty useless for us.
        example: With theWindow
        gives:
             # StartWithExpr
             # Ld theWindow
             # With
        &#34;&#34;&#34;
        #pass on purposes
            
    def setorst(self, *args):
        raise Pcode2codeException(&#39;not implemented setorst&#39;)
            
    def endenum(self):
        &#34;&#34;&#34;
        command to end an enum
        example: End Enum
        gives:
             #EndEnum
        &#34;&#34;&#34;
        self.opstack.push(&#39;End Enum&#39;)
        self.indentlevel = self.indentlevel - 1
            
    def illegal(self, *args):
        raise Pcode2codeException(&#39;not implemented illegal&#39;)

    def newline(self):
        &#34;&#34;&#34;
        defines a blank line. Used for internal processing, for blank streams and lines
        &#34;&#34;&#34;
        self.opstack.push(&#39;&#39;)
    
    def clearstack(self):
        self.opstack.clearstack()

    def getstacktop(self):
        return self.opstack.top()

    def getstackpop(self):
        return self.opstack.pop()

    def getstacksize(self):
        return self.opstack.size()

    def increaseindentlevel_future(self):
        &#34;&#34;&#34;
        when we increase the indent level, we need to first print out the line, and then to increase the indent level. 
        to do so, when a line has been printed, this function checks if the indent level need to be increased and do so.
        &#34;&#34;&#34;
        if self.unindented &gt; 0:
            self.unindented -= 1
        elif self.indentincrease_future:
            self.indentlevel = self.indentlevel + 1
        self.indentincrease_future = False
    
    def getindentlevel(self):
        &#34;&#34;&#34;
         function retrieving the class indentlevel parameter, used to print out code with correct indent
        &#34;&#34;&#34;
        return self.indentlevel

    def hasbos(self):
        return self.has_bos

    def resethasbos(self):
        self.has_bos = False
    
class Parser:

    def __init__(self, myinput):
        self.myinput = myinput  # input to be processed, is always a dump of pcodedmp module there
        self.opstack = Stack()  # vba bytecode is somewhat stack based, so we declare a new one 
        self.operations = Operations(self.opstack) # all operations that can be found in vba bytecode
        self.output = &#39;&#39;        # the output of global processing
        self.output_queue = []
        self.unindented = 0

    def queueLineOutput(self, line, linenum, print_linenum=False, has_end=True):
        self.output_queue.append((line, linenum, print_linenum, has_end))

    def addlineOutput(self, line, linenum, print_linenum=False, has_end=True, _checking_queue=False):
        &#34;&#34;&#34;
            Because we can choose what is the output for our module, this function somehow bufferize the
            output before it&#39;s printed in the latter.
        &#34;&#34;&#34;
        if not line.strip():
            return
        while not _checking_queue and self.output_queue:
            self.addlineOutput(*self.output_queue.pop(), True)
        if print_linenum:
            self.output += str(linenum) + &#39;: &#39;           
        if not has_end:
            self.output += line
            return
        self.output += line + &#39;\n&#39; 

    def getOutput(self):
        &#34;&#34;&#34;
        simply a getter to output, used in the end of global processing
        &#34;&#34;&#34;
        return self.output

    def parseInput(self):
        &#34;&#34;&#34;
            Function parsing pcodedmp dump to create a dictionary of all lines of the input with the operation lines associated.
            Basically, to explain, a pcodedmp dump would look like so:
               &#39; Line #7:
               &#39;   Dim 
               &#39;   VarDefn hiz7dgus (As String)
            Here the first line gives out the line number, and the rest are operation lines.
        &#34;&#34;&#34;
        splittedInput = self.myinput.splitlines()
        lines = {}
        i = 0
        started = False
        streams = {}
        laststream = None
        opelinesblock = []
        # we parse each lines, and cut them by line blocks, to put them in &#34;lines&#34;
        #TODO: simplify
        for inputLine in splittedInput:
            inputLine = inputLine.strip()

            if &#39;VBA/&#39; in inputLine and inputLine.endswith(&#39;bytes&#39;): # here we have a new stream in the document
                if laststream is None: #eg first occurence
                    laststream = inputLine
                else:
                    if opelinesblock == []:
                        opelinesblock = [&#39;NewLine&#39;]
                    lines[i] = opelinesblock
                    streams[laststream] = lines
                    opelinesblock = []
                    i = 0
                    lines = {}
                    started = False
                    laststream = inputLine
            if inputLine.startswith(&#39;Line #&#39;): # here is our new line block
                started = True
                if not inputLine.startswith(&#39;Line #0&#39;):
                    
                    if opelinesblock == []:             # when line is blank, it still appears in dump
                        opelinesblock = [&#39;NewLine&#39;]     # so we treat it with a special new operation
                                                        # saying line is blank
                    lines[i] = opelinesblock
                    i+=1
                opelinesblock = []
            else:
                if started:
                    opelinesblock.append(inputLine)

        if opelinesblock == []:
            opelinesblock = [&#39;NewLine&#39;]
            
        lines[i] = opelinesblock
        streams[laststream] = lines

        self.myinput = streams


    def parseOpLine(self, inputLine):
        &#34;&#34;&#34;
            function to parse an operation line.
            to avoid using costly regexp, we split each operation line. The first element is always the operation
            to do, and the rest is potential args. In case there are args, they will be reconstructed by the underlying operation.
        &#34;&#34;&#34;
        linelist = inputLine.split()
        ope = linelist[0]
        args = linelist[1:]
        func = self.operations.ops[ope]
        func(*args)

    def processInput(self, print_linenum):
        &#34;&#34;&#34;
            When the input has been &lt;&lt;parsed&gt;&gt;, this function process it to disassemble the input, by calling parseOpLine for each line. 
            It is basically only a printing function.
            args: 
              - print_linenum: boolean indicating if line numbers should be printed in the output or not. Please refer to function named &#34;process&#34;
        &#34;&#34;&#34;
        for stream in self.myinput.keys():
            if stream:
                self.queueLineOutput(&#39;# DECOMPILED STREAM : &#39; + stream, 0)
            unindented = 0
            for linenum, oplines in self.myinput[stream].items():
                for line in oplines:
                    if line.startswith(&#39;FuncDefn&#39;):
                        unindented += 1
                    if line.startswith(&#39;EndFunc&#39;) or line.startswith(&#39;EndSub&#39;):
                        unindented -= 1
            self.operations.unindented = unindented
            for linenum in self.myinput[stream]:
                try:
                    self.operations.clearstack()
                    for opline in self.myinput[stream][linenum]:
                        self.parseOpLine(opline)
                    if self.operations.hasbos():
                        output_parts = []
                        while self.operations.getstacksize() &gt; 0:
                            output_parts.append(self.operations.getstackpop())
                        output_parts = output_parts[::-1]
                        self.addlineOutput(self.operations.getindentlevel() * &#39;  &#39;, linenum, print_linenum, False)
                        for part in output_parts[:-1]:
                            self.addlineOutput(part + &#39; &#39;, linenum, has_end=False)
                        self.addlineOutput(output_parts[-1], linenum)
                        self.operations.resethasbos()
                    else:
                        self.addlineOutput(self.operations.getindentlevel() * &#39;  &#39; + self.operations.getstacktop(), linenum, print_linenum)
                except Pcode2codeException as e:
                    self.addlineOutput(&#34;&#39; pcode2code, cannot process line &#34;+ str(linenum) + &#39; : &#39; + str(e), linenum, print_linenum)
                    for opline in self.myinput[stream][linenum]:
                        self.addlineOutput(&#34;&#39;\t# &#34; + opline, linenum)
                except Exception as e:
                    self.addlineOutput(&#34;&#39; a generic exception occured at line &#34; + str(linenum) + &#34;: &#34; + str(e), linenum, print_linenum)
                    for opline in self.myinput[stream][linenum]:
                        self.addlineOutput(&#34;&#39;\t# &#34; + opline, linenum)
                self.operations.increaseindentlevel_future()
            self.output_queue.clear()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="refinery.lib.thirdparty.pcode2code.Pcode2codeException"><code class="flex name class">
<span>class <span class="ident">Pcode2codeException</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<section class="desc"><p>Simply a custom exception class, permitting to make the difference between generic python exceptions and the one we are pushing</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L58-L61" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Pcode2codeException(Exception):
    &#34;&#34;&#34;
    Simply a custom exception class, permitting to make the difference between generic python exceptions and the one we are pushing
    &#34;&#34;&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>builtins.Exception</li>
<li>builtins.BaseException</li>
</ul>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Stack"><code class="flex name class">
<span>class <span class="ident">Stack</span></span>
</code></dt>
<dd>
<section class="desc"><p>Our stack class. Used to implement the operations made in the VBA bytecode, which is somehow stack based</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L64-L90" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Stack:
    &#34;&#34;&#34;
    Our stack class. Used to implement the operations made in the VBA bytecode, which is somehow stack based
    &#34;&#34;&#34;

    def __init__(self):
        self.stack = []

    def pop(self):
        if len(self.stack) == 0:
            return None
        return self.stack.pop()

    def push(self, item):
        self.stack.append(item)

    def size(self):
        return len(self.stack)

    def top(self):
        return self.stack[-1]

    def bottom(self):
        return self.stack[0]

    def clearstack(self):
        self.stack = []</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="refinery.lib.thirdparty.pcode2code.Stack.pop"><code class="name flex">
<span>def <span class="ident">pop</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L72-L75" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def pop(self):
    if len(self.stack) == 0:
        return None
    return self.stack.pop()</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Stack.push"><code class="name flex">
<span>def <span class="ident">push</span></span>(<span>self, item)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L77-L78" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def push(self, item):
    self.stack.append(item)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Stack.size"><code class="name flex">
<span>def <span class="ident">size</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L80-L81" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def size(self):
    return len(self.stack)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Stack.top"><code class="name flex">
<span>def <span class="ident">top</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L83-L84" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def top(self):
    return self.stack[-1]</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Stack.bottom"><code class="name flex">
<span>def <span class="ident">bottom</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L86-L87" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def bottom(self):
    return self.stack[0]</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Stack.clearstack"><code class="name flex">
<span>def <span class="ident">clearstack</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L89-L90" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def clearstack(self):
    self.stack = []</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations"><code class="flex name class">
<span>class <span class="ident">Operations</span></span>
<span>(</span><span>opstack)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L93-L3787" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Operations:

    def __init__(self, opstack: Stack):
        self.opstack = opstack
        # number of blocks that will be ignored for indentation
        self.unindented = 0
        # current indentation level
        self.indentlevel = 0
        # boolean indicating if indentation level should be increased after the current command
        self.indentincrease_future = False
        # boolean indicating to print all stack, like in one liner cases
        self.has_bos = False
        # boolean indicating if we are on a onelineif. In this case, closing should not be treated the same as other if blocks
        self.onelineif = False
        self.ops = {
            &#39;Imp&#39;                   : self.imp,
            &#39;Eqv&#39;                   : self.eqv,
            &#39;Xor&#39;                   : self.xor,
            &#39;Or&#39;                    : self.or_,
            &#39;And&#39;                   : self.and_,
            &#39;Eq&#39;                    : self.eq,
            &#39;Ne&#39;                    : self.ne,
            &#39;Le&#39;                    : self.le,
            &#39;Ge&#39;                    : self.ge,
            &#39;Lt&#39;                    : self.lt,
            &#39;Gt&#39;                    : self.gt,
            &#39;Add&#39;                   : self.add,
            &#39;Sub&#39;                   : self.sub,
            &#39;Mod&#39;                   : self.mod,
            &#39;IDiv&#39;                  : self.idiv,
            &#39;Mul&#39;                   : self.mul,
            &#39;Div&#39;                   : self.div,
            &#39;Concat&#39;                : self.concat,
            &#39;Like&#39;                  : self.like,
            &#39;Pwr&#39;                   : self.pwr,
            &#39;Is&#39;                    : self.is_,
            &#39;Not&#39;                   : self.not_,
            &#39;UMi&#39;                   : self.umi,
            &#39;FnAbs&#39;                 : self.fnabs,
            &#39;FnFix&#39;                 : self.fnfix,
            &#39;FnInt&#39;                 : self.fnint,
            &#39;FnSgn&#39;                 : self.fnsgn,
            &#39;FnLen&#39;                 : self.fnlen,
            &#39;FnLenB&#39;                : self.fnlenb,
            &#39;Paren&#39;                 : self.paren,
            &#39;Sharp&#39;                 : self.sharp,
            &#39;LdLHS&#39;                 : self.ldlhs,
            &#39;Ld&#39;                    : self.ld,
            &#39;MemLd&#39;                 : self.memld,
            &#39;DictLd&#39;                : self.dictld,
            &#39;IndexLd&#39;               : self.indexld,
            &#39;ArgsLd&#39;                : self.argsld,
            &#39;ArgsMemLd&#39;             : self.argsmemld,
            &#39;ArgsDictLd&#39;            : self.argsdictld,
            &#39;St&#39;                    : self.st,
            &#39;MemSt&#39;                 : self.memst,
            &#39;DictSt&#39;                : self.dictst,
            &#39;IndexSt&#39;               : self.indexst,
            &#39;ArgsSt&#39;                : self.argsst,
            &#39;ArgsMemSt&#39;             : self.argsmemst,
            &#39;ArgsDictSt&#39;            : self.argsdictst,
            &#39;Set&#39;                   : self.set_,
            &#39;Memset&#39;                : self.memset,
            &#39;Dictset&#39;               : self.dictset,
            &#39;Indexset&#39;              : self.indexset,
            &#39;ArgsSet&#39;               : self.argsset,
            &#39;ArgsMemSet&#39;            : self.argsmemset,
            &#39;ArgsDictSet&#39;           : self.argsdictset,
            &#39;MemLdWith&#39;             : self.memldwith,
            &#39;DictLdWith&#39;            : self.dictldwith,
            &#39;ArgsMemLdWith&#39;         : self.argsmemldwith,
            &#39;ArgsDictLdWith&#39;        : self.argsdictldwith,
            &#39;MemStWith&#39;             : self.memstwith,
            &#39;DictStWith&#39;            : self.dictstwith,
            &#39;ArgsMemStWith&#39;         : self.argsmemstwith,
            &#39;ArgsDictStWith&#39;        : self.argsdictstwith,
            &#39;MemSetWith&#39;            : self.memsetwith,
            &#39;DictSetWith&#39;           : self.dictsetwith,
            &#39;ArgsMemSetWith&#39;        : self.argsmemsetwith,
            &#39;ArgsDictSetWith&#39;       : self.argsdictsetwith,
            &#39;ArgsCall&#39;              : self.argscall,
            &#39;ArgsMemCall&#39;           : self.argsmemcall,
            &#39;ArgsMemCallWith&#39;       : self.argsmemcallwith,
            &#39;ArgsArray&#39;             : self.argsarray,
            &#39;Assert&#39;                : self.assert_,
            &#39;BoS&#39;                   : self.bos,
            &#39;BoSImplicit&#39;           : self.bosimplicit,
            &#39;BoL&#39;                   : self.bol,
            &#39;LdAddressOf&#39;           : self.ldaddressof,
            &#39;MemAddressOf&#39;          : self.memaddressof,
            &#39;Case&#39;                  : self.case,
            &#39;CaseTo&#39;                : self.caseto,
            &#39;CaseGt&#39;                : self.casegt,
            &#39;CaseLt&#39;                : self.caselt,
            &#39;CaseGe&#39;                : self.casege,
            &#39;CaseLe&#39;                : self.casele,
            &#39;CaseNe&#39;                : self.casene,
            &#39;CaseEq&#39;                : self.caseeq,
            &#39;CaseElse&#39;              : self.caseelse,
            &#39;CaseDone&#39;              : self.casedone,
            &#39;Circle&#39;                : self.circle,
            &#39;Close&#39;                 : self.close,
            &#39;CloseAll&#39;              : self.closeall,
            &#39;Coerce&#39;                : self.coerce_,
            &#39;CoerceVar&#39;             : self.coercevar,
            &#39;Context&#39;               : self.context,
            &#39;Debug&#39;                 : self.debug,
            &#39;DefType&#39;               : self.deftype,
            &#39;Dim&#39;                   : self.dim,
            &#39;DimImplicit&#39;           : self.dimimplicit,
            &#39;Do&#39;                    : self.do,
            &#39;DoEvents&#39;              : self.doevents,
            &#39;DoUnitil&#39;              : self.dounitil,
            &#39;DoWhile&#39;               : self.dowhile,
            &#39;Else&#39;                  : self.else_,
            &#39;ElseBlock&#39;             : self.elseblock,
            &#39;ElseIfBlock&#39;           : self.elseifblock,
            &#39;ElseIfTypeBlock&#39;       : self.elseiftypeblock,
            &#39;End&#39;                   : self.end,
            &#39;EndContext&#39;            : self.endcontext,
            &#39;EndFunc&#39;               : self.endfunc,
            &#39;EndIf&#39;                 : self.endif,
            &#39;EndIfBlock&#39;            : self.endifblock,
            &#39;EndImmediate&#39;          : self.endimmediate,
            &#39;EndProp&#39;               : self.endprop,
            &#39;EndSelect&#39;             : self.endselect,
            &#39;EndSub&#39;                : self.endsub,
            &#39;EndType&#39;               : self.endtype,
            &#39;EndWith&#39;               : self.endwith,
            &#39;Erase&#39;                 : self.erase,
            &#39;Error&#39;                 : self.error,
            &#39;EventDecl&#39;             : self.eventdecl,
            &#39;RaiseEvent&#39;            : self.raiseevent,
            &#39;ArgsMemRaiseEvent&#39;     : self.argsmemraiseevent,
            &#39;ArgsMemRaiseEventWith&#39; : self.argsmemraiseeventwith,
            &#39;ExitDo&#39;                : self.exitdo,
            &#39;ExitFor&#39;               : self.exitfor,
            &#39;ExitFunc&#39;              : self.exitfunc,
            &#39;ExitProp&#39;              : self.exitprop,
            &#39;ExitSub&#39;               : self.exitsub,
            &#39;FnCurDir&#39;              : self.fncurdir,
            &#39;FnDir&#39;                 : self.fndir,
            &#39;Empty0&#39;                : self.empty0,
            &#39;Empty1&#39;                : self.empty1,
            &#39;FnError&#39;               : self.fnerror,
            &#39;FnFormat&#39;              : self.fnformat,
            &#39;FnFreeFile&#39;            : self.fnfreefile,
            &#39;FnInStr&#39;               : self.fninstr,
            &#39;FnInStr3&#39;              : self.fninstr3,
            &#39;FnInStr4&#39;              : self.fninstr4,
            &#39;FnInStrB&#39;              : self.fninstrb,
            &#39;FnInStrB3&#39;             : self.fninstrb3,
            &#39;FnInStrB4&#39;             : self.fninstrb4,
            &#39;FnLBound&#39;              : self.fnlbound,
            &#39;FnMid&#39;                 : self.fnmid,
            &#39;FnMidB&#39;                : self.fnmidb,
            &#39;FnStrComp&#39;             : self.fnstrcomp,
            &#39;FnStrComp3&#39;            : self.fnstrcomp3,
            &#39;FnStringVar&#39;           : self.fnstringvar,
            &#39;FnStringStr&#39;           : self.fnstringstr,
            &#39;FnUBound&#39;              : self.fnubound,
            &#39;For&#39;                   : self.for_,
            &#39;ForEach&#39;               : self.foreach,
            &#39;ForEachAs&#39;             : self.foreachas,
            &#39;ForStep&#39;               : self.forstep,
            &#39;FuncDefn&#39;              : self.funcdefn,
            &#39;FuncDefnSave&#39;          : self.funcdefnsave,
            &#39;GetRec&#39;                : self.getrec,
            &#39;GoSub&#39;                 : self.gosub,
            &#39;GoTo&#39;                  : self.goto,
            &#39;If&#39;                    : self.if_,
            &#39;IfBlock&#39;               : self.ifblock,
            &#39;TypeOf&#39;                : self.typeof,
            &#39;IfTypeBlock&#39;           : self.iftypeblock,
            &#39;Implements&#39;            : self.implements,
            &#39;Input&#39;                 : self.input_,
            &#39;InputDone&#39;             : self.inputdone,
            &#39;InputItem&#39;             : self.inputItem,
            &#39;Label&#39;                 : self.label,
            &#39;Let&#39;                   : self.let,
            &#39;Line&#39;                  : self.line,
            &#39;LineCont&#39;              : self.linecont,
            &#39;LineInput&#39;             : self.lineInput,
            &#39;LineNum&#39;               : self.linenum,
            &#39;LitCy&#39;                 : self.litcy,
            &#39;LitDate&#39;               : self.litdate,
            &#39;LitDefault&#39;            : self.litdefault,
            &#39;LitDI2&#39;                : self.litdi2,
            &#39;LitDI4&#39;                : self.litdi4,
            &#39;LitDI8&#39;                : self.litdi8,
            &#39;LitHI2&#39;                : self.lithi2,
            &#39;LitHI4&#39;                : self.lithi4,
            &#39;LitHI8&#39;                : self.lithi8,
            &#39;LitNothing&#39;            : self.litnothing,
            &#39;LitOI2&#39;                : self.litoi2,
            &#39;LitOI4&#39;                : self.litoi4,
            &#39;LitOI8&#39;                : self.litoi8,
            &#39;LitR4&#39;                 : self.litr4,
            &#39;LitR8&#39;                 : self.litr8,
            &#39;LitSmallI2&#39;            : self.litsmalli2,
            &#39;LitStr&#39;                : self.litstr,
            &#39;LitVarSpecial&#39;         : self.litvarspecial,
            &#39;Lock&#39;                  : self.lock,
            &#39;Loop&#39;                  : self.loop,
            &#39;LoopUntil&#39;             : self.loopuntil,
            &#39;LoopWhile&#39;             : self.loopwhile,
            &#39;LSet&#39;                  : self.lset,
            &#39;Me&#39;                    : self.me,
            &#39;MeImplicit&#39;            : self.meimplicit,
            &#39;MemRedim&#39;              : self.memredim,
            &#39;MemRedimWith&#39;          : self.memredimwith,
            &#39;MemRedimAs&#39;            : self.memredimas,
            &#39;MemRedimAsWith&#39;        : self.memredimaswith,
            &#39;Mid&#39;                   : self.mid,
            &#39;MidB&#39;                  : self.midb,
            &#39;Name&#39;                  : self.name,
            &#39;New&#39;                   : self.new,
            &#39;Next&#39;                  : self.next_,
            &#39;NextVar&#39;               : self.nextvar,
            &#39;OnError&#39;               : self.onerror,
            &#39;OnGosub&#39;               : self.ongosub,
            &#39;OnGoto&#39;                : self.ongoto,
            &#39;Open&#39;                  : self.open_,
            &#39;Option&#39;                : self.option,
            &#39;OptionBase&#39;            : self.optionbase,
            &#39;ParamByVal&#39;            : self.parambyval,
            &#39;ParamOmitted&#39;          : self.paramomitted,
            &#39;ParamNamed&#39;            : self.paramnamed,
            &#39;PrintChan&#39;             : self.printchan,
            &#39;PrintComma&#39;            : self.printcomma,
            &#39;PrintEoS&#39;              : self.printeos,
            &#39;PrintItemComma&#39;        : self.printitemcomma,
            &#39;PrintItemNL&#39;           : self.printitemnl,
            &#39;PrintItemSemi&#39;         : self.printitemsemi,
            &#39;PrintNL&#39;               : self.printnl,
            &#39;PrintObj&#39;              : self.printobj,
            &#39;PrintSemi&#39;             : self.printsemi,
            &#39;PrintSpc&#39;              : self.printspc,
            &#39;PrintTab&#39;              : self.printtab,
            &#39;PrintTabComma&#39;         : self.printtabcomma,
            &#39;PSet&#39;                  : self.pset,
            &#39;PutRec&#39;                : self.putrec,
            &#39;QuoteRem&#39;              : self.quoterem,
            &#39;Redim&#39;                 : self.redim,
            &#39;RedimAs&#39;               : self.redimas,
            &#39;Reparse&#39;               : self.reparse,
            &#39;Rem&#39;                   : self.rem,
            &#39;Resume&#39;                : self.resume,
            &#39;Return&#39;                : self.return_,
            &#39;RSet&#39;                  : self.rset,
            &#39;Scale&#39;                 : self.scale,
            &#39;Seek&#39;                  : self.seek,
            &#39;SelectCase&#39;            : self.selectcase,
            &#39;SelectIs&#39;              : self.selectis,
            &#39;SelectType&#39;            : self.selecttype,
            &#39;SetStmt&#39;               : self.setstmt,
            &#39;Stack&#39;                 : self.stack,
            &#39;Stop&#39;                  : self.stop,
            &#39;Type&#39;                  : self.type_,
            &#39;Unlock&#39;                : self.unlock,
            &#39;VarDefn&#39;               : self.vardefn,
            &#39;Wend&#39;                  : self.wend,
            &#39;While&#39;                 : self.while_,
            &#39;With&#39;                  : self.with_,
            &#39;WriteChan&#39;             : self.writechan,
            &#39;ConstFuncExpr&#39;         : self.constfuncexpr,
            &#39;LbConst&#39;               : self.lbconst,
            &#39;LbIf&#39;                  : self.lbif,
            &#39;LbElse&#39;                : self.lbelse,
            &#39;LbElseIf&#39;              : self.lbelseif,
            &#39;LbEndIf&#39;               : self.lbendif,
            &#39;LbMark&#39;                : self.lbmark,
            &#39;EndForVariable&#39;        : self.endforvariable,
            &#39;StartForVariable&#39;      : self.startforvariable,
            &#39;NewRedim&#39;              : self.newredim,
            &#39;StartWithExpr&#39;         : self.startwithexpr,
            &#39;SetOrSt&#39;               : self.setorst,
            &#39;EndEnum&#39;               : self.endenum,
            &#39;Illegal&#39;               : self.illegal,
            &#39;NewLine&#39;               : self.newline
        }

    def imp(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Imp &#39; + arg2
        self.opstack.push(val)

    def eqv(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Eqv &#39; + arg2
        self.opstack.push(val)

    def xor(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Xor &#39; + arg2
        self.opstack.push(val)

    def or_(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Or &#39; + arg2
        self.opstack.push(val)

    def and_(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; And &#39; + arg2
        self.opstack.push(val)

    def eq(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; = &#39; + arg2
        self.opstack.push(val)

    def ne(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &lt;&gt; &#39; + arg2
        self.opstack.push(val)

    def le(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &lt;= &#39; + arg2
        self.opstack.push(val)

    def ge(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &gt;= &#39; + arg2
        self.opstack.push(val)

    def lt(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &lt; &#39; + arg2
        self.opstack.push(val)

    def gt(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &gt; &#39; + arg2
        self.opstack.push(val)

    # ex opeline: &#34;Add&#34;
    # gets the two values on stack, pop them, add them and push again
    def add(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; + &#39; + arg2
        self.opstack.push(val)

    def sub(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; - &#39; + arg2
        self.opstack.push(val)

    def mod(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Mod &#39; + arg2
        self.opstack.push(val)

    def idiv(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; \\ &#39; + arg2
        self.opstack.push(val)

    def mul(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; * &#39; + arg2
        self.opstack.push(val)

    def div(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; / &#39; + arg2
        self.opstack.push(val)

    def concat(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; &amp; &#39; + arg2
        self.opstack.push(val)

    def like(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Like &#39; + arg2
        self.opstack.push(val)

    def pwr(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; ^ &#39; + arg2
        self.opstack.push(val)

    def is_(self):
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        val = arg1 + &#39; Is &#39; + arg2
        self.opstack.push(val)

    def not_(self):
        val = &#39;Not &#39; + self.opstack.pop()
        self.opstack.push(val)

    def umi(self):
        val = &#39;-&#39; + self.opstack.pop()
        self.opstack.push(val)

    def fnabs(self):
        arg = self.opstack.pop()
        val = &#39;Abs(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def fnfix(self):
        arg = self.opstack.pop()
        val = &#39;Fix(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def fnint(self):
        arg = self.opstack.pop()
        val = &#39;int(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def fnsgn(self):
        arg = self.opstack.pop()
        val = &#39;Sgn(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def fnlen(self):
        arg = self.opstack.pop()
        val = &#39;Len(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def fnlenb(self):
        arg = self.opstack.pop()
        val = &#39;LenB(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def paren(self):
        arg = self.opstack.pop()
        val = &#39;(&#39; + arg + &#39;)&#39;
        self.opstack.push(val)

    def sharp(self):
        arg = self.opstack.pop()
        val = &#39;#&#39; + arg
        self.opstack.push(val)

    def ldlhs(self):
        raise Pcode2codeException(&#39;not implemented ldlhs&#39;)

    def ld(self, var):
        &#34;&#34;&#34;
        command defining a variable
        example: X = Y
        gives:
             # Ld Y
             # St X
        &#34;&#34;&#34;
        if var == &#39;id_FFFF&#39;: #hacky way to do it because me does not seem to be fully
            var = &#39;Me&#39;       #parsed by pcodedmp
        self.opstack.push(var)

    def memld(self, var):
        val = self.opstack.pop() + &#39;.&#39; + var
        self.opstack.push(val)

    def dictld(self, var):
        &#34;&#34;&#34;
        cf fields and collections, also index???
        example: Debug.Print rsTable!Title
        gives:
             # Debug
             # PrintObj
             # Ld rsTable
             # DictLd Title
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(self.opstack.pop()+ &#39;!&#39; + var)

    def indexld(self, *args):
        raise Pcode2codeException(&#39;not implemented indexld&#39;)

    def argsld(self, varname, numparams):
        val = varname + &#39;(&#39;
        nb_parameters = int(numparams, 16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)

    def argsmemld(self, var, numparams):
        nb_parameters = int(numparams, 16)
        val = self.opstack.pop() + &#39;.&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)

    def argsdictld(self, var, numparams):
        &#34;&#34;&#34;
        command used when an index of an object with an argument is accessed
        example: Debug.Print myobj!toto(&#34;titi&#34;) 
        gives:
             # Debug
             # PrintObj
             # LitStr 0x0004 &#34;titi&#34;
             # Ld myobj
             # ArgsDictLd toto 0x0001
             # PrintItemNL
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = self.opstack.pop() + &#39;!&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)

    # example line : Function giqw(str As String) As Variant: Dim bytes() As Byte: bytes = str: giqw = bytes: End Function
    # op line:
    # Line #13:
    #     FuncDefn (Function giqw(str As String) As Variant)
    #     BoS 0x0000 
    #     Dim 
    #     VarDefn bytes (As Byte)
    #     BoS 0x0000 
    #     Ld str 
    #     St bytes 
    #     BoS 0x0000 
    #     Ld bytes 
    #     St giqw 
    #     BoS 0x0000 
    #     EndFunc 
    def st(self, arg):
        param = self.opstack.pop()
        val = arg + &#39; = &#39; + param
        self.opstack.push(val)

    def memst(self, var):
        val = self.opstack.pop() + &#39;.&#39; + var
        val = val + &#39; = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def dictst(self, var):
        &#34;&#34;&#34;
        command used when an index is defined directly
        example: myobj!titi = &#34;toto&#34;
        gives:
             # LitStr 0x0004 &#34;toto&#34;
             # Ld myobj
             # DictSt titi
        &#34;&#34;&#34;
        val = self.opstack.pop() + &#39;!&#39; + var + &#39; = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def indexst(self, *args):
        raise Pcode2codeException(&#39;not implemented indexst&#39;)

    # TODO: to check
    def argsst(self, var, numparams):
        nb_parameters = int(numparams, 16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = var + &#39;(&#39; + params[0]
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;

        param2 = self.opstack.pop()
        val += &#39; = &#39; + param2
        self.opstack.push(val)

    def argsmemst(self, var, numparams):
        #TODO: to check
        val = self.opstack.pop() + &#39;.&#39;
        nb_parameters = int(numparams,16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + var + &#39;(&#39; + params[0]
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;

        param2 = self.opstack.pop()
        val += &#39; = &#39; + param2
        self.opstack.push(val)

    def argsdictst(self, var, numparams):
        &#34;&#34;&#34;
        used when an index of an obj with an argument is defined
        example: myobj!titi2(&#34;toto&#34;) = &#34;toto&#34;
        gives:
             # LitStr 0x0004 &#34;toto&#34;
             # LitStr 0x0004 &#34;toto&#34;
             # Ld myobj
             # ArgsDictSt titi2 0x0001
        &#34;&#34;&#34;
        val = self.opstack.pop() + &#39;!&#39; 
        nb_parameters = int(numparams,16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + var + &#39;(&#39; + params[0]
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;

        param2 = self.opstack.pop()
        val += &#39; = &#39; + param2
        self.opstack.push(val)
        
        
        
    def set_(self, var):
        val = &#39;Set &#39; + var + &#39; = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def memset(self, var):
        &#34;&#34;&#34;
        obtained when a property of an object is set
        example: Set YourObject.Text = lobject
        gives:
             # SetStmt
             # Ld lobject
             # Ld YourObject
             # Memset Text
        &#34;&#34;&#34;
        val = &#39;Set &#39; + self.opstack.pop() + &#39;.&#39; + var + &#39; = &#39; + self.opstack.pop()
        self.opstack.push(val)
        
    def dictset(self, var):
        &#34;&#34;&#34;
        obtained when an index of an object is set
        example: Set YourObject!Text = lobject
        gives:
             # SetStmt
             # Ld lobject
             # Ld YourObject
             # Dictset Text
        &#34;&#34;&#34;
        val = &#39;Set &#39; + self.opstack.pop() + &#39;!&#39; + var + &#39; = &#39; + self.opstack.pop()
        self.opstack.push(val)


    def indexset(self, *args):
        raise Pcode2codeException(&#39;not implemented indexset&#39;)

    def argsset(self, var, nb):
        &#34;&#34;&#34;
        obtained when an argument of an object is set
        example: Set YourObject(ggg) = lobject
        gives:
             # SetStmt
             # Ld lobject
             # Ld ggg
             # ArgsSet YourObject 0x0001
        &#34;&#34;&#34;
        val = &#39;Set &#39; + var + &#39;(&#39; + self.opstack.pop() + &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def argsmemset(self, var, numparams):
        &#34;&#34;&#34;
        obtained when an argument of a property of an object is set
        example: Set YourObject.Text2(&#34;titi&#34;) = lobject
        gives:
             # SetStmt
             # Ld lobject
             # LitStr 0x0004 &#34;titi&#34;
             # Ld YourObject
             # ArgsMemSet Text2 0x0001
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;Set &#39; + self.opstack.pop() + &#39;.&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)

        
    def argsdictset(self, var, numparams):
        &#34;&#34;&#34;
        obtained when an argument of a property of an object is set
        example: Set YourObject.Text2(&#34;titi&#34;) = lobject
        gives:
             # SetStmt
             # Ld lobject
             # LitStr 0x0004 &#34;titi&#34;
             # Ld YourObject
             # ArgsMemSet Text2 0x0001
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;Set &#39; + self.opstack.pop() + &#39;!&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)


    def memldwith(self, var):
        &#34;&#34;&#34;
        command defining a part of an object like .&lt;prop&gt;
        example: with blah &lt;....&gt; .Name 
        gives:  # MemLdWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;.&#39; + var)

    def dictldwith(self, var):
        &#34;&#34;&#34;
        accessing an index in a with block
        example: With &lt;smth&gt;.... Debug.Print !au_lname ... end with
        gives:
             # Debug
             # PrintObj
             # DictLdWith au_lname
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;!&#39; + var)

    def argsmemldwith(self, var, numparams):
        &#34;&#34;&#34;
        example: .CodePane.SetSelection .ProcStartLine(sProc, ProcType) + lLine, 1, .ProcStartLine(sProc, ProcType) + lLine + 1, 1
        gives:
             # Ld sProc
             # Ld ProcType
             # ArgsMemLdWith ProcStartLine 0x0002
             # Ld lLine
             # Add
             # LitDI2 0x0001
             # Ld sProc
             # Ld ProcType
             # ArgsMemLdWith ProcStartLine 0x0002
             # Ld lLine
             # Add
             # LitDI2 0x0001
             # Add
             # LitDI2 0x0001
             # MemLdWith CodePane
             # ArgsMemCall SetSelection 0x0004
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;.&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)

        
    def argsdictldwith(self, var, numparams):
        &#34;&#34;&#34;
        command used when an index of an object with an argument is accessed with a with block
        example: With myobj ... Debug.Print !toto(&#34;titi&#34;) ... end with
        gives:
             # Debug
             # PrintObj
             # LitStr 0x0004 &#34;titi&#34;
             # ArgsDictLdWith toto 0x0001
             # PrintItemNL
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;!&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)


    def memstwith(self, var):
        &#34;&#34;&#34;
        command defining a part of an object like .&lt;prop&gt; = &lt;smthg&gt;
        example: .Name = &#34;Coho Vineyard&#34;
        gives:
             # LitStr 0x000D &#34;Coho Vineyard&#34;
             # MemStWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;.&#39; + var + &#39; = &#39; + self.opstack.pop())

        
    def dictstwith(self, var):
        &#34;&#34;&#34;
        command defining a part of an object like !&lt;index&gt; = &lt;smthg&gt;
        example: With ... !Name = &#34;Coho Vineyard&#34; ... end with
        gives:
             # LitStr 0x000D &#34;Coho Vineyard&#34;
             # DictStWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;!&#39; + var + &#39; = &#39; + self.opstack.pop())

        
    def argsmemstwith(self, var, numparams):
        &#34;&#34;&#34;
        command defining a property of an object with arguments in a with statement
        example: With ... .Name(1,2) = b ... end with
        gives:
             # Ld B
             # LitDI2 0x0001
             # LitDI2 0x0002
             # ArgsMemStWith Name 0x0002
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;.&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def argsdictstwith(self, var, *args):
        &#34;&#34;&#34;
        command defining a part of an object like !&lt;index&gt; = &lt;smthg&gt; in a with block
        example: !Name = &#34;Coho Vineyard&#34;
        gives:
             # LitStr 0x000D &#34;Coho Vineyard&#34;
             # DictStWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;!&#39; + var + &#39; = &#39; + self.opstack.pop())


    def memsetwith(self, var):
        &#34;&#34;&#34;
        command defining a set on an index of an object in a with block
        example: with &lt;smth&gt; ... Set .Name = &#34;Coho Vineyard&#34;
        gives:
             # SetStmt
             # LitStr 0x000D &#34;Coho Vineyard&#34;
             # memSetWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;Set .&#39; + var + &#39; = &#39; + self.opstack.pop())

        
    def dictsetwith(self, var):
        &#34;&#34;&#34;
        command defining a set on an index of an object in a with block
        example: with &lt;smth&gt; ... Set !Name = &#34;Coho Vineyard&#34;
        gives:
             # SetStmt
             # LitStr 0x000D &#34;Coho Vineyard&#34;
             # DictSetWith Name
        &#34;&#34;&#34;
        self.opstack.push(&#39;Set !&#39; + var + &#39; = &#39; + self.opstack.pop())

    def argsmemsetwith(self, var, numparams):
        &#34;&#34;&#34;
        command defining a set on an index with an argument of an object in a with block
        example: with &lt;smth&gt; ... Set .nini(&#34;gg&#34;, &#34;ff&#34;, &#34;uu&#34;) = &#34;toto&#34;
        gives:
             # SetStmt
             # LitStr 0x0004 &#34;toto&#34;
             # LitStr 0x0002 &#34;gg&#34;
             # LitStr 0x0002 &#34;ff&#34;
             # LitStr 0x0002 &#34;uu&#34;
             # ArgsMemSetWith nini 0x0003
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;Set !&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)

    def argsdictsetwith(self, var, numparams):
        &#34;&#34;&#34;
        command defining a set on an index with an argument of an object in a with block
        example: with &lt;smth&gt; ... Set !nini(&#34;gg&#34;, &#34;ff&#34;, &#34;uu&#34;) = &#34;toto&#34;
        gives:
             # SetStmt
             # LitStr 0x0004 &#34;toto&#34;
             # LitStr 0x0002 &#34;gg&#34;
             # LitStr 0x0002 &#34;ff&#34;
             # LitStr 0x0002 &#34;uu&#34;
             # ArgsDictSetWith nini 0x0003
        &#34;&#34;&#34;
        nb_parameters = int(numparams, 16)
        val = &#39;Set !&#39; + var + &#39;(&#39;
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;) = &#39; + self.opstack.pop()
        self.opstack.push(val)

    
    def argscall(self, *args):

        if args[0] == &#39;(Call)&#39;:
            nb_parameters = int(args[2],16)
            val = &#39;Call &#39; + args[1] + &#39;(&#39;
            end_val = &#39;)&#39;
        else:
            val = args[0]
            nb_parameters = int(args[1],16)           
            end_val = &#39;&#39;
            
        params = []
        #print &#39;func:&#39; + funcname
        #print &#39;nbparameters : &#39; + str(nb_parameters)
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            if ((params[0].startswith(&#39;(&#39;)) or (args[0] == &#39;(Call)&#39;)):               
                val = val + params[0]
            else:
                val = val + &#39; &#39; + params[0]

            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += end_val
        self.opstack.push(val)

    def argsmemcall(self, *args):
        &#34;&#34;&#34;
        command to call a function of an object
        example: a43g0xT.run ayUBnLK01, 0
        gives : 
           # Ld ayUBnLK01
           # LitDI2 0x0000
           # Ld a43g0xT
           # ArgsMemCall run 0x0002
        &#34;&#34;&#34;
        args = list(args)
        parenthesis = False
        if args[0] == &#39;(Call)&#39;:
            args.pop(0)
            val = &#39;Call &#39; + self.opstack.pop() + &#39;.&#39; + args[0] + &#39;(&#39;
            parenthesis = True
        else:
            val = self.opstack.pop() + &#39;.&#39; + args[0]

        nb_parameters = int(args[1],16)           
        end_val = &#39;&#39;
            
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            if params[0].startswith(&#39;(&#39;):               
                val = val + params[0]
                end_val = &#39;)&#39;
            else:
                if not parenthesis:
                    val = val + &#39; &#39; +params[0]
                else:
                    val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        if parenthesis == True:
            end_val = &#39;)&#39;
        self.opstack.push(val + end_val)

    def argsmemcallwith(self, *args):
        &#34;&#34;&#34;
        command when a function of an object is called in a with definition
        example: With a ... call .a(1,2) ... end with
        gives: 
             # LitDI2 0x0001
             # LitDI2 0x0002
             # ArgsMemCallWith (Call) a 0x0002
        &#34;&#34;&#34;
        parenthesis = False
        args = list(args)
        if args[0] == &#39;(Call)&#39;:
            args.pop(0)
            parenthesis = True
            val = &#39;Call .&#39; + args[0] + &#39;(&#39;
        else:
            val = &#39;.&#39; + args[0]
            
        nb_parameters = int(args[1],16)           
        end_val = &#39;&#39;
            
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            if params[0].startswith(&#39;(&#39;):               
                val = val + params[0]
                end_val = &#39;)&#39;
            else:
                if not parenthesis:
                    val = val + &#39; &#39; + params[0]
                else:
                    val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param

        if parenthesis:
            end_val = &#39;)&#39;
        self.opstack.push(val + end_val)
        

    def argsarray(self, var, numparams):
        val = var + &#39;(&#39;
        nb_parameters = int(numparams,16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        self.opstack.push(val)

    def assert_(self):
        &#34;&#34;&#34;
        command for debug.asser
        example: Debug.Assert blnAssert
        gives : 
              # Ld blnAssert
              # Assert
        &#34;&#34;&#34;
        self.opstack.push(&#39;Debug.Assert &#39; + self.opstack.pop())

    def bos(self, valarg):
        arg = int(valarg,16)
        if arg == 0:
            val = self.opstack.pop() + &#39;:&#39;
        self.opstack.push(val)
        self.has_bos = True

    def bosimplicit(self, *args):
        &#34;&#34;&#34;
        appears useless, but in this case we still need to print whole stack
        example: If Mid$(theString, i, 1) &lt;&gt; Chr$(0) Then Exit For
        gives:
             # Ld theString
             # Ld i
             # LitDI2 0x0001
             # ArgsLd Mid$ 0x0003
             # LitDI2 0x0000
             # ArgsLd Chr$ 0x0001
             # Ne
             # If
             # BoSImplicit
             # ExitFor
             # EndIf
        &#34;&#34;&#34;
        self.has_bos = True
        
    def bol(self, *args):
        raise Pcode2codeException(&#39;not implemented bol&#39;)

    def ldaddressof(self, var):
        &#34;&#34;&#34;
        command for AddressOf keyword
        example: EnumFontFamilies hDC, vbNullString, AddressOf EnumFontFamProc, LB
        gives:
             # Ld hDC
             # Ld vbNullString
             # LdAddressOf EnumFontFamProc
             # Ld LB
             # ArgsCall EnumFontFamilies 0x0004
        &#34;&#34;&#34;
        self.opstack.push(&#39;AddressOf &#39; + var)

    def memaddressof(self, var):
        &#34;&#34;&#34;
        command for AddressOf keyword on a property of an object
        example: MsgBox AddressOf myobj.toto
        gives:
             # Ld myobj
             # MemAddressOf toto
             # ArgsCall MsgBox 0x0001
        &#34;&#34;&#34;
        self.opstack.push(&#39;AddressOf &#39; + self.opstack.pop() + &#39;.&#39; + var)

    def case(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is one value 
        example: Case 0
        gives:
             # LitDI2 0x0000
             # Case
             # CaseDone

        &#34;&#34;&#34;
        self.opstack.push(&#39;Case &#39; + self.opstack.pop())

    def caseto(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is from one value to one other value
        example: Case 0 To 30
        gives:
             # LitDI2 0x0000
             # LitDI2 0x001E
             # CaseTo
             # CaseDone
        &#34;&#34;&#34;
        val = self.opstack.pop()
        self.opstack.push(&#39;Case &#39; + self.opstack.pop() + &#39; To &#39; + val)


    def casegt(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is lower than a value
        example: Case Is &gt; 100
        gives:
             # LitDI2 0x0064
             # CaseGt
             # CaseDone
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is &gt; &#39; + self.opstack.pop())

    def caselt(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is lower than a value
        example: Case Is &lt; 0
        gives:
             # LitDI2 0x0002
             # CaseLt
             # CaseDone
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is &lt; &#39; + self.opstack.pop())

    def casege(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is greater or equal than a value
        example: TODO: to check
        gives:
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is &gt;= &#39; + self.opstack.pop())

    def casele(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is lower or equal than a value
        example: TODO: to check
        gives:
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is &lt;= &#39; + self.opstack.pop())

    def casene(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is different to a value
        example: TODO: to check
        gives:
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is &lt;&gt; &#39; + self.opstack.pop())

    def caseeq(self):
        &#34;&#34;&#34;
        command handling choice in select case where choice is equal to a value
        example: TODO: to check
        gives:
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Is = &#39; + self.opstack.pop())

    def caseelse(self):
        &#34;&#34;&#34;
        command defining a &#34;Case Else&#34; stmt
        example: Case Else
        gives: 
             # CaseElse
        &#34;&#34;&#34;
        self.opstack.push(&#39;Case Else&#39;)

    def casedone(self):
        #pass on purpose, please see previous examples
        pass

    def circle(self, useless):
        &#34;&#34;&#34;
        command used when the circle method of an object is called
        example: Me.Circle (sngHCtr, sngVCtr), sngRadius
        gives:
             # Ld sngHCtr
             # Ld sngVCtr
             # Ld sngRadius
             # LitDI2 0x0000
             # LitDI2 0x0000
             # LitDI2 0x0000
             # LitDI2 0x0000
             # Ld id_FFFF
             # Circle 0x001E
        &#34;&#34;&#34;
        val = self.opstack.pop() + &#39;.Circle (&#39;
        params = []
        for i in range(7):
            params.append(self.opstack.pop())
        params = params[::-1]

        val += params[0] + &#39;, &#39; + params[1] + &#39;), &#39; + params[2]
        all_empty = True
        for param in params[3:]:
            if param != &#39;0&#39;:
                all_empty = False

        if all_empty:
            self.opstack.push(val)
        else:
            for param in params[3:]:
                if param == &#39;0&#39;:
                    val = val + &#39;, &lt;tbr&gt;&#39;
                else:
                    val = val + &#39;, &#39; + param
            val = val.replace(&#39;, &lt;tbr&gt;&#39; , &#39;&#39;)
            self.opstack.push(val)


    def close(self, numparams):
        val = &#39;Close &#39;
        nb_parameters = int(numparams,16)
        params = []
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        self.opstack.push(val)

    def closeall(self):
        &#34;&#34;&#34;
        command used when close is called with no arguments, effectively closing all files
        example: Close
        gives: # CloseAll
        &#34;&#34;&#34;
        self.opstack.push(&#39;Close&#39;)

    def coerce_(self, arg):
        &#34;&#34;&#34;
        command used for variable conversion
        example1: MyLong2 = CLng(MyVal2)
        gives:
             # Ld MyVal2
             # Coerce (Lng)
             # St MyLong2
        example2: MyInt = CInt(MyDouble)
        gives:
             # Ld MyDouble
             # Coerce (Int)
             # St MyInt
        &#34;&#34;&#34;
        if arg == &#39;(Str)&#39;:
            self.opstack.push(&#39;CStr(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Var)&#39;:
            self.opstack.push(&#39;CVar(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Sng)&#39;:
            self.opstack.push(&#39;CSng(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Lng)&#39;:
            self.opstack.push(&#39;CLng(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Int)&#39;:
            self.opstack.push(&#39;CInt(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Dbl)&#39;:
            self.opstack.push(&#39;CDbl(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Date)&#39;:
            self.opstack.push(&#39;CDate(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Cur)&#39;:
            self.opstack.push(&#39;CCur(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Byte)&#39;:
            self.opstack.push(&#39;CByte(&#39; + self.opstack.pop() + &#39;)&#39;)
        elif arg == &#39;(Bool)&#39;:
            self.opstack.push(&#39;CBool(&#39; + self.opstack.pop() + &#39;)&#39;)
        else:
            raise Pcode2codeException(&#39;not implemented coerce&#39;)
        
    def coercevar(self, arg):
        &#34;&#34;&#34;
        example1: MyError = CVErr(32767)
        gives: # CoerceVar (Err)
        &#34;&#34;&#34;
        if arg == &#39;(Err)&#39;:
            self.opstack.push(&#39;CVErr(&#39; + self.opstack.pop() + &#39;)&#39;)
        else:
            raise Pcode2codeException(&#39;not implemented coercevar&#39;)

    def context(self, *args):
        raise Pcode2codeException(&#39;not implemented context&#39;)

    def debug(self):
        &#34;&#34;&#34;
        seems used to invoke debug object
        example: Debug.Print MyVar
        gives:
             # Debug
             # PrintObj
             # Ld MyVar
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Debug&#39;)

    def deftype(self, *args):
        &#34;&#34;&#34;
        command used when def&lt;type&gt; is used.
        TODO: bytes to know ranges appear random. How to do it?
        &#34;&#34;&#34;
        raise Pcode2codeException(&#39;not implemented deftype&#39;)

    # Dim hiz7dgus As String
    # Private Const DefaultBufferSize&amp; = 32768
    # Private CRC_32_Tab(0 To 255) As Long
    # ======================
    # Line #7:
    #   Dim 
    #   VarDefn hiz7dgus (As String)
    # Line #8:
    # Line #9:
    #   Dim (Private Const) 
    #   LitDI4 0x8000 0x0000 
    #   VarDefn DefaultBufferSize
    # Line #10:
    # Line #11:
    #   Dim (Private) 
    #   LitDI2 0x0000 
    #   LitDI2 0x00FF 
    #   VarDefn CRC_32_Tab (As Long)
    def dim(self, *args):
        # args is a tuple, we treat it only when its not empty
        # example of args : (As String), (As Long)...
        if args != ():
            val = args[0]
            for arg in args[1:]:
                val += &#39; &#39; + arg
            val = val[1:-1]
        else:
            val = &#39;Dim&#39;
        self.opstack.push(val)

    def dimimplicit(self):
        self.opstack.push(&#39;DimImplicit&#39;)

    def do(self):
        &#34;&#34;&#34;
        command handling &#34;Do&#34; keyword
        example: Do (we have then the loop and so on)
        gives:
             # Do
        &#34;&#34;&#34;
        self.opstack.push(&#39;Do&#39;)
        self.indentincrease_future = True

    def doevents(self, *args):
        raise Pcode2codeException(&#39;not implemented doevents&#39;)

    def dounitil(self):
        &#34;&#34;&#34;
        command handling &#34;do until&#34; definitions
        example: Do Until Response = &#34;youpi&#34;
        gives:
             # Ld Response
             # ListStr 0x0005 &#34;youpi&#34;
             # Eq
             # DoUnitil
        &#34;&#34;&#34;
        self.opstack.push(&#39;Do Until &#39; + self.opstack.pop())
        self.indentincrease_future = True

    def dowhile(self):
        &#34;&#34;&#34;
        command handling &#34;do while&#34; definitions
        example: Do While Reponse &lt;&gt; &#34;youpi&#34;
        gives:
             # Ld Response
             # LitStr 0x0005 &#34;youpi&#34;
             # Ne
             # DoWhile
        &#34;&#34;&#34;
        self.opstack.push(&#39;Do While &#39; + self.opstack.pop())
        self.indentincrease_future = True

    def else_(self):
        &#34;&#34;&#34;
        command used for a &#34;else&#34; in a if oneliner
        example: If X &lt; 4 Then MsgBox &#34;hi&#34; Else MsgBox &#34;ho&#34;
        gives:
             # Ld X
             # LitDI2 0x0004
             # Lt
             # If
             # BoSImplicit
             # LitStr 0x0002 &#34;hi&#34;
             # ArgsCall MsgBox 0x0001
             # Else
             # BoSImplicit
             # LitStr 0x0002 &#34;Ho&#34;
             # ArgsCall MsgBox 0x0001
             # EndIf
        &#34;&#34;&#34;
        self.opstack.push(&#39;Else&#39;)

    def elseblock(self):
        &#34;&#34;&#34;
        command defining a new &#34;else&#34; for a block
        example: Else
        gives: #Else
        &#34;&#34;&#34;
        self.opstack.push(&#39;Else&#39;)
        self.indentlevel = self.indentlevel - 1
        self.indentincrease_future = True

    def elseifblock(self):
        &#34;&#34;&#34;
        command defining a new &#34;else if&#34; block
        example: ElseIf dayW = DayOfWeek.Thursday Then
        gives:
             # Ld dayW
             # Ld DayOfWeek
             # MemLd Thursday
             # Eq
             # ElseIfBlock
        &#34;&#34;&#34;
        self.opstack.push(&#39;ElseIf &#39; + self.opstack.pop() + &#39; Then&#39;)
        self.indentlevel = self.indentlevel - 1
        self.indentincrease_future = True

    def elseiftypeblock(self, *args):
        raise Pcode2codeException(&#39;not implemented elseiftypeblock&#39;)

    def end(self):
        self.opstack.push(&#39;End&#39;)

    def endcontext(self, *args):
        raise Pcode2codeException(&#39;not implemented endcontext&#39;)

    def endfunc(self):
        self.opstack.push(&#39;End Function&#39;)
        self.indentlevel = self.indentlevel - 1

    def endif(self):
        if self.onelineif == True:
            self.onelineif = False
        else:
            self.opstack.push(&#39;End If&#39;)
            self.indentlevel = self.indentlevel - 1

    def endifblock(self):
        self.opstack.push(&#39;End If&#39;)
        self.indentlevel = self.indentlevel - 1

    def endimmediate(self, *args):
        raise Pcode2codeException(&#39;not implemented endimmediate&#39;)

    def endprop(self):
        &#34;&#34;&#34;
        command handling the end of a property
        example: End Property
        gives: 
             #EndProp
        &#34;&#34;&#34;
        self.opstack.push(&#39;End Property&#39;)
        self.indentlevel = self.indentlevel -1

    def endselect(self):
        &#34;&#34;&#34;
        command defining a stmt of &#34;End Select&#34;, closing a select case.
        example: End Select
        gives: 
             # EndSelect
        &#34;&#34;&#34;
        self.opstack.push(&#39;End Select&#39;)
        self.indentlevel = self.indentlevel - 1

    def endsub(self):
        self.opstack.push(&#39;End Sub&#39;)
        self.indentlevel = self.indentlevel - 1

    def endtype(self):
        &#34;&#34;&#34;
        command to end a new type definition
        example: End Type
        gives:
             #EndType
        &#34;&#34;&#34;
        self.opstack.push(&#39;End Type&#39;)
        self.indentlevel = self.indentlevel - 1

    def endwith(self):
        &#34;&#34;&#34;
        command to end a new with definition
        example: End With
        gives: #EndWith
        &#34;&#34;&#34;
        self.opstack.push(&#39;End With&#39;)
        self.indentlevel = self.indentlevel - 1
        

    def erase(self, nb_params):
        &#34;&#34;&#34;
        command for Erase function keyword
        example: Erase threeDimArray, twoDimArray
        gives:
             # Ld threeDimArray
             # Ld twoDimArray
             # Erase 0x0002
        &#34;&#34;&#34;
        nb_args = int(nb_params, 16)
        val = &#39;&#39;
        params = []
        for i in range(nb_args):
            params.append(self.opstack.pop())
            params = params[::-1]
        val = params[0]
            
        if nb_args &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param

        self.opstack.push(&#39;Erase &#39; + val)


    def error(self):
        &#34;&#34;&#34;
        command used for Error keyword
        example: Error 11
        gives:
             # LitDI2 0x000B
             # Error
        &#34;&#34;&#34;
        self.opstack.push(&#39;Error &#39; + self.opstack.pop())

    def eventdecl(self, *args):
        &#34;&#34;&#34;
        command for declaring a new event in VBA
        example: Event LogonCompleted(UserName As String)
        gives : 
           # EventDecl (Sub LogonCompleted(UserName As String))
        &#34;&#34;&#34;
        val = args[1]
        for arg in args[2:-1]: #strip parenthesis
            val += &#39; &#39; + arg
        self.opstack.push(&#39;Event &#39; + val + &#39; &#39; + args[-1][:-1])

    def raiseevent(self, evt_name, nb_params):
        &#34;&#34;&#34;
        command when RaiseEvent is used
        example: RaiseEvent LogonCompleted(&#34;AntoineJean&#34;)
        gives:
             # LitStr 0x000A &#34;AntoineJan&#34;
             # RaiseEvent LogonCompleted 0x0001
        &#34;&#34;&#34;
        nb_args = int(nb_params, 16)
        val = &#39;&#39;
        params = []
        if nb_args &gt; 0:
            for i in range(nb_args):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = &#39;(&#39;+ params[0]
            
            if nb_args &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;
                    
        self.opstack.push(&#39;RaiseEvent &#39; + evt_name + val)
            

    def argsmemraiseevent(self, var, numparams):
        &#34;&#34;&#34;
        command used when a raiseevent is called on a property of an object
        example: RaiseEvent myobj.LogonCompleted(&#34;AntoineJan&#34;)
        gives:
             # LitStr 0x000A &#34;AntoineJan&#34;
             # Ld myobj
             # ArgsMemRaiseEvent LogonCompleted 0x0001
        &#34;&#34;&#34;
        nb_args = int(numparams, 16)
        val = &#39;RaiseEvent &#39; + self.opstack.pop() + &#39;.&#39; + var + &#39;(&#39;
        params = []
        if nb_args &gt; 0:
            for i in range(nb_args):
                params.append(self.opstack.pop())
            params = params[::-1]
            val += params[0]
            
            if nb_args &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;
        self.opstack.push(val)

    def argsmemraiseeventwith(self, var, numparams):
        &#34;&#34;&#34;
        command used when a raiseevent is called on a property of an object within a with block
        example: with myobj ... RaiseEvent .LogonCompleted(&#34;AntoineJan&#34;) ... end with
        gives:
             # LitStr 0x000A &#34;AntoineJan&#34;
             # ArgsMemRaiseEventWith LogonCompleted 0x0001
        &#34;&#34;&#34;
        nb_args = int(numparams, 16)
        val = &#39;RaiseEvent .&#39; + var + &#39;(&#39;
        params = []
        if nb_args &gt; 0:
            for i in range(nb_args):
                params.append(self.opstack.pop())
            params = params[::-1]
            val += params[0]
            
            if nb_args &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
            val += &#39;)&#39;
        self.opstack.push(val)
    
    def exitdo(self):
        #TODO: comment
        self.opstack.push(&#39;Exit Do&#39;)

    def exitfor(self):
        #TODO: comment
        self.opstack.push(&#39;Exit For&#39;)

    def exitfunc(self):
        #TODO: comment
        self.opstack.push(&#39;Exit Function&#39;)
    
    def exitprop(self):
        #TODO: comment
        self.opstack.push(&#39;Exit Property&#39;)
    
    def exitsub(self):
        #TODO: comment
        self.opstack.push(&#39;Exit Sub&#39;)
    
    def fncurdir(self, *args):
        #val = &#39;CurDir(&#39; + self.opstack.pop() + &#39;)&#39;
        #self.opstack.push(val)
        raise Pcode2codeException(&#39;not implemented fncurdir&#39;)
    
    def fndir(self, *args):
        raise Pcode2codeException(&#39;not implemented fndir&#39;)
    
    def empty0(self, *args):
        raise Pcode2codeException(&#39;not implemented empty0&#39;)
    
    def empty1(self, *args):
        raise Pcode2codeException(&#39;not implemented empty1&#39;)
    
    def fnerror(self, *args):
        raise Pcode2codeException(&#39;not implemented fnerror&#39;)
    
    def fnformat(self, *args):
        raise Pcode2codeException(&#39;not implemented format&#39;)
    
    def fnfreefile(self, *args):
        raise Pcode2codeException(&#39;not implemented fnfreefile&#39;)
    
    def fninstr(self):
        &#34;&#34;&#34;
        command used when calling Instr function with 2 arguments
        example: MyPos = InStr(SearchString, SearchChar)
        gives:
             # Ld SearchString
             # Ld SearchChar
             # FnInStr
             # St MyPos
        &#34;&#34;&#34;
        arg2 = self.opstack.pop()
        self.opstack.push(&#39;Instr(&#39; + self.opstack.pop() + &#39;, &#39; + arg2 + &#39;)&#39;)
    
    def fninstr3(self):
        &#34;&#34;&#34;
        command used when calling Instr function with 3 arguments
        example: MyPos = InStr(1, SearchString, &#34;W&#34;)
        gives:
             # LitDI2 0x0001
             # Ld SearchString
             # LitStr 0x0001 &#34;W&#34;
             # FnInStr3
             # St MyPos
        &#34;&#34;&#34;
        arg3 = self.opstack.pop()
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        self.opstack.push(&#39;Instr(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;)&#39;)
    
    def fninstr4(self):
        &#34;&#34;&#34;
        command used when calling Instr function with 4 arguments
        example: MyPos = InStr(4, SearchString, SearchChar, 1)
        gives:
             # LitDI2 0x0004
             # Ld SearchString
             # Ld SearchChar
             # LitDI2 0x0001
             # FnInStr4
             # St MyPos
        &#34;&#34;&#34;
        arg4 = self.opstack.pop()
        arg3 = self.opstack.pop()
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        self.opstack.push(&#39;Instr(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;, &#39; + arg4 + &#39;)&#39;)
    
    def fninstrb(self):
        &#34;&#34;&#34;
        command used when calling InstrB function with 2 arguments
        example: TODO: make sure here
        gives:
        &#34;&#34;&#34;
        arg2 = self.opstack.pop()
        self.opstack.push(&#39;InstrB(&#39; + self.opstack.pop() + &#39;, &#39; + arg2 + &#39;)&#39;)

        
    def fninstrb3(self):
        &#34;&#34;&#34;
        command used when calling InstrB function with 3 arguments
        example: TODO: make sure here
        gives:

        &#34;&#34;&#34;
        arg3 = self.opstack.pop()
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        self.opstack.push(&#39;InstrB(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;)&#39;)

        
    def fninstrb4(self):
        &#34;&#34;&#34;
        command used when calling InstrB function with 4 arguments
        example: TODO: make sure here
        gives:

        &#34;&#34;&#34;
        arg4 = self.opstack.pop()
        arg3 = self.opstack.pop()
        arg2 = self.opstack.pop()
        arg1 = self.opstack.pop()
        self.opstack.push(&#39;Instr(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;, &#39; + arg4 + &#39;)&#39;)
    
    def fnlbound(self, arg):
        &#34;&#34;&#34;
        command indicating the use of the LBound function
        strangely enough, there is an indication of the number of arguments to be popped out of the stack
        but this number is not good.
        example: Lower = LBound(TwoDArray, 2)
        gives: 
             # Ld TwoDArray
             # LitDI2 0x0002
             # FnLBound 0x0001
             # St Lower
        &#34;&#34;&#34;
        nb_parameters = int(arg,16) + 1
        params = []
        val = &#39;(&#39;
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        val = &#39;LBound&#39; + val
        self.opstack.push(val)
    
    def fnmid(self):
        val = &#39;Mid(&#39; + self.opstack.pop() + &#39;)&#39;
        self.opstack.push(val)
    
    def fnmidb(self):
        val = &#39;MidB(&#39; + self.opstack.pop() + &#39;)&#39;
        self.opstack.push(val)
    
    def fnstrcomp(self):
        &#34;&#34;&#34;
        command used when strcomp function with 2 arguments is called
        example: MyComp = StrComp(MyStr2, MyStr1)
        gives:
             # Ld MyStr2
             # Ld MyStr1
             # FnStrComp
             # St MyComp
        &#34;&#34;&#34;
        str2 = self.opstack.pop()
        str1 = self.opstack.pop()
        self.opstack.push(&#39;StrComp(&#39; + str1 + &#39;, &#39; + str2 + &#39;)&#39;)
            
    def fnstrcomp3(self):
        &#34;&#34;&#34;
        command used when strcomp function with 3 arguments is called
        example: MyComp = StrComp(MyStr1, MyStr2, 0)
        gives:
             # Ld MyStr1
             # Ld MyStr2
             # LitDI2 0x0000
             # FnStrComp3
             # St MyComp
        &#34;&#34;&#34;
        third_arg = self.opstack.pop()
        str2 = self.opstack.pop()
        str1 = self.opstack.pop()
        self.opstack.push(&#39;StrComp(&#39; + str1 + &#39;, &#39; + str2 + &#39;, &#39; + third_arg + &#39;)&#39;)
    
    def fnstringvar(self, *args):
        raise Pcode2codeException(&#39;not implemented fnstringvar&#39;)
    
    def fnstringstr(self, *args):
        raise Pcode2codeException(&#39;not implemented fnstringstr&#39;)
   
    def fnubound(self, arg):
        &#34;&#34;&#34;
        command used when calling Ubound function
        example: uL = UBound(sb_)
        gives:     
             # Ld sb_ 
             # FnUBound 0x0000 
             # St uL
        &#34;&#34;&#34;
        nb_parameters = int(arg,16) + 1
        params = []
        val = &#39;(&#39;
        if nb_parameters &gt; 0:
            for i in range(nb_parameters):
                params.append(self.opstack.pop())
            params = params[::-1]
            val = val + params[0]
            
            if nb_parameters &gt; 1:
                for param in params[1:]:
                    val = val + &#39;, &#39; + param
        val += &#39;)&#39;
        val = &#39;UBound&#39; + val
        self.opstack.push(val)
            
    def for_(self):
        maxvar = self.opstack.pop()
        minvar = self.opstack.pop()
        loopvar = self.opstack.pop()
        val = &#39;For &#39; + loopvar + &#39; = &#39; + minvar + &#39; To &#39; + maxvar
        self.opstack.push(val)
        self.indentincrease_future = True
            
    def foreach(self):
        &#34;&#34;&#34;
        command defining a new for each loop definition
        example: For Each MyObject In MyClasses
        gives:
             # StartForVariable
             # Ld MyObject
             # EndForVariable
             # Ld MyClasses
             # ForEach
        &#34;&#34;&#34;
        collect = self.opstack.pop()
        loopvar = self.opstack.pop()
        val = &#39;For Each &#39; + loopvar + &#39; In &#39; + collect
        self.opstack.push(val)
        self.indentincrease_future = True
    
    def foreachas(self, *args):
        raise Pcode2codeException(&#39;not implemented foreachas&#39;)
            
    def forstep(self):
        step = self.opstack.pop()
        maxvar = self.opstack.pop()
        minvar = self.opstack.pop()
        loopvar = self.opstack.pop()
        val = &#39;For &#39; + loopvar + &#39; = &#39; + minvar + &#39; To &#39; + maxvar + &#39; Step &#39; + step
        self.opstack.push(val)
        self.indentincrease_future = True
            
    def funcdefn(self, *args: str):
        val = args[0]
        for arg in args[1:]:
            val += &#39; &#39; + arg
        val = val[1:-1]
        self.opstack.push(val)
        if not val.startswith(&#39;Declare&#39;):
            self.indentincrease_future = True
            
    def funcdefnsave(self, *args):
        raise Pcode2codeException(&#39;not implemented funcdefnsave&#39;)
            
    def getrec(self):
        &#34;&#34;&#34;
        command to Get from a channel with a record: get channel, record, var
        example: Get #1, RecordNumber, MyRecord
        gives:
             # LitDI2 0x0001
             # Sharp
             # Ld RecordNumber
             # Ld MyRecord
             # GetRec
        &#34;&#34;&#34;
        record = self.opstack.pop()
        record_num = self.opstack.pop()
        chan = self.opstack.pop()
        if chan is not None:
            self.opstack.push(&#39;Get &#39; + chan + &#39;, &#39; + record_num + &#39;, &#39; + record)
        else:
            self.opstack.push(&#39;Get &#39; + record_num + &#39;, , &#39; + record) # kindly ugly
            
    def gosub(self, var):
        &#34;&#34;&#34;
        command used when gosub is used
        example: If Num &gt; 0 Then GoSub MyRoutine 
        gives:
             # Ld Num
             # LitDI2 0x0000
             # Gt
             # If
             # BoSImplicit
             # GoSub MyRoutine
             # EndIf
        &#34;&#34;&#34;
        self.opstack.push(&#39;GoSub &#39; + var)
            
    def goto(self, var):
        &#34;&#34;&#34;
        command used when a goto &lt;label&gt; is defined
        example: GoTo label1
        gives: # GoTo label1
        &#34;&#34;&#34;
        self.opstack.push(&#39;GoTo &#39; + var)

            
    def if_(self, *args):
        val = &#39;If &#39; + self.opstack.pop() + &#39; Then&#39;
        self.onelineif = True
        self.opstack.push(val)
    
    def ifblock(self):
        val = &#39;If &#39; + self.opstack.pop() + &#39; Then&#39;
        self.opstack.push(val)
        self.indentincrease_future = True
    
    def typeof(self, *args):
        &#34;&#34;&#34;
        command used when TypeOf function is used
        TODO: associated type is obscure for now
        &#34;&#34;&#34;
        raise Pcode2codeException(&#39;not implemented typeof&#39;)
            
    def iftypeblock(self, *args):
        raise Pcode2codeException(&#39;not implemented iftypeblock&#39;)
            
    def implements(self, *args):
        &#34;&#34;&#34;
        command used when Implements instruction is used
        TODO: associated type is obscure for now        
        &#34;&#34;&#34;
        raise Pcode2codeException(&#39;not implemented implements&#39;)
            
    def input_(self):
        &#34;&#34;&#34;
        command used when Input function is called
        example : Input #1, MyString, MyNumber
        gives: 
             # LitDI2 0x0001
             # Sharp
             # Input
             # Ld MyString
             # InputItem
             # Ld MyNumber
             # InputItem
             # InputDone        
        &#34;&#34;&#34;
        self.opstack.push(&#39;Input &#39; + self.opstack.pop())
        
    def inputdone(self):
        &#34;&#34;&#34;
        command used when Input function is called
        example : Input #1, MyString, MyNumber
        gives: 
             # LitDI2 0x0001
             # Sharp
             # Input
             # Ld MyString
             # InputItem
             # Ld MyNumber
             # InputItem
             # InputDone        
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            val += elmt
        self.opstack.push(val)

            
    def inputItem(self):
        &#34;&#34;&#34;
        command used when Input function is called
        example : Input #1, MyString, MyNumber
        gives: 
             # LitDI2 0x0001
             # Sharp
             # Input
             # Ld MyString
             # InputItem
             # Ld MyNumber
             # InputItem
             # InputDone        
        &#34;&#34;&#34;
        self.opstack.push(&#39;, &#39; + self.opstack.pop())
            
    def label(self, arg):
        &#34;&#34;&#34;
        command defining a new label
        example: MyString:
        gives:
             # Label MyString
        &#34;&#34;&#34;
        self.opstack.push(arg+&#39;:&#39;)
            
    def let(self, *args):
        &#34;&#34;&#34;
        command used when let keywork is used
        example: Let MyStr  = &#34;Hello World&#34;
        gives:
             # Let
             # LitStr 0x000B &#34;Hello World&#34;
             # St MyStr
        &#34;&#34;&#34;
        self.opstack.push(&#39;Let&#39;)
        self.has_bos = True #we use this hackish way to print it even if not in stack top

            
    def line(self, *args):
        raise Pcode2codeException(&#39;not implemented line&#39;)
            
    def linecont(self, *args):
        #pass on purpose
        pass
            
    def lineInput(self):
        &#34;&#34;&#34;
        command used when Line Input instruction is used (to read one line at a time a file)
        example: Line Input #1, TextLine
        gives:
             # LitDI2 0x0001
             # Ld TextLine
             # LineInput
        &#34;&#34;&#34;
        var = self.opstack.pop()
        num_file = self.opstack.pop()
        self.opstack.push(&#39;Line Input #&#39; + num_file + &#39;, &#39; + var)
            
    def linenum(self, *args):
        # ignoring this seems to work fine.
        return
            
    def litcy(self, *args):
        raise Pcode2codeException(&#39;not implemented litcy&#39;)
            
    def litdate(self, *args):
        &#34;&#34;&#34;
        command to define a date literal
        TODO: but wtf how to get date?
        example1: MyDate = #2/12/1969#
        gives: LitDate 0x0000 0x0000 0xA780 0x40D8
        example2: MyDate = #2/12/1970#
        gives: LitDate 0x0000 0x0000 0x02C0 0x40D9
        example3: MyDate = #2/12/1971#
        gives: LitDate 0x0000 0x0000 0x5E00 0x40D9
        example4: MyDate = #2/11/1969#
        gives: LitDate 0x0000 0x0000 0xA740 0x40D8
        example5: MyDate = #2/10/1969#
        gives: LitDate 0x0000 0x0000 0xA700 0x40D8
        example6: MyDate = #3/12/1969#
        gives: LitDate 0x0000 0x0000 0xAE80 0x40D8
        example7: MyDate = #4/12/1969#
        gives: LitDate 0x0000 0x0000 0xB640 0x40D8


        1 year = 23360 (0x5b40) si on fait last2bytes.first2bytes
        1 month = 64 (0x40) sur second octet
        1 day = 
        &#34;&#34;&#34;
        raise Pcode2codeException(&#39;a date is defined here, but it cannot be reconstructed&#39;)
            
    def litdefault(self):
        &#34;&#34;&#34;
        appears to be useless
        example: Open &#34;TESTFILE&#34; For Output As #1 
        gives:
             # LitStr 0x0008 &#34;TESTFILE&#34;
             # LitDI2 0x0001
             # Sharp
             # LitDefault
             # Open (For Output)
        example2: Lock #1, RecordNumber
        gives:
             # LitDI2 0x0001
             # Sharp
             # Ld RecordNumber
             # LitDefault
             # Lock
        example3: same for unlock
        &#34;&#34;&#34;
        #pass on purpose

    # integer representation on 2 bytes (decimal base10)
    def litdi2(self, value):
        self.opstack.push(str(int(value,16)))

    # integer representation on 4 bytes (decimal base10)
    def litdi4(self, byte1, byte2):
        val = int(byte2+byte1[2:], 16)
        self.opstack.push(str(val))
        
    def litdi8(self, *args):
        raise Pcode2codeException(&#39;not implemented litdi8&#39;)
            
    def lithi2(self, byte):
        val = byte[2:]
        while val.startswith(&#39;0&#39;) and len(val) &gt; 1:
            val = val[1:]
        val = &#39;&amp;H&#39; + val
        self.opstack.push(val)
            
    def lithi4(self, byte1, byte2):
        val = byte2[2:]+byte1[2:]
        while val.startswith(&#39;0&#39;) and len(val) &gt; 1:
            val = val[1:]
        val = &#39;&amp;H&#39; + val
        self.opstack.push(val)
            
    def lithi8(self, *args):
        raise Pcode2codeException(&#39;not implemented lithi8&#39;)
            
    def litnothing(self):
        &#34;&#34;&#34;
        command defining the &#34;Nothing&#34; variable
        example: Set Inst = Nothing
        gives:
             # SetStmt
             # LitNothing
             # Set Inst
        &#34;&#34;&#34;
        self.opstack.push(&#39;Nothing&#39;)
            
    def litoi2(self, value):
        &#34;&#34;&#34;
        command used when an octal is defined on a two bytes byte array
        example: B = &amp;O1
        gives:
             # LitOI2 0x0001
             # St B
        &#34;&#34;&#34;
        var = int(value,16)
        var2 = str(oct(var))[2:]
        self.opstack.push(&#39;&amp;O&#39; + var2)
            
    def litoi4(self, byte1, byte2):
        &#34;&#34;&#34;
        command used when an octal is defined on a two bytes byte array
        example: B = &amp;O12345644444
        gives:
             # LitOI4 0x4924 0x5397
             # St B
        &#34;&#34;&#34;        
        val = byte2[2:]+byte1[2:]
        var = int(val,16)
        var2 = str(oct(var))[2:]
        self.opstack.push(&#39;&amp;O&#39; + var2)
        
            
    def litoi8(self, *args):
        raise Pcode2codeException(&#39;not implemented litoi8&#39;)
            
    def litr4(self, byte1, byte2):
        &#34;&#34;&#34;
        command used when a floating point on 32 bit is declared
        &#34;&#34;&#34;
        val = byte2[2:]+byte1[2:]
        self.opstack.push(str(struct.unpack(&#34;!f&#34;, bytes.fromhex(val))[0]))
            
    def litr8(self, byte1, byte2, byte3, byte4):
        &#34;&#34;&#34;
        command used when a floating point on 64 bit is declared
        &#34;&#34;&#34;
        val = byte4[2:]+byte3[2:]+byte2[2:]+byte1[2:]
        self.opstack.push(str(struct.unpack(&#34;!d&#34;, bytes.fromhex(val))[0]))
            
    def litsmalli2(self, *args):
        raise Pcode2codeException(&#39;not implemented malli2&#39;)
            
    def litstr(self, mylen, *args):
        val = args[0]
        for arg in args[1:]:
            val += &#39; &#39; + arg
        if len(val)&gt;=2:
            #assert(val[0]==&#39;&#34;&#39; and val[-1]==&#39;&#34;&#39;)
            val = val[1:-1]
            val = val.replace(&#39;&#34;&#39;, &#39;&#34;&#34;&#39;)
            val = &#39;&#34;&#39; + val + &#39;&#34;&#39;

        self.opstack.push(val)
            
    def litvarspecial(self, var):
        self.opstack.push(var[1:-1])
            
    def lock(self):
        &#34;&#34;&#34;
        command to lock a record
        example: Lock #1, RecordNumber
        gives:
             # LitDI2 0x0001
             # Sharp
             # Ld RecordNumber
             # LitDefault
             # Lock
        &#34;&#34;&#34;
        if self.opstack.size() == 3:
            last_record = self.opstack.pop()
            first_record = self.opstack.pop()
            chan = self.opstack.pop()
            self.opstack.push(&#39;Lock &#39; + chan + &#39;, &#39; + first_record + &#39; To &#39; + last_record)
        elif self.opstack.size() == 2:
            record = self.opstack.pop()
            chan = self.opstack.pop()
            self.opstack.push(&#39;Lock &#39; + chan + &#39;, &#39; + record)
        elif self.opstack.size() == 1:
            chan = self.opstack.pop()
            self.opstack.push(&#39;Lock &#39; + chan)
            
    def loop(self):
        self.opstack.push(&#39;Loop&#39;)
        self.indentlevel = self.indentlevel - 1
            
    def loopuntil(self):
        &#34;&#34;&#34;
        command defining a loop until statement for &#34;do&#34;
        example: Loop Until TheName = &#34;&#34;
        gives:
             # Ld TheName
             # LitStr 0x0000 &#34;&#34;
             # Eq
             # LoopUntil
        &#34;&#34;&#34;
        self.opstack.push(&#39;Loop Until &#39; + self.opstack.pop())
        self.indentlevel = self.indentlevel - 1
            
    def loopwhile(self):
        &#34;&#34;&#34;
        command handling &#34; while&#34; definitions
        example: Loop While Reponse = 5
        gives:
             # Ld Response
             # LitDI2  0x0005
             # Eq
             # LoopWhile
        &#34;&#34;&#34;
        self.opstack.push(&#39;Loop While &#39; + self.opstack.pop())
        self.indentlevel = self.indentlevel - 1

            
    def lset(self):
        &#34;&#34;&#34;
        command for RSet keyword
        example: LSet MyString = &#34;Right-&gt;&#34;
        gives:
             # LitStr 0x0007 &#34;Right-&gt;&#34;
             # Ld MyString
             # RSet
        &#34;&#34;&#34;
        var = self.opstack.pop()
        val = self.opstack.pop()
        self.opstack.push(&#39;LSet &#39; + var + &#39; = &#39; + val)
            
    def me(self, *args):
        raise Pcode2codeException(&#39;not implemented me&#39;)
            
    def meimplicit(self, *args):
        &#34;&#34;&#34;
        command used when the object is the current form
        example: Print 
        gives:
             # MeImplicit
             # PrintObj
             # PrintNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;MeImplicit&#39;) #just pushing a specific marker to change treatment later
            
    def memredim(self, *args):
        &#34;&#34;&#34;
        command used when a property of an object is redim
        example: ReDim myobj.foo(30)
        gives:
             # OptionBase
             # LitDI2 0x001E
             # Ld myobj
             # MemRedim foo 0x0001 (As Variant)
        &#34;&#34;&#34;
        val = self.opstack.pop()
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + val + &#39;.&#39; + args[0] + &#39;(&#39;
        else:
            val2 = &#39;ReDim &#39;
            if preserve:
                val2 += &#39;Preserve &#39;
            val2 += val + &#39;.&#39; + args[0] + &#39;(&#39;
            val = val2

        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;
        self.opstack.push(val)
            
    def memredimwith(self, *args):
        &#34;&#34;&#34;
        command used when a property of an object is redim within a with
        example: with myobj ... ReDim .foo(30) .. end with
        gives:
             # OptionBase
             # LitDI2 0x001E
             # MemRedimWith foo 0x0001 (As Variant)
        &#34;&#34;&#34;
        val = &#39;&#39;
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + &#39;.&#39; + args[0] + &#39;(&#39;
        else:
            val += &#39;ReDim &#39;
            if preserve:
                val += &#39;Preserve &#39;
            val += &#39;.&#39; + args[0] + &#39;(&#39;

        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;
        self.opstack.push(val)

            
    def memredimas(self, *args):
        &#34;&#34;&#34;
        command used when a redim is defined on a property of an object with a As in the end
        example: ReDim myobj.mytab(50) As Double
        gives:
             # OptionBase
             # LitDI2 0x003C
             # Ld myobj
             # MemRedimAs Tab 0x0001 (As Double)
        &#34;&#34;&#34;
        val = self.opstack.pop()
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + val + &#39;.&#39; + args[0] + &#39;(&#39;
        else:
            val2 = &#39;ReDim &#39;
            if preserve:
                val2 += &#39;Preserve &#39;
            val2 += val + &#39;.&#39; + args[0] + &#39;(&#39;
            val = val2
            
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;

        args.pop(0) #remove var
        args.pop(0) # remove nb_params
        if len(args)&gt; 0: # do we have smthng like &#34;(As &lt;type&gt;)&#34;
            if args[-1] != &#39;Variant)&#39;:
                val += &#39; &#39; + args[0][1:] + &#39; &#39; + args[1][:-1]
        self.opstack.push(val)
            
    def memredimaswith(self, *args):
        &#34;&#34;&#34;
        command used when a redim is defined on a property of an object with a As in the end, within a with block
        example: With myobj ... ReDim .mytab(70) As Integer ... End With 
        gives:
             # OptionBase
             # LitDI2 0x0046
             # MemRedimAsWith Tab 0x0001 (As Integer)
        &#34;&#34;&#34;
        val = &#39;&#39;
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + &#39;.&#39; + args[0] + &#39;(&#39;
        else:
            val += &#39;ReDim &#39;
            if preserve:
                val += &#39;Preserve &#39;
            val += &#39;.&#39; + args[0] + &#39;(&#39;
            
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;

        args.pop(0) #remove var
        args.pop(0) # remove nb_params
        if len(args)&gt; 0: # do we have smthng like &#34;(As &lt;type&gt;)&#34;
            if args[-1] != &#39;Variant)&#39;:
                val += &#39; &#39; + args[0][1:] + &#39; &#39; + args[1][:-1]
        self.opstack.push(val)
            
    def mid(self):
        &#34;&#34;&#34;
        command used when Mid funtion is used to set a sub string part, e.g. as an instruction
        example: Mid(MyString, 5, 3) = &#34;fox&#34;
        gives:
             # LitStr 0x0003 &#34;fox&#34;
             # Ld MyString
             # LitDI2 0x0005
             # LitDI2 0x0003
             # Mid
        &#34;&#34;&#34;
        if self.opstack.size() &gt; 3:
            length = self.opstack.pop()
            start = self.opstack.pop()
            obj = self.opstack.pop()
            str1 = self.opstack.pop()
            self.opstack.push(&#39;Mid(&#39; + obj + &#39;, &#39; + start + &#39;, &#39; + length + &#39;) = &#39; + str1)
        else:
            start = self.opstack.pop()
            obj = self.opstack.pop()
            str1 = self.opstack.pop()
            self.opstack.push(&#39;Mid(&#39; + obj + &#39;, &#39; + start + &#39;) = &#39; + str1)            
            
    def midb(self):
        &#34;&#34;&#34;
        command used when Mid funtion is used to set a sub string part, e.g as an instruction
        example: MidB(MyString, 5, 3) = &#34;fox&#34;
        gives:
             # LitStr 0x0003 &#34;fox&#34;
             # Ld MyString
             # LitDI2 0x0005
             # LitDI2 0x0003
             # MidB
        &#34;&#34;&#34;
        if self.opstack.size() &gt; 3:
            length = self.opstack.pop()
            start = self.opstack.pop()
            obj = self.opstack.pop()
            str1 = self.opstack.pop()
            self.opstack.push(&#39;MidB(&#39; + obj + &#39;, &#39; + start + &#39;, &#39; + length + &#39;) = &#39; + str1)
        else:
            start = self.opstack.pop()
            obj = self.opstack.pop()
            str1 = self.opstack.pop()
            self.opstack.push(&#39;MidB(&#39; + obj + &#39;, &#39; + start + &#39;) = &#39; + str1)            

            
    def name(self):
        &#34;&#34;&#34;
        command for the name keyword, permitting to rename variables
        example: Name OldName As NewName
        gives:
             # Ld OldName
             # Ld NewName
             # Name
        &#34;&#34;&#34;
        newname = self.opstack.pop()
        oldname = self.opstack.pop()
        self.opstack.push(&#39;Name &#39; + oldname + &#39; As &#39; + newname) 
            
    def new(self, var):
        self.opstack.push(&#39;New &#39; + var)
            
    def next_(self):
        self.opstack.push(&#39;Next&#39;)
        self.indentlevel = self.indentlevel - 1
        self.indentincrease_future = False
            
    def nextvar(self):
        self.opstack.push(&#39;Next &#39; + self.opstack.pop())
        self.indentlevel = self.indentlevel - 1
            
    def onerror(self, *args):
        &#34;&#34;&#34;
        command defining &#34;on error&#34; statements
        example1: On Error GoTo ErrorHandler
        gives:
             # OnError ErrorHandler
        example2: On Error GoTo 0
        gives: 
             # OnError (GoTo 0)
        example3: On Error Resume Next
        gives: 
             # OnError (Resume Next)
        &#34;&#34;&#34;
        if args[0] == &#39;(Resume&#39;:
            self.opstack.push(&#39;On Error Resume Next&#39;)
        elif args[0] == &#39;(GoTo&#39;:
            self.opstack.push(&#39;On Error GoTo 0&#39;)
        else:
            #TODO: to check
            self.opstack.push(&#39;On Error GoTo &#39; + args[0])
            
    def ongosub(self, nb, *args):
        &#34;&#34;&#34;
        command used for gosub on a variable
        example: On Number GoSub Sub1, Sub2
        gives:
             # Ld Number
             # OnGoSub 0x0004 Sub1, Sub2
        &#34;&#34;&#34;
        val = &#39;On &#39; + self.opstack.pop() + &#39; GoSub &#39;
        val2 = args[0]
        for arg in args[1:]:
            val2 += &#39; &#39; + arg
        self.opstack.push(val + val2)
            
    def ongoto(self, nb, *args):
        &#34;&#34;&#34;
        command used for goto on a variable
        example: On Number GoTo Line1, Line2
        gives:
             # Ld Number
             # OnGoto 0x0004 Line1, Line2
        &#34;&#34;&#34;
        val = &#39;On &#39; + self.opstack.pop() + &#39; GoTo &#39;
        val2 = args[0]
        for arg in args[1:]:
            val2 += &#39; &#39; + arg
        self.opstack.push(val + val2)
            
    def open_(self, *args):
        &#34;&#34;&#34;
        command used for Open function
        example: Open &#34;TESTFILE&#34; For Output As #1
        gives:
             # LitStr 0x0008 &#34;TESTFILE&#34;
             # LitDI2 0x0001
             # Sharp
             # LitDefault
             # Open (For Output)
        example2: Open &#34;TESTFILE&#34; For Binary Access Write Lock Write As #1
        gives:
             # LitStr 0x0008 &#34;TESTFILE&#34;
             # LitDI2 0x0001
             # Sharp
             # LitDefault
             # Open (For Binary Access Write Lock Write)
        &#34;&#34;&#34;
        chan = self.opstack.pop()
        val = args[0][1:] # avoid parenthesis
        for arg in args[1:]:
            val += &#39; &#39; + arg
        val = val[:-1] #avoid parenthesis
        self.opstack.push(&#39;Open &#39; + self.opstack.pop() + &#39; &#39; + val + &#39; As &#39; + chan)
            
    def option(self, *args):
        &#34;&#34;&#34;
        command for option keyword
        example: Option Explicit
        gives : 
           # Option (Explicit)
        example2: Option Compare Binary
        gives :
           # Option (Compare Binary)
        &#34;&#34;&#34;
        val = args[0][1:]
        if len(args)&gt;1:
            for arg in args[1:]: #strip parenthesis
                val += &#39; &#39; + arg
        self.opstack.push(&#39;Option &#39; + val[:-1])
            
    def optionbase(self):
        &#34;&#34;&#34;
        used in the following case: when a table dimension is not declared from base to end, but only size;
        to treat it, we will push a magic value on stack like for dim and dimimplicit, and vardef will treat it directly
        example1: Dim MyArray(20)
        gives: 
             # Dim
             # OptionBase
             # LitDI2 0x0014
             # VarDefn MyArray
        &#34;&#34;&#34;
        self.opstack.push(&#39;OptionBase&#39;)
            
    def parambyval(self):
        &#34;&#34;&#34;
        command used when Byval keyword is used
        example: a ByVal b
        gives:
             # Ld B
             # ParamByVal
             # ArgsCall a 0x0001
        &#34;&#34;&#34;
        self.opstack.push(&#39;ByVal &#39; + self.opstack.pop())
            
    def paramomitted(self):
        &#34;&#34;&#34;
        command used when a parameter is left blank in a function call
        example: MsgBox Msg, , &#34;Deferred Error Test&#34;
        gives:
             # Ld Msg
             # ParamOmitted
             # LitStr 0x0013 &#34;Deferred Error Test&#34;
             # ArgsCall MsgBox 0x0003
        &#34;&#34;&#34;
        self.opstack.push(&#39;&#39;)
            
    def paramnamed(self, var):
        &#34;&#34;&#34;
        command used when a call is made with named parameters
        example: MyClasses.Add Item:=Inst, Key:=CStr(Num)
        gives:
             # Ld Inst
             # ParamNamed Item
             # Ld Num
             # Coerce (Str)
             # ParamNamed Key
             # Ld MyClasses
             # ArgsMemCall Add 0x0002
        &#34;&#34;&#34;
        self.opstack.push(var + &#39;:=&#39; + self.opstack.pop())
            
    def printchan(self):
        &#34;&#34;&#34;
        command defining &#34;print&#34; to a channel
        example: Print #1, MyBool; &#34; is a Boolean value&#34;
        gives:
             # LitDI2 0x0001
             # Sharp
             # PrintChan
             # Ld MyBool
             # PrintItemSemi
             # LitStr 0x0013 &#34; is a Boolean value&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Print &#39; +self.opstack.pop() + &#39;,&#39;)
    
    def printcomma(self, *args):
        &#34;&#34;&#34;
        command used when a colon is used in Print
        example: Debug.Print Spc(30), &#34;Thirty spaces later...
        gives:
             # Debug
             # PrintObj
             # LitDI2 0x001E
             # PrintSpc
             # PrintComma
             # LitStr 0x0016 &#34;Thirty spaces later...&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;,&#39;)
            
    def printeos(self):
        &#34;&#34;&#34;
        used at the end of some print when there is nothing, instead of printitemnl
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            if ((elmt == &#39;;&#39;) or (elmt == &#39;,&#39;)) and (elmts.index(elmt) != 1):
                val+= elmt
            else:
                val += &#39; &#39; + elmt
        self.opstack.push(val)

            
    def printitemcomma(self):
        &#34;&#34;&#34;
        command defining &#34;,&#34;, used for example when writing 
        example: Write #1, &#34;Hello World&#34;, 234
        gives:
             # LitDI2 0x0001
             # Sharp
             # WriteChan
             # LitStr 0x000B &#34;Hello World&#34;
             # PrintItemComma
             # LitDI2 0x00EA
             # PrintItemNL
             # QuoteRem 0x0020 0x001C &#34; Write comma-delimited data.&#34;
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            val += &#39; &#39; + elmt
        self.opstack.push(val + &#39;,&#39;)
            
    def printitemnl(self):
        &#34;&#34;&#34;
        TODO: not sure what&#39;s it is used for
        example1: Write #1, MyBool; &#34; is a Boolean value&#34;
        gives:
             # LitDI2 0x0001
             # Sharp
             # WriteChan
             # Ld MyBool
             # PrintItemSemi
             # LitStr 0x0013 &#34; is a Boolean value&#34;
             # PrintItemNL
        example2:  Debug.Print i
        gives:
             # Debug
             # PrintObj
             # Ld i
             # PrintItemNL
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            if ((elmt == &#39;;&#39;) or (elmt == &#39;,&#39;)) and (elmts.index(elmt) != 1):
                val+= elmt
            else:
                val += &#39; &#39; + elmt
        self.opstack.push(val)
            
    def printitemsemi(self):
        &#34;&#34;&#34;
        command defining &#34;;&#34;, used for example when writing 
        example: Write #1, MyBool; &#34; is a Boolean value&#34;
        gives:
             # LitDI2 0x0001
             # Sharp
             # WriteChan
             # Ld MyBool
             # PrintItemSemi
             # LitStr 0x0013 &#34; is a Boolean value&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            val += &#39; &#39; + elmt
        self.opstack.push(val + &#39;;&#39;)
            
    def printnl(self):
        &#34;&#34;&#34;
        really not sure about this one
        example: Write #1,     
        gives:
             # LitDI2 0x0001
             # Sharp
             # WriteChan
             # PrintNL
        &#34;&#34;&#34;
        elmts = []
        while self.opstack.size() &gt;= 1:
            elmts.append(self.opstack.pop())
        elmts = elmts[::-1]
        val = elmts[0]
        for elmt in elmts[1:]:
            val += &#39; &#39; + elmt
        self.opstack.push(val)
    
    def printobj(self):
        &#34;&#34;&#34;
        appears to call the print method of an object
        example:  Debug.Print i
        gives:
             # Debug
             # PrintObj
             # Ld i
             # PrintItemNL
        &#34;&#34;&#34;
        if self.opstack.top() == &#39;MeImplicit&#39;:
            self.opstack.pop()
            self.opstack.push(&#39;Print&#39;)
        else:
            self.opstack.push(self.opstack.pop() + &#39;.Print&#39;)
            
    def printsemi(self, *args):
        &#34;&#34;&#34;
        command used when a semicolon is used in Print
        example: Debug.Print Spc(30); &#34;Thirty spaces later...
        gives:
             # Debug
             # PrintObj
             # LitDI2 0x001E
             # PrintSpc
             # PrintSemi
             # LitStr 0x0016 &#34;Thirty spaces later...&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;;&#39;)
            
    def printspc(self):
        &#34;&#34;&#34;
        command used when SPC(n) is used in Print
        example: Debug.Print Spc(30); &#34;Thirty spaces later...
        gives:
             # Debug
             # PrintObj
             # LitDI2 0x001E
             # PrintSpc
             # PrintSemi
             # LitStr 0x0016 &#34;Thirty spaces later...&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Spc(&#39; + self.opstack.pop() + &#39;)&#39;)
            
    def printtab(self, *args):
        &#34;&#34;&#34;
        command used when Tab(n) is used in Print
        example: Debug.Print Tab(30); &#34;Thirty spaces later...
        gives:
             # Debug
             # PrintObj
             # LitDI2 0x001E
             # PrintTab
             # PrintSemi
             # LitStr 0x0016 &#34;Thirty spaces later...&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Tab(&#39; + self.opstack.pop() + &#39;)&#39;)
            
    def printtabcomma(self):
        &#34;&#34;&#34;
        command used when Tab with no arg is used in Print
        example: Debug.Print Tab, &#34;Thirty spaces later...
        gives:
             # Debug
             # PrintObj
             # PrintTabComma
             # PrintComma
             # LitStr 0x0016 &#34;Thirty spaces later...&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Tab&#39;)
            
    def pset(self, numparams):
        &#34;&#34;&#34;
        command used when the pset method of an object is called
        example: Me.PSet (intI, sngMidPt)
        gives:
             # Ld intI
             # Ld sngMidPt
             # LitDI2 0x0000
             # Ld id_FFFF
             # PSet 0x0002
        &#34;&#34;&#34;
        val = self.opstack.pop() + &#39;.PSet(&#39;
        first_arg = self.opstack.pop()
        if first_arg != &#39;0&#39;:
            val += first_arg + &#39;, &#39;
            
        nb_args = int(numparams, 16)
        params = []
        if nb_args &gt; 0:
            for i in range(nb_args):
                params.append(self.opstack.pop())
            params = params[::-1]

            val += params[0]
            for param in params[1:]:
                val = val + &#39;, &#39; + param
        val +=&#39;)&#39;
        self.opstack.push(val)
            
    def putrec(self):
        &#34;&#34;&#34;
        command to Put to a channel with a record: Put channel, record, var
        example: Put #1, RecordNumber, MyRecord
        gives:
             # LitDI2 0x0001
             # Sharp
             # Ld RecordNumber
             # Ld MyRecord
             # PutRec
        &#34;&#34;&#34;
        record = self.opstack.pop()
        record_num = self.opstack.pop()
        chan = self.opstack.pop()
        self.opstack.push(F&#39;Put {chan}, {record_num}, {record}&#39;)
            
    def quoterem(self, val1, lenvar, *args):
        &#34;&#34;&#34;
        command handling comments definition with &#39;
        multiple cases:
        example : MsgBox &#34;toto&#34; &#39;a message to send
        gives:
             # LitStr 0x0004 &#34;toto&#34;
             # ArgsCall MsgBox 0x0001
             # QuoteRem 0x000F 0x11

        example : TODO macaroni
        gives: TODO macaroni
        &#34;&#34;&#34;
        val = &#34;&#39;&#34; + args[0][1:]
        for arg in args[1:] :
            val += &#39; &#39; + arg
        val = val[:-1]
        if self.opstack.size() != 0:
            val = self.opstack.pop() + &#39; &#39; + val
        self.opstack.push(val)


    def redim(self, *args):
        &#34;&#34;&#34;
        command used when redim function is used
        example : ReDim temp(4)
        gives:
             # OptionBase
             # LitDI2 0x0004
             # Redim temp 0x0001 (As Variant)
        &#34;&#34;&#34;
        val = &#39;&#39;
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + args[0] + &#39;(&#39;
        else:
            val += &#39;ReDim &#39;
            if preserve:
                val += &#39;Preserve &#39;
            val += args[0] + &#39;(&#39;
            
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;
        self.opstack.push(val)

        
    def redimas(self, *args):
        &#34;&#34;&#34;
        command used when a redim is defined with a As in the end
        example: ReDim mytab(50) As Double
        gives:
             # OptionBase
             # LitDI2 0x0032
             # RedimAs mytab 0x0001 (As Double)
        &#34;&#34;&#34;
        val = &#39;&#39;
        args = list(args)
        preserve = False
        if args[0] == &#39;(Preserve)&#39;:
            args.pop(0)
            preserve = True

        nb_params = int(args[1], 16)

        values = []
        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
            val = values.pop(0) + &#39;, &#39; + args[0] + &#39;(&#39;
        else:
            val += &#39;ReDim &#39;
            if preserve:
                val += &#39;Preserve &#39;
            val += args[0] + &#39;(&#39;
            
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        val += &#39;)&#39;

        args.pop(0) #remove var
        args.pop(0) # remove nb_params
        if len(args)&gt; 0: # do we have smthng like &#34;(As &lt;type&gt;)&#34;
            if args[-1] != &#39;Variant)&#39;:
                val += &#39; &#39; + args[0][1:] + &#39; &#39; + args[1][:-1]
        self.opstack.push(val)
            
    def reparse(self, *args):
        &#34;&#34;&#34;
        opcode used when a non valid statement is employed
        &#34;&#34;&#34;
        val = args[1][1:]
        for arg in args[2:]:
            val += &#39; &#39; + arg
        val = val[:-1] # avoid double quotes
        self.opstack.push(val)


    def rem(self, *args):
        &#34;&#34;&#34;
        command for Rem keyword
        example: Rem This entire line is a comment
        gives:  # Rem 0x001F &#34; This entire line is a comment.&#34;
        &#34;&#34;&#34;
        val = args[2] # avoid space+double quote
        for arg in args[3:]:
            val += &#39; &#39; + arg
        val = val[:-1] #avoid double quote
        self.opstack.push(&#39;Rem &#39; + val)
        
            
    def resume(self, *args):
        &#34;&#34;&#34;
        command used when resume keyword is used 
        example1: Resume
        gives: # Resume
        example2: Resume Next
        gives: # Resume (Next)
        example3: Resume titi
        gives: # Resume titi
        &#34;&#34;&#34;
        if args == ():
            self.opstack.push(&#39;Resume&#39;)
        else:
            if args[0] == &#39;(Next)&#39;:
                self.opstack.push(&#39;Resume Next&#39;)
            else:
                self.opstack.push(&#39;Resume &#39; + args[0])
            
    def return_(self):
        #TODO: comment
        self.opstack.push(&#39;Return&#39;)
            
    def rset(self):
        &#34;&#34;&#34;
        command for RSet keyword
        example: RSet MyString = &#34;Right-&gt;&#34;
        gives:
             # LitStr 0x0007 &#34;Right-&gt;&#34;
             # Ld MyString
             # RSet
        &#34;&#34;&#34;
        var = self.opstack.pop()
        val = self.opstack.pop()
        self.opstack.push(&#39;RSet &#39; + var + &#39; = &#39; + val)
            
    def scale(self, *args):
        &#34;&#34;&#34;
        command used when an object scale method is used
        example: Me.Scale 
        gives:
             # LitDI2 0x0000
             # LitDI2 0x0000
             # Ld sngNewH
             # Ld sngNewV
             # Ld id_FFFF
             # Scale 0x0000
        TODO: what to do with this command?
        &#34;&#34;&#34;
        raise Pcode2codeException(&#39;not implemented scale&#39;)
            
    def seek(self):
        &#34;&#34;&#34;
        opcode used when seek is used to search in a file
        example: Seek #1, 2
        gives:
             # LitDI2 0x0001
             # Sharp
             # LitDI2 0x0002
             # Seek
        &#34;&#34;&#34;
        data = self.opstack.pop()
        self.opstack.push(&#39;Seek &#39; + self.opstack.pop() + &#39;, &#39; + data)
            
    def selectcase(self):
        &#34;&#34;&#34;
        command handling a &#34;select case&#34; definition against a variable
        example : Select Case x
        gives:
             # Ld x
             # SelectCase
        &#34;&#34;&#34;
        self.opstack.push(&#39;Select Case &#39; + self.opstack.pop())
        self.indentincrease_future = True
    
    def selectis(self, *args):
        raise Pcode2codeException(&#39;not implemented selectis&#39;)
            
    def selecttype(self, *args):
        raise Pcode2codeException(&#39;not implemented selecttype&#39;)
            
    def setstmt(self):
        # TODO: comment
        #pass on purpose
        pass
            
    def stack(self, *args):
        raise Pcode2codeException(&#39;not implemented stack&#39;)
            
    def stop(self):
        #TODO: comment
        self.opstack.push(&#39;Stop&#39;)
            
    def type_(self, *args):
        &#34;&#34;&#34;
        command for Type keyword, #TODO: beware because it&#39;s also used for enum keyword
        example: Type EmployeeRecord
        gives : 
           # Type EmployeeRecord
        &#34;&#34;&#34;
        if args[0] == &#39;(Private)&#39;:
            self.opstack.push(&#39;Private Type &#39; + args[1])
        elif args[0] == &#39;(Public)&#39;:
            self.opstack.push(&#39;Public Type &#39; + args[1])
        else:
            self.opstack.push(&#39;Type &#39; + args[0])
        self.indentincrease_future = True
            
    def unlock(self):
        &#34;&#34;&#34;
        command to unlock a record
        example: Unlock #1, RecordNumber
        gives:
             # LitDI2 0x0001
             # Sharp
             # Ld RecordNumber
             # LitDefault
             # Unlock
        &#34;&#34;&#34;
        if self.opstack.size() == 3:
            last_record = self.opstack.pop()
            first_record = self.opstack.pop()
            chan = self.opstack.pop()
            self.opstack.push(&#39;Unlock &#39; + chan + &#39;, &#39; + first_record + &#39; To &#39; + last_record)
        elif self.opstack.size() == 2:
            record = self.opstack.pop()
            chan = self.opstack.pop()
            self.opstack.push(&#39;Unlock &#39; + chan + &#39;, &#39; + record)
        elif self.opstack.size() == 1:
            chan = self.opstack.pop()
            self.opstack.push(&#39;Unlock &#39; + chan)



    # Dim hiz7dgus As String
    # Private Const DefaultBufferSize&amp; = 32768
    # Private CRC_32_Tab(0 To 255) As Long
    # ======================
    # Line #7:
    #   Dim 
    #   VarDefn hiz7dgus (As String)
    # Line #8:
    # Line #9:
    #   Dim (Private Const) 
    #   LitDI4 0x8000 0x0000 
    #   VarDefn DefaultBufferSize
    # Line #10:
    # Line #11:
    #   Dim (Private) 
    #   LitDI2 0x0000 
    #   LitDI2 0x00FF 
    #   VarDefn CRC_32_Tab (As Long)
    def vardefn(self, *args):      
        ending =&#39;&#39;
        args = list(args) #quite ugly, but fu...
        if args[0] == &#39;(WithEvents)&#39;:
            var = args.pop(0)[1:-1] + &#39; &#39; + args.pop(0)
        else:
            var = args.pop(0)

        spaces = 1
        if len(args) &gt; 0:
            if args[-1].startswith(&#39;0x&#39;):
                spaces = int(args.pop(-1),16) #TODO: treat spaces there
            ending = args[0]
            for arg in args[1:]:
                ending += &#39; &#39; + arg
            ending = &#39; &#39; + ending[1:-1]
            

        # first we check if this is only one literal definition
        # in this case, we get Dim definitions and we are all set up
        stacktop = self.opstack.pop()

        if stacktop == &#39;DimImplicit&#39;: #case where dim is implicit, 
            val = var + ending  # we have pushed in this case &#39;DimImplicit&#39; on stack
            self.opstack.push(val)
            return

        # in this case we have a single variable declaration
        decls = [&#39;Dim&#39;, &#39;Private&#39;, &#39;Public&#39;, &#39;Protected&#39;, &#39;Friend&#39;, &#39;Protected Friend&#39;, &#39;Shared&#39;, &#39;Shadows&#39;, &#39;Static&#39;, &#39;ReadOnly&#39;]
        if stacktop in decls:
            val = stacktop + &#39; &#39; + var + ending
            self.opstack.push(val)
            return

        else:
            # in this case, our variable is either a table, or there is also some const declarations
            # if so, walk the stack and check for declaration
            self.opstack.push(stacktop)
            values = []

            # gather all stack
            while self.opstack.size() &gt; 0:
                values.append(self.opstack.pop())
            values = values[::-1]

            # if we have multiple vardefn with dim, then we are here
            # because all previous vardef should have been pushed correctly on stack
            if len(values) == 1 :
                for decl in decls:
                    if values[0].startswith(decl):
                        val = values[0] +&#39;, &#39; + var + ending
                        self.opstack.push(val)
                        return
                    
            # if const is used for declaration, then a value is attributed to variable
            # appears somehow not possible to declare a table as const, so far so good, no need to check this case
            if &#39;Const&#39; in values[0]:
                val = values.pop(0)
                end_val = &#39; = &#39; + values.pop(0)
                if len(values) &gt; 0:
                    # how to say what is dimensions to what is attribution
                    #val = &#39;Undefined variable declaration&#39;
                    raise Pcode2codeException(&#39;undefined variable declaration&#39;)
                else:
                    val = val + &#39; &#39; + var + ending + end_val
                self.opstack.push(val)
                return
            
            #so here we have a table
            val = &#39;&#39;
            if values[0] in decls: #first we check if this is the first definition
                val += values.pop(0) + &#39; &#39; + var + &#39;(&#39;
            elif values[0] == &#39;DimImplicit&#39;: #not sure about this one
                values.pop(0)
                val += var + &#39;(&#39;
            else:
                #next we check for a previous declaration
                prev_decl = False
                for decl in decls:
                    if values[0].startswith(decl):
                        val += values.pop(0) +&#39;, &#39; + var + &#39;(&#39;
                        prev_decl = True
                if prev_decl is False: #in this case, nothing before
                    val+= var + &#39;(&#39;

            #first occurence
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

            #other occurences
            while len(values) &gt; 0:
                val += &#39;, &#39;
                curr_val1 = values.pop(0)
                curr_val2 = values.pop(0)
                if curr_val1 == &#39;OptionBase&#39;:
                    val += curr_val2 
                else:
                    val += curr_val1 + &#39; To &#39; + curr_val2 

            #closing
            val += &#39;)&#39; + ending
            self.opstack.push(val)

    def wend(self):
        &#34;&#34;&#34;
        command handling end of while loop &#34;Wend&#34;
        example: Wend
        gives : 
              # Wend
        &#34;&#34;&#34;
        self.opstack.push(&#39;Wend&#39;)
        self.indentlevel = self.indentlevel - 1
            
    def while_(self):
        &#34;&#34;&#34;
        command handling &#34;while&#34; loops definitions
        example: While numero &lt;= 12
        gives:
             # Ld numero
             # LitDI2 0x000C
             # Le
             # While
        &#34;&#34;&#34;
        self.opstack.push(&#39;While &#39; + self.opstack.pop())
        self.indentincrease_future = True
            
    def with_(self):
        &#34;&#34;&#34;
        command handling &#34;with&#34; definitions
        example: with theWindow 
        gives:
             # StartWithExpr
             # Ld theWindow
             # With
        &#34;&#34;&#34;
        self.opstack.push(&#39;With &#39; + self.opstack.pop())
        self.indentincrease_future = True
            
    def writechan(self):
        &#34;&#34;&#34;
        command defining &#34;write&#34; to a channel
        example: Write #1, MyBool; &#34; is a Boolean value&#34;
        gives:
             # LitDI2 0x0001
             # Sharp
             # WriteChan
             # Ld MyBool
             # PrintItemSemi
             # LitStr 0x0013 &#34; is a Boolean value&#34;
             # PrintItemNL
        &#34;&#34;&#34;
        self.opstack.push(&#39;Write &#39; +self.opstack.pop() + &#39;,&#39;)
            
    def constfuncexpr(self, *args):
        raise Pcode2codeException(&#39;not implemented constfuncexpr&#39;)
            
    def lbconst(self, var):
        &#34;&#34;&#34;
        opcode used when #Const is used
        example: #Const x = y
        gives:
             # LbMark
             # Ld B
             # LbConst a
        &#34;&#34;&#34;
        self.opstack.push(&#39;#Const &#39; + var + &#39; = &#39; + self.opstack.pop())
    
    def lbif(self):
        &#34;&#34;&#34;
        opcode used when #If is used
        example: #If a = b Then
        gives:
             # LbMark
             # Ld a
             # Ld B
             # Eq
             # LbIf
        &#34;&#34;&#34;
        self.opstack.push(&#39;#If &#39; + self.opstack.pop() + &#39; Then&#39;)
        self.indentincrease_future = True
    
    def lbelse(self):
        &#34;&#34;&#34;
        opcode used when #Else is used
        example: #Else 
        gives: lbElse
        &#34;&#34;&#34;
        self.opstack.push(&#39;#Else&#39;)
        self.indentlevel = self.indentlevel - 1
        self.indentincrease_future = True
            
    def lbelseif(self):
        &#34;&#34;&#34;
        opcode used when #Elseif is used
        example: #ElseIf a = c Then
        gives:
             # LbMark
             # Ld a
             # Ld c
             # Eq
             # LbElseIf
        &#34;&#34;&#34;
        self.opstack.push(&#39;#ElseIf &#39; + self.opstack.pop() + &#39; Then&#39;)
        self.indentlevel = self.indentlevel - 1
        self.indentincrease_future = True
            
    def lbendif(self):
        &#34;&#34;&#34;
        opcode used when &#34;#End If&#34; is used
        example: #End If
        gives: #LbEndIf
        &#34;&#34;&#34;
        self.opstack.push(&#39;#End If&#39;)
        self.indentlevel = self.indentlevel - 1
            
    def lbmark(self):
        &#34;&#34;&#34;
        appears to be used to indicate the start of a lb statement, appears quite useless
        &#34;&#34;&#34;
        pass #pass on purposes

    def endforvariable(self):
        &#34;&#34;&#34;
        This command ends out a for loop variable definition. Gives nothing interesting in fact
        example: TODO macaroni
        gives: TODO macaroni
        &#34;&#34;&#34;
        #pass on purposes
            
    def startforvariable(self):
        &#34;&#34;&#34;
        This command starts out a for loop variable definition. Gives nothing interesting in fact
        example: TODO macaroni
        gives: TODO macaroni
        &#34;&#34;&#34;
        #pass on purposes
            
    def newredim(self, *args):
        raise Pcode2codeException(&#39;not implemented newredim&#39;)
            
    def startwithexpr(self):
        &#34;&#34;&#34;
        used like startforvariable, eg, simply an indicator of when a with variable is declared.
        pretty useless for us.
        example: With theWindow
        gives:
             # StartWithExpr
             # Ld theWindow
             # With
        &#34;&#34;&#34;
        #pass on purposes
            
    def setorst(self, *args):
        raise Pcode2codeException(&#39;not implemented setorst&#39;)
            
    def endenum(self):
        &#34;&#34;&#34;
        command to end an enum
        example: End Enum
        gives:
             #EndEnum
        &#34;&#34;&#34;
        self.opstack.push(&#39;End Enum&#39;)
        self.indentlevel = self.indentlevel - 1
            
    def illegal(self, *args):
        raise Pcode2codeException(&#39;not implemented illegal&#39;)

    def newline(self):
        &#34;&#34;&#34;
        defines a blank line. Used for internal processing, for blank streams and lines
        &#34;&#34;&#34;
        self.opstack.push(&#39;&#39;)
    
    def clearstack(self):
        self.opstack.clearstack()

    def getstacktop(self):
        return self.opstack.top()

    def getstackpop(self):
        return self.opstack.pop()

    def getstacksize(self):
        return self.opstack.size()

    def increaseindentlevel_future(self):
        &#34;&#34;&#34;
        when we increase the indent level, we need to first print out the line, and then to increase the indent level. 
        to do so, when a line has been printed, this function checks if the indent level need to be increased and do so.
        &#34;&#34;&#34;
        if self.unindented &gt; 0:
            self.unindented -= 1
        elif self.indentincrease_future:
            self.indentlevel = self.indentlevel + 1
        self.indentincrease_future = False
    
    def getindentlevel(self):
        &#34;&#34;&#34;
         function retrieving the class indentlevel parameter, used to print out code with correct indent
        &#34;&#34;&#34;
        return self.indentlevel

    def hasbos(self):
        return self.has_bos

    def resethasbos(self):
        self.has_bos = False</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.imp"><code class="name flex">
<span>def <span class="ident">imp</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L375-L379" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def imp(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; Imp &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.eqv"><code class="name flex">
<span>def <span class="ident">eqv</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L381-L385" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def eqv(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; Eqv &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.xor"><code class="name flex">
<span>def <span class="ident">xor</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L387-L391" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def xor(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; Xor &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.or_"><code class="name flex">
<span>def <span class="ident">or_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L393-L397" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def or_(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; Or &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.and_"><code class="name flex">
<span>def <span class="ident">and_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L399-L403" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def and_(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; And &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.eq"><code class="name flex">
<span>def <span class="ident">eq</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L405-L409" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def eq(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; = &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.ne"><code class="name flex">
<span>def <span class="ident">ne</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L411-L415" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def ne(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; &lt;&gt; &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.le"><code class="name flex">
<span>def <span class="ident">le</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L417-L421" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def le(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; &lt;= &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.ge"><code class="name flex">
<span>def <span class="ident">ge</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L423-L427" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def ge(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; &gt;= &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lt"><code class="name flex">
<span>def <span class="ident">lt</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L429-L433" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lt(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; &lt; &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.gt"><code class="name flex">
<span>def <span class="ident">gt</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L435-L439" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def gt(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; &gt; &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.add"><code class="name flex">
<span>def <span class="ident">add</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L443-L447" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def add(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; + &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.sub"><code class="name flex">
<span>def <span class="ident">sub</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L449-L453" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def sub(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; - &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.mod"><code class="name flex">
<span>def <span class="ident">mod</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L455-L459" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def mod(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; Mod &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.idiv"><code class="name flex">
<span>def <span class="ident">idiv</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L461-L465" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def idiv(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; \\ &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.mul"><code class="name flex">
<span>def <span class="ident">mul</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L467-L471" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def mul(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; * &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.div"><code class="name flex">
<span>def <span class="ident">div</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L473-L477" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def div(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; / &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.concat"><code class="name flex">
<span>def <span class="ident">concat</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L479-L483" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def concat(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; &amp; &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.like"><code class="name flex">
<span>def <span class="ident">like</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L485-L489" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def like(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; Like &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.pwr"><code class="name flex">
<span>def <span class="ident">pwr</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L491-L495" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def pwr(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; ^ &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.is_"><code class="name flex">
<span>def <span class="ident">is_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L497-L501" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def is_(self):
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    val = arg1 + &#39; Is &#39; + arg2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.not_"><code class="name flex">
<span>def <span class="ident">not_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L503-L505" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def not_(self):
    val = &#39;Not &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.umi"><code class="name flex">
<span>def <span class="ident">umi</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L507-L509" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def umi(self):
    val = &#39;-&#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnabs"><code class="name flex">
<span>def <span class="ident">fnabs</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L511-L514" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnabs(self):
    arg = self.opstack.pop()
    val = &#39;Abs(&#39; + arg + &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnfix"><code class="name flex">
<span>def <span class="ident">fnfix</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L516-L519" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnfix(self):
    arg = self.opstack.pop()
    val = &#39;Fix(&#39; + arg + &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnint"><code class="name flex">
<span>def <span class="ident">fnint</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L521-L524" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnint(self):
    arg = self.opstack.pop()
    val = &#39;int(&#39; + arg + &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnsgn"><code class="name flex">
<span>def <span class="ident">fnsgn</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L526-L529" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnsgn(self):
    arg = self.opstack.pop()
    val = &#39;Sgn(&#39; + arg + &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnlen"><code class="name flex">
<span>def <span class="ident">fnlen</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L531-L534" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnlen(self):
    arg = self.opstack.pop()
    val = &#39;Len(&#39; + arg + &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnlenb"><code class="name flex">
<span>def <span class="ident">fnlenb</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L536-L539" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnlenb(self):
    arg = self.opstack.pop()
    val = &#39;LenB(&#39; + arg + &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.paren"><code class="name flex">
<span>def <span class="ident">paren</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L541-L544" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def paren(self):
    arg = self.opstack.pop()
    val = &#39;(&#39; + arg + &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.sharp"><code class="name flex">
<span>def <span class="ident">sharp</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L546-L549" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def sharp(self):
    arg = self.opstack.pop()
    val = &#39;#&#39; + arg
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.ldlhs"><code class="name flex">
<span>def <span class="ident">ldlhs</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L551-L552" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def ldlhs(self):
    raise Pcode2codeException(&#39;not implemented ldlhs&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.ld"><code class="name flex">
<span>def <span class="ident">ld</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a variable
example: X = Y
gives:
# Ld Y
# St X</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L554-L564" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def ld(self, var):
    &#34;&#34;&#34;
    command defining a variable
    example: X = Y
    gives:
         # Ld Y
         # St X
    &#34;&#34;&#34;
    if var == &#39;id_FFFF&#39;: #hacky way to do it because me does not seem to be fully
        var = &#39;Me&#39;       #parsed by pcodedmp
    self.opstack.push(var)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.memld"><code class="name flex">
<span>def <span class="ident">memld</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L566-L568" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def memld(self, var):
    val = self.opstack.pop() + &#39;.&#39; + var
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.dictld"><code class="name flex">
<span>def <span class="ident">dictld</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>cf fields and collections, also index???
example: Debug.Print rsTable!Title
gives:
# Debug
# PrintObj
# Ld rsTable
# DictLd Title
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L570-L581" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dictld(self, var):
    &#34;&#34;&#34;
    cf fields and collections, also index???
    example: Debug.Print rsTable!Title
    gives:
         # Debug
         # PrintObj
         # Ld rsTable
         # DictLd Title
         # PrintItemNL
    &#34;&#34;&#34;
    self.opstack.push(self.opstack.pop()+ &#39;!&#39; + var)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.indexld"><code class="name flex">
<span>def <span class="ident">indexld</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L583-L584" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def indexld(self, *args):
    raise Pcode2codeException(&#39;not implemented indexld&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsld"><code class="name flex">
<span>def <span class="ident">argsld</span></span>(<span>self, varname, numparams)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L586-L600" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsld(self, varname, numparams):
    val = varname + &#39;(&#39;
    nb_parameters = int(numparams, 16)
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]
        
        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsmemld"><code class="name flex">
<span>def <span class="ident">argsmemld</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L602-L616" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsmemld(self, var, numparams):
    nb_parameters = int(numparams, 16)
    val = self.opstack.pop() + &#39;.&#39; + var + &#39;(&#39;
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]

        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsdictld"><code class="name flex">
<span>def <span class="ident">argsdictld</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when an index of an object with an argument is accessed
example: Debug.Print myobj!toto("titi")
gives:
# Debug
# PrintObj
# LitStr 0x0004 "titi"
# Ld myobj
# ArgsDictLd toto 0x0001
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L618-L643" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsdictld(self, var, numparams):
    &#34;&#34;&#34;
    command used when an index of an object with an argument is accessed
    example: Debug.Print myobj!toto(&#34;titi&#34;) 
    gives:
         # Debug
         # PrintObj
         # LitStr 0x0004 &#34;titi&#34;
         # Ld myobj
         # ArgsDictLd toto 0x0001
         # PrintItemNL
    &#34;&#34;&#34;
    nb_parameters = int(numparams, 16)
    val = self.opstack.pop() + &#39;!&#39; + var + &#39;(&#39;
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]

        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.st"><code class="name flex">
<span>def <span class="ident">st</span></span>(<span>self, arg)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L660-L663" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def st(self, arg):
    param = self.opstack.pop()
    val = arg + &#39; = &#39; + param
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.memst"><code class="name flex">
<span>def <span class="ident">memst</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L665-L668" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def memst(self, var):
    val = self.opstack.pop() + &#39;.&#39; + var
    val = val + &#39; = &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.dictst"><code class="name flex">
<span>def <span class="ident">dictst</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when an index is defined directly
example: myobj!titi = "toto"
gives:
# LitStr 0x0004 "toto"
# Ld myobj
# DictSt titi</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L670-L680" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dictst(self, var):
    &#34;&#34;&#34;
    command used when an index is defined directly
    example: myobj!titi = &#34;toto&#34;
    gives:
         # LitStr 0x0004 &#34;toto&#34;
         # Ld myobj
         # DictSt titi
    &#34;&#34;&#34;
    val = self.opstack.pop() + &#39;!&#39; + var + &#39; = &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.indexst"><code class="name flex">
<span>def <span class="ident">indexst</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L682-L683" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def indexst(self, *args):
    raise Pcode2codeException(&#39;not implemented indexst&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsst"><code class="name flex">
<span>def <span class="ident">argsst</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L686-L701" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsst(self, var, numparams):
    nb_parameters = int(numparams, 16)
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = var + &#39;(&#39; + params[0]
        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
        val += &#39;)&#39;

    param2 = self.opstack.pop()
    val += &#39; = &#39; + param2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsmemst"><code class="name flex">
<span>def <span class="ident">argsmemst</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L703-L720" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsmemst(self, var, numparams):
    #TODO: to check
    val = self.opstack.pop() + &#39;.&#39;
    nb_parameters = int(numparams,16)
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + var + &#39;(&#39; + params[0]
        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
        val += &#39;)&#39;

    param2 = self.opstack.pop()
    val += &#39; = &#39; + param2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsdictst"><code class="name flex">
<span>def <span class="ident">argsdictst</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>used when an index of an obj with an argument is defined
example: myobj!titi2("toto") = "toto"
gives:
# LitStr 0x0004 "toto"
# LitStr 0x0004 "toto"
# Ld myobj
# ArgsDictSt titi2 0x0001</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L722-L747" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsdictst(self, var, numparams):
    &#34;&#34;&#34;
    used when an index of an obj with an argument is defined
    example: myobj!titi2(&#34;toto&#34;) = &#34;toto&#34;
    gives:
         # LitStr 0x0004 &#34;toto&#34;
         # LitStr 0x0004 &#34;toto&#34;
         # Ld myobj
         # ArgsDictSt titi2 0x0001
    &#34;&#34;&#34;
    val = self.opstack.pop() + &#39;!&#39; 
    nb_parameters = int(numparams,16)
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + var + &#39;(&#39; + params[0]
        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
        val += &#39;)&#39;

    param2 = self.opstack.pop()
    val += &#39; = &#39; + param2
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.set_"><code class="name flex">
<span>def <span class="ident">set_</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L751-L753" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def set_(self, var):
    val = &#39;Set &#39; + var + &#39; = &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.memset"><code class="name flex">
<span>def <span class="ident">memset</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>obtained when a property of an object is set
example: Set YourObject.Text = lobject
gives:
# SetStmt
# Ld lobject
# Ld YourObject
# Memset Text</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L755-L766" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def memset(self, var):
    &#34;&#34;&#34;
    obtained when a property of an object is set
    example: Set YourObject.Text = lobject
    gives:
         # SetStmt
         # Ld lobject
         # Ld YourObject
         # Memset Text
    &#34;&#34;&#34;
    val = &#39;Set &#39; + self.opstack.pop() + &#39;.&#39; + var + &#39; = &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.dictset"><code class="name flex">
<span>def <span class="ident">dictset</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>obtained when an index of an object is set
example: Set YourObject!Text = lobject
gives:
# SetStmt
# Ld lobject
# Ld YourObject
# Dictset Text</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L768-L779" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dictset(self, var):
    &#34;&#34;&#34;
    obtained when an index of an object is set
    example: Set YourObject!Text = lobject
    gives:
         # SetStmt
         # Ld lobject
         # Ld YourObject
         # Dictset Text
    &#34;&#34;&#34;
    val = &#39;Set &#39; + self.opstack.pop() + &#39;!&#39; + var + &#39; = &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.indexset"><code class="name flex">
<span>def <span class="ident">indexset</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L782-L783" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def indexset(self, *args):
    raise Pcode2codeException(&#39;not implemented indexset&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsset"><code class="name flex">
<span>def <span class="ident">argsset</span></span>(<span>self, var, nb)</span>
</code></dt>
<dd>
<section class="desc"><p>obtained when an argument of an object is set
example: Set YourObject(ggg) = lobject
gives:
# SetStmt
# Ld lobject
# Ld ggg
# ArgsSet YourObject 0x0001</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L785-L796" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsset(self, var, nb):
    &#34;&#34;&#34;
    obtained when an argument of an object is set
    example: Set YourObject(ggg) = lobject
    gives:
         # SetStmt
         # Ld lobject
         # Ld ggg
         # ArgsSet YourObject 0x0001
    &#34;&#34;&#34;
    val = &#39;Set &#39; + var + &#39;(&#39; + self.opstack.pop() + &#39;) = &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsmemset"><code class="name flex">
<span>def <span class="ident">argsmemset</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>obtained when an argument of a property of an object is set
example: Set YourObject.Text2("titi") = lobject
gives:
# SetStmt
# Ld lobject
# LitStr 0x0004 "titi"
# Ld YourObject
# ArgsMemSet Text2 0x0001</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L798-L822" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsmemset(self, var, numparams):
    &#34;&#34;&#34;
    obtained when an argument of a property of an object is set
    example: Set YourObject.Text2(&#34;titi&#34;) = lobject
    gives:
         # SetStmt
         # Ld lobject
         # LitStr 0x0004 &#34;titi&#34;
         # Ld YourObject
         # ArgsMemSet Text2 0x0001
    &#34;&#34;&#34;
    nb_parameters = int(numparams, 16)
    val = &#39;Set &#39; + self.opstack.pop() + &#39;.&#39; + var + &#39;(&#39;
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]

        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;) = &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsdictset"><code class="name flex">
<span>def <span class="ident">argsdictset</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>obtained when an argument of a property of an object is set
example: Set YourObject.Text2("titi") = lobject
gives:
# SetStmt
# Ld lobject
# LitStr 0x0004 "titi"
# Ld YourObject
# ArgsMemSet Text2 0x0001</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L825-L849" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsdictset(self, var, numparams):
    &#34;&#34;&#34;
    obtained when an argument of a property of an object is set
    example: Set YourObject.Text2(&#34;titi&#34;) = lobject
    gives:
         # SetStmt
         # Ld lobject
         # LitStr 0x0004 &#34;titi&#34;
         # Ld YourObject
         # ArgsMemSet Text2 0x0001
    &#34;&#34;&#34;
    nb_parameters = int(numparams, 16)
    val = &#39;Set &#39; + self.opstack.pop() + &#39;!&#39; + var + &#39;(&#39;
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]

        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;) = &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.memldwith"><code class="name flex">
<span>def <span class="ident">memldwith</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a part of an object like .<prop>
example: with blah &lt;....&gt; .Name
gives:
# MemLdWith Name</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L852-L858" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def memldwith(self, var):
    &#34;&#34;&#34;
    command defining a part of an object like .&lt;prop&gt;
    example: with blah &lt;....&gt; .Name 
    gives:  # MemLdWith Name
    &#34;&#34;&#34;
    self.opstack.push(&#39;.&#39; + var)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.dictldwith"><code class="name flex">
<span>def <span class="ident">dictldwith</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>accessing an index in a with block
example: With <smth>.... Debug.Print !au_lname &hellip; end with
gives:
# Debug
# PrintObj
# DictLdWith au_lname
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L860-L870" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dictldwith(self, var):
    &#34;&#34;&#34;
    accessing an index in a with block
    example: With &lt;smth&gt;.... Debug.Print !au_lname ... end with
    gives:
         # Debug
         # PrintObj
         # DictLdWith au_lname
         # PrintItemNL
    &#34;&#34;&#34;
    self.opstack.push(&#39;!&#39; + var)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsmemldwith"><code class="name flex">
<span>def <span class="ident">argsmemldwith</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>example: .CodePane.SetSelection .ProcStartLine(sProc, ProcType) + lLine, 1, .ProcStartLine(sProc, ProcType) + lLine + 1, 1
gives:
# Ld sProc
# Ld ProcType
# ArgsMemLdWith ProcStartLine 0x0002
# Ld lLine
# Add
# LitDI2 0x0001
# Ld sProc
# Ld ProcType
# ArgsMemLdWith ProcStartLine 0x0002
# Ld lLine
# Add
# LitDI2 0x0001
# Add
# LitDI2 0x0001
# MemLdWith CodePane
# ArgsMemCall SetSelection 0x0004</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L872-L906" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsmemldwith(self, var, numparams):
    &#34;&#34;&#34;
    example: .CodePane.SetSelection .ProcStartLine(sProc, ProcType) + lLine, 1, .ProcStartLine(sProc, ProcType) + lLine + 1, 1
    gives:
         # Ld sProc
         # Ld ProcType
         # ArgsMemLdWith ProcStartLine 0x0002
         # Ld lLine
         # Add
         # LitDI2 0x0001
         # Ld sProc
         # Ld ProcType
         # ArgsMemLdWith ProcStartLine 0x0002
         # Ld lLine
         # Add
         # LitDI2 0x0001
         # Add
         # LitDI2 0x0001
         # MemLdWith CodePane
         # ArgsMemCall SetSelection 0x0004
    &#34;&#34;&#34;
    nb_parameters = int(numparams, 16)
    val = &#39;.&#39; + var + &#39;(&#39;
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]

        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsdictldwith"><code class="name flex">
<span>def <span class="ident">argsdictldwith</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when an index of an object with an argument is accessed with a with block
example: With myobj &hellip; Debug.Print !toto("titi") &hellip; end with
gives:
# Debug
# PrintObj
# LitStr 0x0004 "titi"
# ArgsDictLdWith toto 0x0001
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L909-L933" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsdictldwith(self, var, numparams):
    &#34;&#34;&#34;
    command used when an index of an object with an argument is accessed with a with block
    example: With myobj ... Debug.Print !toto(&#34;titi&#34;) ... end with
    gives:
         # Debug
         # PrintObj
         # LitStr 0x0004 &#34;titi&#34;
         # ArgsDictLdWith toto 0x0001
         # PrintItemNL
    &#34;&#34;&#34;
    nb_parameters = int(numparams, 16)
    val = &#39;!&#39; + var + &#39;(&#39;
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]

        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.memstwith"><code class="name flex">
<span>def <span class="ident">memstwith</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a part of an object like .<prop> = <smthg>
example: .Name = "Coho Vineyard"
gives:
# LitStr 0x000D "Coho Vineyard"
# MemStWith Name</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L936-L944" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def memstwith(self, var):
    &#34;&#34;&#34;
    command defining a part of an object like .&lt;prop&gt; = &lt;smthg&gt;
    example: .Name = &#34;Coho Vineyard&#34;
    gives:
         # LitStr 0x000D &#34;Coho Vineyard&#34;
         # MemStWith Name
    &#34;&#34;&#34;
    self.opstack.push(&#39;.&#39; + var + &#39; = &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.dictstwith"><code class="name flex">
<span>def <span class="ident">dictstwith</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a part of an object like !<index> = <smthg>
example: With &hellip; !Name = "Coho Vineyard" &hellip; end with
gives:
# LitStr 0x000D "Coho Vineyard"
# DictStWith Name</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L947-L955" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dictstwith(self, var):
    &#34;&#34;&#34;
    command defining a part of an object like !&lt;index&gt; = &lt;smthg&gt;
    example: With ... !Name = &#34;Coho Vineyard&#34; ... end with
    gives:
         # LitStr 0x000D &#34;Coho Vineyard&#34;
         # DictStWith Name
    &#34;&#34;&#34;
    self.opstack.push(&#39;!&#39; + var + &#39; = &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsmemstwith"><code class="name flex">
<span>def <span class="ident">argsmemstwith</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a property of an object with arguments in a with statement
example: With &hellip; .Name(1,2) = b &hellip; end with
gives:
# Ld B
# LitDI2 0x0001
# LitDI2 0x0002
# ArgsMemStWith Name 0x0002</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L958-L981" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsmemstwith(self, var, numparams):
    &#34;&#34;&#34;
    command defining a property of an object with arguments in a with statement
    example: With ... .Name(1,2) = b ... end with
    gives:
         # Ld B
         # LitDI2 0x0001
         # LitDI2 0x0002
         # ArgsMemStWith Name 0x0002
    &#34;&#34;&#34;
    nb_parameters = int(numparams, 16)
    val = &#39;.&#39; + var + &#39;(&#39;
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]

        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;) = &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsdictstwith"><code class="name flex">
<span>def <span class="ident">argsdictstwith</span></span>(<span>self, var, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a part of an object like !<index> = <smthg> in a with block
example: !Name = "Coho Vineyard"
gives:
# LitStr 0x000D "Coho Vineyard"
# DictStWith Name</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L983-L991" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsdictstwith(self, var, *args):
    &#34;&#34;&#34;
    command defining a part of an object like !&lt;index&gt; = &lt;smthg&gt; in a with block
    example: !Name = &#34;Coho Vineyard&#34;
    gives:
         # LitStr 0x000D &#34;Coho Vineyard&#34;
         # DictStWith Name
    &#34;&#34;&#34;
    self.opstack.push(&#39;!&#39; + var + &#39; = &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.memsetwith"><code class="name flex">
<span>def <span class="ident">memsetwith</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a set on an index of an object in a with block
example: with <smth> &hellip; Set .Name = "Coho Vineyard"
gives:
# SetStmt
# LitStr 0x000D "Coho Vineyard"
# memSetWith Name</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L994-L1003" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def memsetwith(self, var):
    &#34;&#34;&#34;
    command defining a set on an index of an object in a with block
    example: with &lt;smth&gt; ... Set .Name = &#34;Coho Vineyard&#34;
    gives:
         # SetStmt
         # LitStr 0x000D &#34;Coho Vineyard&#34;
         # memSetWith Name
    &#34;&#34;&#34;
    self.opstack.push(&#39;Set .&#39; + var + &#39; = &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.dictsetwith"><code class="name flex">
<span>def <span class="ident">dictsetwith</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a set on an index of an object in a with block
example: with <smth> &hellip; Set !Name = "Coho Vineyard"
gives:
# SetStmt
# LitStr 0x000D "Coho Vineyard"
# DictSetWith Name</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1006-L1015" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dictsetwith(self, var):
    &#34;&#34;&#34;
    command defining a set on an index of an object in a with block
    example: with &lt;smth&gt; ... Set !Name = &#34;Coho Vineyard&#34;
    gives:
         # SetStmt
         # LitStr 0x000D &#34;Coho Vineyard&#34;
         # DictSetWith Name
    &#34;&#34;&#34;
    self.opstack.push(&#39;Set !&#39; + var + &#39; = &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsmemsetwith"><code class="name flex">
<span>def <span class="ident">argsmemsetwith</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a set on an index with an argument of an object in a with block
example: with <smth> &hellip; Set .nini("gg", "ff", "uu") = "toto"
gives:
# SetStmt
# LitStr 0x0004 "toto"
# LitStr 0x0002 "gg"
# LitStr 0x0002 "ff"
# LitStr 0x0002 "uu"
# ArgsMemSetWith nini 0x0003</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1017-L1042" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsmemsetwith(self, var, numparams):
    &#34;&#34;&#34;
    command defining a set on an index with an argument of an object in a with block
    example: with &lt;smth&gt; ... Set .nini(&#34;gg&#34;, &#34;ff&#34;, &#34;uu&#34;) = &#34;toto&#34;
    gives:
         # SetStmt
         # LitStr 0x0004 &#34;toto&#34;
         # LitStr 0x0002 &#34;gg&#34;
         # LitStr 0x0002 &#34;ff&#34;
         # LitStr 0x0002 &#34;uu&#34;
         # ArgsMemSetWith nini 0x0003
    &#34;&#34;&#34;
    nb_parameters = int(numparams, 16)
    val = &#39;Set !&#39; + var + &#39;(&#39;
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]

        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;) = &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsdictsetwith"><code class="name flex">
<span>def <span class="ident">argsdictsetwith</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a set on an index with an argument of an object in a with block
example: with <smth> &hellip; Set !nini("gg", "ff", "uu") = "toto"
gives:
# SetStmt
# LitStr 0x0004 "toto"
# LitStr 0x0002 "gg"
# LitStr 0x0002 "ff"
# LitStr 0x0002 "uu"
# ArgsDictSetWith nini 0x0003</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1044-L1069" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsdictsetwith(self, var, numparams):
    &#34;&#34;&#34;
    command defining a set on an index with an argument of an object in a with block
    example: with &lt;smth&gt; ... Set !nini(&#34;gg&#34;, &#34;ff&#34;, &#34;uu&#34;) = &#34;toto&#34;
    gives:
         # SetStmt
         # LitStr 0x0004 &#34;toto&#34;
         # LitStr 0x0002 &#34;gg&#34;
         # LitStr 0x0002 &#34;ff&#34;
         # LitStr 0x0002 &#34;uu&#34;
         # ArgsDictSetWith nini 0x0003
    &#34;&#34;&#34;
    nb_parameters = int(numparams, 16)
    val = &#39;Set !&#39; + var + &#39;(&#39;
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]

        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;) = &#39; + self.opstack.pop()
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argscall"><code class="name flex">
<span>def <span class="ident">argscall</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1072-L1099" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argscall(self, *args):

    if args[0] == &#39;(Call)&#39;:
        nb_parameters = int(args[2],16)
        val = &#39;Call &#39; + args[1] + &#39;(&#39;
        end_val = &#39;)&#39;
    else:
        val = args[0]
        nb_parameters = int(args[1],16)           
        end_val = &#39;&#39;
        
    params = []
    #print &#39;func:&#39; + funcname
    #print &#39;nbparameters : &#39; + str(nb_parameters)
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        if ((params[0].startswith(&#39;(&#39;)) or (args[0] == &#39;(Call)&#39;)):               
            val = val + params[0]
        else:
            val = val + &#39; &#39; + params[0]

        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
        val += end_val
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsmemcall"><code class="name flex">
<span>def <span class="ident">argsmemcall</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command to call a function of an object
example: a43g0xT.run ayUBnLK01, 0
gives :
# Ld ayUBnLK01
# LitDI2 0x0000
# Ld a43g0xT
# ArgsMemCall run 0x0002</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1101-L1142" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsmemcall(self, *args):
    &#34;&#34;&#34;
    command to call a function of an object
    example: a43g0xT.run ayUBnLK01, 0
    gives : 
       # Ld ayUBnLK01
       # LitDI2 0x0000
       # Ld a43g0xT
       # ArgsMemCall run 0x0002
    &#34;&#34;&#34;
    args = list(args)
    parenthesis = False
    if args[0] == &#39;(Call)&#39;:
        args.pop(0)
        val = &#39;Call &#39; + self.opstack.pop() + &#39;.&#39; + args[0] + &#39;(&#39;
        parenthesis = True
    else:
        val = self.opstack.pop() + &#39;.&#39; + args[0]

    nb_parameters = int(args[1],16)           
    end_val = &#39;&#39;
        
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        if params[0].startswith(&#39;(&#39;):               
            val = val + params[0]
            end_val = &#39;)&#39;
        else:
            if not parenthesis:
                val = val + &#39; &#39; +params[0]
            else:
                val = val + params[0]
        
        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    if parenthesis == True:
        end_val = &#39;)&#39;
    self.opstack.push(val + end_val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsmemcallwith"><code class="name flex">
<span>def <span class="ident">argsmemcallwith</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command when a function of an object is called in a with definition
example: With a &hellip; call .a(1,2) &hellip; end with
gives:
# LitDI2 0x0001
# LitDI2 0x0002
# ArgsMemCallWith (Call) a 0x0002</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1144-L1185" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsmemcallwith(self, *args):
    &#34;&#34;&#34;
    command when a function of an object is called in a with definition
    example: With a ... call .a(1,2) ... end with
    gives: 
         # LitDI2 0x0001
         # LitDI2 0x0002
         # ArgsMemCallWith (Call) a 0x0002
    &#34;&#34;&#34;
    parenthesis = False
    args = list(args)
    if args[0] == &#39;(Call)&#39;:
        args.pop(0)
        parenthesis = True
        val = &#39;Call .&#39; + args[0] + &#39;(&#39;
    else:
        val = &#39;.&#39; + args[0]
        
    nb_parameters = int(args[1],16)           
    end_val = &#39;&#39;
        
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        if params[0].startswith(&#39;(&#39;):               
            val = val + params[0]
            end_val = &#39;)&#39;
        else:
            if not parenthesis:
                val = val + &#39; &#39; + params[0]
            else:
                val = val + params[0]
        
        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param

    if parenthesis:
        end_val = &#39;)&#39;
    self.opstack.push(val + end_val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsarray"><code class="name flex">
<span>def <span class="ident">argsarray</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1188-L1202" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsarray(self, var, numparams):
    val = var + &#39;(&#39;
    nb_parameters = int(numparams,16)
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]
        
        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.assert_"><code class="name flex">
<span>def <span class="ident">assert_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command for debug.asser
example: Debug.Assert blnAssert
gives :
# Ld blnAssert
# Assert</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1204-L1212" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def assert_(self):
    &#34;&#34;&#34;
    command for debug.asser
    example: Debug.Assert blnAssert
    gives : 
          # Ld blnAssert
          # Assert
    &#34;&#34;&#34;
    self.opstack.push(&#39;Debug.Assert &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.bos"><code class="name flex">
<span>def <span class="ident">bos</span></span>(<span>self, valarg)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1214-L1219" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def bos(self, valarg):
    arg = int(valarg,16)
    if arg == 0:
        val = self.opstack.pop() + &#39;:&#39;
    self.opstack.push(val)
    self.has_bos = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.bosimplicit"><code class="name flex">
<span>def <span class="ident">bosimplicit</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>appears useless, but in this case we still need to print whole stack
example: If Mid$(theString, i, 1) &lt;&gt; Chr$(0) Then Exit For
gives:
# Ld theString
# Ld i
# LitDI2 0x0001
# ArgsLd Mid$ 0x0003
# LitDI2 0x0000
# ArgsLd Chr$ 0x0001
# Ne
# If
# BoSImplicit
# ExitFor
# EndIf</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1221-L1238" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def bosimplicit(self, *args):
    &#34;&#34;&#34;
    appears useless, but in this case we still need to print whole stack
    example: If Mid$(theString, i, 1) &lt;&gt; Chr$(0) Then Exit For
    gives:
         # Ld theString
         # Ld i
         # LitDI2 0x0001
         # ArgsLd Mid$ 0x0003
         # LitDI2 0x0000
         # ArgsLd Chr$ 0x0001
         # Ne
         # If
         # BoSImplicit
         # ExitFor
         # EndIf
    &#34;&#34;&#34;
    self.has_bos = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.bol"><code class="name flex">
<span>def <span class="ident">bol</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1240-L1241" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def bol(self, *args):
    raise Pcode2codeException(&#39;not implemented bol&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.ldaddressof"><code class="name flex">
<span>def <span class="ident">ldaddressof</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command for AddressOf keyword
example: EnumFontFamilies hDC, vbNullString, AddressOf EnumFontFamProc, LB
gives:
# Ld hDC
# Ld vbNullString
# LdAddressOf EnumFontFamProc
# Ld LB
# ArgsCall EnumFontFamilies 0x0004</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1243-L1254" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def ldaddressof(self, var):
    &#34;&#34;&#34;
    command for AddressOf keyword
    example: EnumFontFamilies hDC, vbNullString, AddressOf EnumFontFamProc, LB
    gives:
         # Ld hDC
         # Ld vbNullString
         # LdAddressOf EnumFontFamProc
         # Ld LB
         # ArgsCall EnumFontFamilies 0x0004
    &#34;&#34;&#34;
    self.opstack.push(&#39;AddressOf &#39; + var)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.memaddressof"><code class="name flex">
<span>def <span class="ident">memaddressof</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command for AddressOf keyword on a property of an object
example: MsgBox AddressOf myobj.toto
gives:
# Ld myobj
# MemAddressOf toto
# ArgsCall MsgBox 0x0001</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1256-L1265" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def memaddressof(self, var):
    &#34;&#34;&#34;
    command for AddressOf keyword on a property of an object
    example: MsgBox AddressOf myobj.toto
    gives:
         # Ld myobj
         # MemAddressOf toto
         # ArgsCall MsgBox 0x0001
    &#34;&#34;&#34;
    self.opstack.push(&#39;AddressOf &#39; + self.opstack.pop() + &#39;.&#39; + var)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.case"><code class="name flex">
<span>def <span class="ident">case</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling choice in select case where choice is one value
example: Case 0
gives:
# LitDI2 0x0000
# Case
# CaseDone</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1267-L1277" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def case(self):
    &#34;&#34;&#34;
    command handling choice in select case where choice is one value 
    example: Case 0
    gives:
         # LitDI2 0x0000
         # Case
         # CaseDone

    &#34;&#34;&#34;
    self.opstack.push(&#39;Case &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.caseto"><code class="name flex">
<span>def <span class="ident">caseto</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling choice in select case where choice is from one value to one other value
example: Case 0 To 30
gives:
# LitDI2 0x0000
# LitDI2 0x001E
# CaseTo
# CaseDone</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1279-L1290" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def caseto(self):
    &#34;&#34;&#34;
    command handling choice in select case where choice is from one value to one other value
    example: Case 0 To 30
    gives:
         # LitDI2 0x0000
         # LitDI2 0x001E
         # CaseTo
         # CaseDone
    &#34;&#34;&#34;
    val = self.opstack.pop()
    self.opstack.push(&#39;Case &#39; + self.opstack.pop() + &#39; To &#39; + val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.casegt"><code class="name flex">
<span>def <span class="ident">casegt</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling choice in select case where choice is lower than a value
example: Case Is &gt; 100
gives:
# LitDI2 0x0064
# CaseGt
# CaseDone</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1293-L1302" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def casegt(self):
    &#34;&#34;&#34;
    command handling choice in select case where choice is lower than a value
    example: Case Is &gt; 100
    gives:
         # LitDI2 0x0064
         # CaseGt
         # CaseDone
    &#34;&#34;&#34;
    self.opstack.push(&#39;Case Is &gt; &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.caselt"><code class="name flex">
<span>def <span class="ident">caselt</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling choice in select case where choice is lower than a value
example: Case Is &lt; 0
gives:
# LitDI2 0x0002
# CaseLt
# CaseDone</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1304-L1313" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def caselt(self):
    &#34;&#34;&#34;
    command handling choice in select case where choice is lower than a value
    example: Case Is &lt; 0
    gives:
         # LitDI2 0x0002
         # CaseLt
         # CaseDone
    &#34;&#34;&#34;
    self.opstack.push(&#39;Case Is &lt; &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.casege"><code class="name flex">
<span>def <span class="ident">casege</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling choice in select case where choice is greater or equal than a value
example: TODO: to check
gives:</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1315-L1321" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def casege(self):
    &#34;&#34;&#34;
    command handling choice in select case where choice is greater or equal than a value
    example: TODO: to check
    gives:
    &#34;&#34;&#34;
    self.opstack.push(&#39;Case Is &gt;= &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.casele"><code class="name flex">
<span>def <span class="ident">casele</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling choice in select case where choice is lower or equal than a value
example: TODO: to check
gives:</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1323-L1329" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def casele(self):
    &#34;&#34;&#34;
    command handling choice in select case where choice is lower or equal than a value
    example: TODO: to check
    gives:
    &#34;&#34;&#34;
    self.opstack.push(&#39;Case Is &lt;= &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.casene"><code class="name flex">
<span>def <span class="ident">casene</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling choice in select case where choice is different to a value
example: TODO: to check
gives:</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1331-L1337" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def casene(self):
    &#34;&#34;&#34;
    command handling choice in select case where choice is different to a value
    example: TODO: to check
    gives:
    &#34;&#34;&#34;
    self.opstack.push(&#39;Case Is &lt;&gt; &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.caseeq"><code class="name flex">
<span>def <span class="ident">caseeq</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling choice in select case where choice is equal to a value
example: TODO: to check
gives:</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1339-L1345" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def caseeq(self):
    &#34;&#34;&#34;
    command handling choice in select case where choice is equal to a value
    example: TODO: to check
    gives:
    &#34;&#34;&#34;
    self.opstack.push(&#39;Case Is = &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.caseelse"><code class="name flex">
<span>def <span class="ident">caseelse</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a "Case Else" stmt
example: Case Else
gives:
# CaseElse</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1347-L1354" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def caseelse(self):
    &#34;&#34;&#34;
    command defining a &#34;Case Else&#34; stmt
    example: Case Else
    gives: 
         # CaseElse
    &#34;&#34;&#34;
    self.opstack.push(&#39;Case Else&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.casedone"><code class="name flex">
<span>def <span class="ident">casedone</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1356-L1358" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def casedone(self):
    #pass on purpose, please see previous examples
    pass</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.circle"><code class="name flex">
<span>def <span class="ident">circle</span></span>(<span>self, useless)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when the circle method of an object is called
example: Me.Circle (sngHCtr, sngVCtr), sngRadius
gives:
# Ld sngHCtr
# Ld sngVCtr
# Ld sngRadius
# LitDI2 0x0000
# LitDI2 0x0000
# LitDI2 0x0000
# LitDI2 0x0000
# Ld id_FFFF
# Circle 0x001E</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1360-L1396" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def circle(self, useless):
    &#34;&#34;&#34;
    command used when the circle method of an object is called
    example: Me.Circle (sngHCtr, sngVCtr), sngRadius
    gives:
         # Ld sngHCtr
         # Ld sngVCtr
         # Ld sngRadius
         # LitDI2 0x0000
         # LitDI2 0x0000
         # LitDI2 0x0000
         # LitDI2 0x0000
         # Ld id_FFFF
         # Circle 0x001E
    &#34;&#34;&#34;
    val = self.opstack.pop() + &#39;.Circle (&#39;
    params = []
    for i in range(7):
        params.append(self.opstack.pop())
    params = params[::-1]

    val += params[0] + &#39;, &#39; + params[1] + &#39;), &#39; + params[2]
    all_empty = True
    for param in params[3:]:
        if param != &#39;0&#39;:
            all_empty = False

    if all_empty:
        self.opstack.push(val)
    else:
        for param in params[3:]:
            if param == &#39;0&#39;:
                val = val + &#39;, &lt;tbr&gt;&#39;
            else:
                val = val + &#39;, &#39; + param
        val = val.replace(&#39;, &lt;tbr&gt;&#39; , &#39;&#39;)
        self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.close"><code class="name flex">
<span>def <span class="ident">close</span></span>(<span>self, numparams)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1399-L1412" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def close(self, numparams):
    val = &#39;Close &#39;
    nb_parameters = int(numparams,16)
    params = []
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]
        
        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.closeall"><code class="name flex">
<span>def <span class="ident">closeall</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when close is called with no arguments, effectively closing all files
example: Close
gives: # CloseAll</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1414-L1420" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def closeall(self):
    &#34;&#34;&#34;
    command used when close is called with no arguments, effectively closing all files
    example: Close
    gives: # CloseAll
    &#34;&#34;&#34;
    self.opstack.push(&#39;Close&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.coerce_"><code class="name flex">
<span>def <span class="ident">coerce_</span></span>(<span>self, arg)</span>
</code></dt>
<dd>
<section class="desc"><p>command used for variable conversion
example1: MyLong2 = CLng(MyVal2)
gives:
# Ld MyVal2
# Coerce (Lng)
# St MyLong2
example2: MyInt = CInt(MyDouble)
gives:
# Ld MyDouble
# Coerce (Int)
# St MyInt</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1422-L1457" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def coerce_(self, arg):
    &#34;&#34;&#34;
    command used for variable conversion
    example1: MyLong2 = CLng(MyVal2)
    gives:
         # Ld MyVal2
         # Coerce (Lng)
         # St MyLong2
    example2: MyInt = CInt(MyDouble)
    gives:
         # Ld MyDouble
         # Coerce (Int)
         # St MyInt
    &#34;&#34;&#34;
    if arg == &#39;(Str)&#39;:
        self.opstack.push(&#39;CStr(&#39; + self.opstack.pop() + &#39;)&#39;)
    elif arg == &#39;(Var)&#39;:
        self.opstack.push(&#39;CVar(&#39; + self.opstack.pop() + &#39;)&#39;)
    elif arg == &#39;(Sng)&#39;:
        self.opstack.push(&#39;CSng(&#39; + self.opstack.pop() + &#39;)&#39;)
    elif arg == &#39;(Lng)&#39;:
        self.opstack.push(&#39;CLng(&#39; + self.opstack.pop() + &#39;)&#39;)
    elif arg == &#39;(Int)&#39;:
        self.opstack.push(&#39;CInt(&#39; + self.opstack.pop() + &#39;)&#39;)
    elif arg == &#39;(Dbl)&#39;:
        self.opstack.push(&#39;CDbl(&#39; + self.opstack.pop() + &#39;)&#39;)
    elif arg == &#39;(Date)&#39;:
        self.opstack.push(&#39;CDate(&#39; + self.opstack.pop() + &#39;)&#39;)
    elif arg == &#39;(Cur)&#39;:
        self.opstack.push(&#39;CCur(&#39; + self.opstack.pop() + &#39;)&#39;)
    elif arg == &#39;(Byte)&#39;:
        self.opstack.push(&#39;CByte(&#39; + self.opstack.pop() + &#39;)&#39;)
    elif arg == &#39;(Bool)&#39;:
        self.opstack.push(&#39;CBool(&#39; + self.opstack.pop() + &#39;)&#39;)
    else:
        raise Pcode2codeException(&#39;not implemented coerce&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.coercevar"><code class="name flex">
<span>def <span class="ident">coercevar</span></span>(<span>self, arg)</span>
</code></dt>
<dd>
<section class="desc"><p>example1: MyError = CVErr(32767)
gives: # CoerceVar (Err)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1459-L1467" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def coercevar(self, arg):
    &#34;&#34;&#34;
    example1: MyError = CVErr(32767)
    gives: # CoerceVar (Err)
    &#34;&#34;&#34;
    if arg == &#39;(Err)&#39;:
        self.opstack.push(&#39;CVErr(&#39; + self.opstack.pop() + &#39;)&#39;)
    else:
        raise Pcode2codeException(&#39;not implemented coercevar&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.context"><code class="name flex">
<span>def <span class="ident">context</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1469-L1470" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def context(self, *args):
    raise Pcode2codeException(&#39;not implemented context&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.debug"><code class="name flex">
<span>def <span class="ident">debug</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>seems used to invoke debug object
example: Debug.Print MyVar
gives:
# Debug
# PrintObj
# Ld MyVar
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1472-L1482" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def debug(self):
    &#34;&#34;&#34;
    seems used to invoke debug object
    example: Debug.Print MyVar
    gives:
         # Debug
         # PrintObj
         # Ld MyVar
         # PrintItemNL
    &#34;&#34;&#34;
    self.opstack.push(&#39;Debug&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.deftype"><code class="name flex">
<span>def <span class="ident">deftype</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when def<type> is used.
TODO: bytes to know ranges appear random. How to do it?</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1484-L1489" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def deftype(self, *args):
    &#34;&#34;&#34;
    command used when def&lt;type&gt; is used.
    TODO: bytes to know ranges appear random. How to do it?
    &#34;&#34;&#34;
    raise Pcode2codeException(&#39;not implemented deftype&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.dim"><code class="name flex">
<span>def <span class="ident">dim</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1509-L1519" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dim(self, *args):
    # args is a tuple, we treat it only when its not empty
    # example of args : (As String), (As Long)...
    if args != ():
        val = args[0]
        for arg in args[1:]:
            val += &#39; &#39; + arg
        val = val[1:-1]
    else:
        val = &#39;Dim&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.dimimplicit"><code class="name flex">
<span>def <span class="ident">dimimplicit</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1521-L1522" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dimimplicit(self):
    self.opstack.push(&#39;DimImplicit&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.do"><code class="name flex">
<span>def <span class="ident">do</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling "Do" keyword
example: Do (we have then the loop and so on)
gives:
# Do</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1524-L1532" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def do(self):
    &#34;&#34;&#34;
    command handling &#34;Do&#34; keyword
    example: Do (we have then the loop and so on)
    gives:
         # Do
    &#34;&#34;&#34;
    self.opstack.push(&#39;Do&#39;)
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.doevents"><code class="name flex">
<span>def <span class="ident">doevents</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1534-L1535" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def doevents(self, *args):
    raise Pcode2codeException(&#39;not implemented doevents&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.dounitil"><code class="name flex">
<span>def <span class="ident">dounitil</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling "do until" definitions
example: Do Until Response = "youpi"
gives:
# Ld Response
# ListStr 0x0005 "youpi"
# Eq
# DoUnitil</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1537-L1548" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dounitil(self):
    &#34;&#34;&#34;
    command handling &#34;do until&#34; definitions
    example: Do Until Response = &#34;youpi&#34;
    gives:
         # Ld Response
         # ListStr 0x0005 &#34;youpi&#34;
         # Eq
         # DoUnitil
    &#34;&#34;&#34;
    self.opstack.push(&#39;Do Until &#39; + self.opstack.pop())
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.dowhile"><code class="name flex">
<span>def <span class="ident">dowhile</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling "do while" definitions
example: Do While Reponse &lt;&gt; "youpi"
gives:
# Ld Response
# LitStr 0x0005 "youpi"
# Ne
# DoWhile</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1550-L1561" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def dowhile(self):
    &#34;&#34;&#34;
    command handling &#34;do while&#34; definitions
    example: Do While Reponse &lt;&gt; &#34;youpi&#34;
    gives:
         # Ld Response
         # LitStr 0x0005 &#34;youpi&#34;
         # Ne
         # DoWhile
    &#34;&#34;&#34;
    self.opstack.push(&#39;Do While &#39; + self.opstack.pop())
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.else_"><code class="name flex">
<span>def <span class="ident">else_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used for a "else" in a if oneliner
example: If X &lt; 4 Then MsgBox "hi" Else MsgBox "ho"
gives:
# Ld X
# LitDI2 0x0004
# Lt
# If
# BoSImplicit
# LitStr 0x0002 "hi"
# ArgsCall MsgBox 0x0001
# Else
# BoSImplicit
# LitStr 0x0002 "Ho"
# ArgsCall MsgBox 0x0001
# EndIf</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1563-L1581" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def else_(self):
    &#34;&#34;&#34;
    command used for a &#34;else&#34; in a if oneliner
    example: If X &lt; 4 Then MsgBox &#34;hi&#34; Else MsgBox &#34;ho&#34;
    gives:
         # Ld X
         # LitDI2 0x0004
         # Lt
         # If
         # BoSImplicit
         # LitStr 0x0002 &#34;hi&#34;
         # ArgsCall MsgBox 0x0001
         # Else
         # BoSImplicit
         # LitStr 0x0002 &#34;Ho&#34;
         # ArgsCall MsgBox 0x0001
         # EndIf
    &#34;&#34;&#34;
    self.opstack.push(&#39;Else&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.elseblock"><code class="name flex">
<span>def <span class="ident">elseblock</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a new "else" for a block
example: Else
gives: #Else</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1583-L1591" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def elseblock(self):
    &#34;&#34;&#34;
    command defining a new &#34;else&#34; for a block
    example: Else
    gives: #Else
    &#34;&#34;&#34;
    self.opstack.push(&#39;Else&#39;)
    self.indentlevel = self.indentlevel - 1
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.elseifblock"><code class="name flex">
<span>def <span class="ident">elseifblock</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a new "else if" block
example: ElseIf dayW = DayOfWeek.Thursday Then
gives:
# Ld dayW
# Ld DayOfWeek
# MemLd Thursday
# Eq
# ElseIfBlock</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1593-L1606" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def elseifblock(self):
    &#34;&#34;&#34;
    command defining a new &#34;else if&#34; block
    example: ElseIf dayW = DayOfWeek.Thursday Then
    gives:
         # Ld dayW
         # Ld DayOfWeek
         # MemLd Thursday
         # Eq
         # ElseIfBlock
    &#34;&#34;&#34;
    self.opstack.push(&#39;ElseIf &#39; + self.opstack.pop() + &#39; Then&#39;)
    self.indentlevel = self.indentlevel - 1
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.elseiftypeblock"><code class="name flex">
<span>def <span class="ident">elseiftypeblock</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1608-L1609" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def elseiftypeblock(self, *args):
    raise Pcode2codeException(&#39;not implemented elseiftypeblock&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.end"><code class="name flex">
<span>def <span class="ident">end</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1611-L1612" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def end(self):
    self.opstack.push(&#39;End&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endcontext"><code class="name flex">
<span>def <span class="ident">endcontext</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1614-L1615" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endcontext(self, *args):
    raise Pcode2codeException(&#39;not implemented endcontext&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endfunc"><code class="name flex">
<span>def <span class="ident">endfunc</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1617-L1619" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endfunc(self):
    self.opstack.push(&#39;End Function&#39;)
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endif"><code class="name flex">
<span>def <span class="ident">endif</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1621-L1626" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endif(self):
    if self.onelineif == True:
        self.onelineif = False
    else:
        self.opstack.push(&#39;End If&#39;)
        self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endifblock"><code class="name flex">
<span>def <span class="ident">endifblock</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1628-L1630" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endifblock(self):
    self.opstack.push(&#39;End If&#39;)
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endimmediate"><code class="name flex">
<span>def <span class="ident">endimmediate</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1632-L1633" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endimmediate(self, *args):
    raise Pcode2codeException(&#39;not implemented endimmediate&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endprop"><code class="name flex">
<span>def <span class="ident">endprop</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling the end of a property
example: End Property
gives:
#EndProp</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1635-L1643" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endprop(self):
    &#34;&#34;&#34;
    command handling the end of a property
    example: End Property
    gives: 
         #EndProp
    &#34;&#34;&#34;
    self.opstack.push(&#39;End Property&#39;)
    self.indentlevel = self.indentlevel -1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endselect"><code class="name flex">
<span>def <span class="ident">endselect</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a stmt of "End Select", closing a select case.
example: End Select
gives:
# EndSelect</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1645-L1653" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endselect(self):
    &#34;&#34;&#34;
    command defining a stmt of &#34;End Select&#34;, closing a select case.
    example: End Select
    gives: 
         # EndSelect
    &#34;&#34;&#34;
    self.opstack.push(&#39;End Select&#39;)
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endsub"><code class="name flex">
<span>def <span class="ident">endsub</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1655-L1657" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endsub(self):
    self.opstack.push(&#39;End Sub&#39;)
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endtype"><code class="name flex">
<span>def <span class="ident">endtype</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command to end a new type definition
example: End Type
gives:
#EndType</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1659-L1667" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endtype(self):
    &#34;&#34;&#34;
    command to end a new type definition
    example: End Type
    gives:
         #EndType
    &#34;&#34;&#34;
    self.opstack.push(&#39;End Type&#39;)
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endwith"><code class="name flex">
<span>def <span class="ident">endwith</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command to end a new with definition
example: End With
gives: #EndWith</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1669-L1676" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endwith(self):
    &#34;&#34;&#34;
    command to end a new with definition
    example: End With
    gives: #EndWith
    &#34;&#34;&#34;
    self.opstack.push(&#39;End With&#39;)
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.erase"><code class="name flex">
<span>def <span class="ident">erase</span></span>(<span>self, nb_params)</span>
</code></dt>
<dd>
<section class="desc"><p>command for Erase function keyword
example: Erase threeDimArray, twoDimArray
gives:
# Ld threeDimArray
# Ld twoDimArray
# Erase 0x0002</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1679-L1700" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def erase(self, nb_params):
    &#34;&#34;&#34;
    command for Erase function keyword
    example: Erase threeDimArray, twoDimArray
    gives:
         # Ld threeDimArray
         # Ld twoDimArray
         # Erase 0x0002
    &#34;&#34;&#34;
    nb_args = int(nb_params, 16)
    val = &#39;&#39;
    params = []
    for i in range(nb_args):
        params.append(self.opstack.pop())
        params = params[::-1]
    val = params[0]
        
    if nb_args &gt; 1:
        for param in params[1:]:
            val = val + &#39;, &#39; + param

    self.opstack.push(&#39;Erase &#39; + val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.error"><code class="name flex">
<span>def <span class="ident">error</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used for Error keyword
example: Error 11
gives:
# LitDI2 0x000B
# Error</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1703-L1711" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def error(self):
    &#34;&#34;&#34;
    command used for Error keyword
    example: Error 11
    gives:
         # LitDI2 0x000B
         # Error
    &#34;&#34;&#34;
    self.opstack.push(&#39;Error &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.eventdecl"><code class="name flex">
<span>def <span class="ident">eventdecl</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command for declaring a new event in VBA
example: Event LogonCompleted(UserName As String)
gives :
# EventDecl (Sub LogonCompleted(UserName As String))</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1713-L1723" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def eventdecl(self, *args):
    &#34;&#34;&#34;
    command for declaring a new event in VBA
    example: Event LogonCompleted(UserName As String)
    gives : 
       # EventDecl (Sub LogonCompleted(UserName As String))
    &#34;&#34;&#34;
    val = args[1]
    for arg in args[2:-1]: #strip parenthesis
        val += &#39; &#39; + arg
    self.opstack.push(&#39;Event &#39; + val + &#39; &#39; + args[-1][:-1])</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.raiseevent"><code class="name flex">
<span>def <span class="ident">raiseevent</span></span>(<span>self, evt_name, nb_params)</span>
</code></dt>
<dd>
<section class="desc"><p>command when RaiseEvent is used
example: RaiseEvent LogonCompleted("AntoineJean")
gives:
# LitStr 0x000A "AntoineJan"
# RaiseEvent LogonCompleted 0x0001</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1725-L1747" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def raiseevent(self, evt_name, nb_params):
    &#34;&#34;&#34;
    command when RaiseEvent is used
    example: RaiseEvent LogonCompleted(&#34;AntoineJean&#34;)
    gives:
         # LitStr 0x000A &#34;AntoineJan&#34;
         # RaiseEvent LogonCompleted 0x0001
    &#34;&#34;&#34;
    nb_args = int(nb_params, 16)
    val = &#39;&#39;
    params = []
    if nb_args &gt; 0:
        for i in range(nb_args):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = &#39;(&#39;+ params[0]
        
        if nb_args &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
        val += &#39;)&#39;
                
    self.opstack.push(&#39;RaiseEvent &#39; + evt_name + val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsmemraiseevent"><code class="name flex">
<span>def <span class="ident">argsmemraiseevent</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a raiseevent is called on a property of an object
example: RaiseEvent myobj.LogonCompleted("AntoineJan")
gives:
# LitStr 0x000A "AntoineJan"
# Ld myobj
# ArgsMemRaiseEvent LogonCompleted 0x0001</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1750-L1772" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsmemraiseevent(self, var, numparams):
    &#34;&#34;&#34;
    command used when a raiseevent is called on a property of an object
    example: RaiseEvent myobj.LogonCompleted(&#34;AntoineJan&#34;)
    gives:
         # LitStr 0x000A &#34;AntoineJan&#34;
         # Ld myobj
         # ArgsMemRaiseEvent LogonCompleted 0x0001
    &#34;&#34;&#34;
    nb_args = int(numparams, 16)
    val = &#39;RaiseEvent &#39; + self.opstack.pop() + &#39;.&#39; + var + &#39;(&#39;
    params = []
    if nb_args &gt; 0:
        for i in range(nb_args):
            params.append(self.opstack.pop())
        params = params[::-1]
        val += params[0]
        
        if nb_args &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
        val += &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.argsmemraiseeventwith"><code class="name flex">
<span>def <span class="ident">argsmemraiseeventwith</span></span>(<span>self, var, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a raiseevent is called on a property of an object within a with block
example: with myobj &hellip; RaiseEvent .LogonCompleted("AntoineJan") &hellip; end with
gives:
# LitStr 0x000A "AntoineJan"
# ArgsMemRaiseEventWith LogonCompleted 0x0001</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1774-L1795" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def argsmemraiseeventwith(self, var, numparams):
    &#34;&#34;&#34;
    command used when a raiseevent is called on a property of an object within a with block
    example: with myobj ... RaiseEvent .LogonCompleted(&#34;AntoineJan&#34;) ... end with
    gives:
         # LitStr 0x000A &#34;AntoineJan&#34;
         # ArgsMemRaiseEventWith LogonCompleted 0x0001
    &#34;&#34;&#34;
    nb_args = int(numparams, 16)
    val = &#39;RaiseEvent .&#39; + var + &#39;(&#39;
    params = []
    if nb_args &gt; 0:
        for i in range(nb_args):
            params.append(self.opstack.pop())
        params = params[::-1]
        val += params[0]
        
        if nb_args &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
        val += &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.exitdo"><code class="name flex">
<span>def <span class="ident">exitdo</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1797-L1799" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def exitdo(self):
    #TODO: comment
    self.opstack.push(&#39;Exit Do&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.exitfor"><code class="name flex">
<span>def <span class="ident">exitfor</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1801-L1803" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def exitfor(self):
    #TODO: comment
    self.opstack.push(&#39;Exit For&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.exitfunc"><code class="name flex">
<span>def <span class="ident">exitfunc</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1805-L1807" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def exitfunc(self):
    #TODO: comment
    self.opstack.push(&#39;Exit Function&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.exitprop"><code class="name flex">
<span>def <span class="ident">exitprop</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1809-L1811" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def exitprop(self):
    #TODO: comment
    self.opstack.push(&#39;Exit Property&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.exitsub"><code class="name flex">
<span>def <span class="ident">exitsub</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1813-L1815" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def exitsub(self):
    #TODO: comment
    self.opstack.push(&#39;Exit Sub&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fncurdir"><code class="name flex">
<span>def <span class="ident">fncurdir</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1817-L1820" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fncurdir(self, *args):
    #val = &#39;CurDir(&#39; + self.opstack.pop() + &#39;)&#39;
    #self.opstack.push(val)
    raise Pcode2codeException(&#39;not implemented fncurdir&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fndir"><code class="name flex">
<span>def <span class="ident">fndir</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1822-L1823" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fndir(self, *args):
    raise Pcode2codeException(&#39;not implemented fndir&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.empty0"><code class="name flex">
<span>def <span class="ident">empty0</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1825-L1826" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def empty0(self, *args):
    raise Pcode2codeException(&#39;not implemented empty0&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.empty1"><code class="name flex">
<span>def <span class="ident">empty1</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1828-L1829" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def empty1(self, *args):
    raise Pcode2codeException(&#39;not implemented empty1&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnerror"><code class="name flex">
<span>def <span class="ident">fnerror</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1831-L1832" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnerror(self, *args):
    raise Pcode2codeException(&#39;not implemented fnerror&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnformat"><code class="name flex">
<span>def <span class="ident">fnformat</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1834-L1835" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnformat(self, *args):
    raise Pcode2codeException(&#39;not implemented format&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnfreefile"><code class="name flex">
<span>def <span class="ident">fnfreefile</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1837-L1838" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnfreefile(self, *args):
    raise Pcode2codeException(&#39;not implemented fnfreefile&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fninstr"><code class="name flex">
<span>def <span class="ident">fninstr</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when calling Instr function with 2 arguments
example: MyPos = InStr(SearchString, SearchChar)
gives:
# Ld SearchString
# Ld SearchChar
# FnInStr
# St MyPos</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1840-L1851" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fninstr(self):
    &#34;&#34;&#34;
    command used when calling Instr function with 2 arguments
    example: MyPos = InStr(SearchString, SearchChar)
    gives:
         # Ld SearchString
         # Ld SearchChar
         # FnInStr
         # St MyPos
    &#34;&#34;&#34;
    arg2 = self.opstack.pop()
    self.opstack.push(&#39;Instr(&#39; + self.opstack.pop() + &#39;, &#39; + arg2 + &#39;)&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fninstr3"><code class="name flex">
<span>def <span class="ident">fninstr3</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when calling Instr function with 3 arguments
example: MyPos = InStr(1, SearchString, "W")
gives:
# LitDI2 0x0001
# Ld SearchString
# LitStr 0x0001 "W"
# FnInStr3
# St MyPos</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1853-L1867" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fninstr3(self):
    &#34;&#34;&#34;
    command used when calling Instr function with 3 arguments
    example: MyPos = InStr(1, SearchString, &#34;W&#34;)
    gives:
         # LitDI2 0x0001
         # Ld SearchString
         # LitStr 0x0001 &#34;W&#34;
         # FnInStr3
         # St MyPos
    &#34;&#34;&#34;
    arg3 = self.opstack.pop()
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    self.opstack.push(&#39;Instr(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;)&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fninstr4"><code class="name flex">
<span>def <span class="ident">fninstr4</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when calling Instr function with 4 arguments
example: MyPos = InStr(4, SearchString, SearchChar, 1)
gives:
# LitDI2 0x0004
# Ld SearchString
# Ld SearchChar
# LitDI2 0x0001
# FnInStr4
# St MyPos</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1869-L1885" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fninstr4(self):
    &#34;&#34;&#34;
    command used when calling Instr function with 4 arguments
    example: MyPos = InStr(4, SearchString, SearchChar, 1)
    gives:
         # LitDI2 0x0004
         # Ld SearchString
         # Ld SearchChar
         # LitDI2 0x0001
         # FnInStr4
         # St MyPos
    &#34;&#34;&#34;
    arg4 = self.opstack.pop()
    arg3 = self.opstack.pop()
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    self.opstack.push(&#39;Instr(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;, &#39; + arg4 + &#39;)&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fninstrb"><code class="name flex">
<span>def <span class="ident">fninstrb</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when calling InstrB function with 2 arguments
example: TODO: make sure here
gives:</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1887-L1894" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fninstrb(self):
    &#34;&#34;&#34;
    command used when calling InstrB function with 2 arguments
    example: TODO: make sure here
    gives:
    &#34;&#34;&#34;
    arg2 = self.opstack.pop()
    self.opstack.push(&#39;InstrB(&#39; + self.opstack.pop() + &#39;, &#39; + arg2 + &#39;)&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fninstrb3"><code class="name flex">
<span>def <span class="ident">fninstrb3</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when calling InstrB function with 3 arguments
example: TODO: make sure here
gives:</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1897-L1907" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fninstrb3(self):
    &#34;&#34;&#34;
    command used when calling InstrB function with 3 arguments
    example: TODO: make sure here
    gives:

    &#34;&#34;&#34;
    arg3 = self.opstack.pop()
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    self.opstack.push(&#39;InstrB(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;)&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fninstrb4"><code class="name flex">
<span>def <span class="ident">fninstrb4</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when calling InstrB function with 4 arguments
example: TODO: make sure here
gives:</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1910-L1921" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fninstrb4(self):
    &#34;&#34;&#34;
    command used when calling InstrB function with 4 arguments
    example: TODO: make sure here
    gives:

    &#34;&#34;&#34;
    arg4 = self.opstack.pop()
    arg3 = self.opstack.pop()
    arg2 = self.opstack.pop()
    arg1 = self.opstack.pop()
    self.opstack.push(&#39;Instr(&#39; + arg1 + &#39;, &#39; + arg2 + &#39;, &#39; + arg3 + &#39;, &#39; + arg4 + &#39;)&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnlbound"><code class="name flex">
<span>def <span class="ident">fnlbound</span></span>(<span>self, arg)</span>
</code></dt>
<dd>
<section class="desc"><p>command indicating the use of the LBound function
strangely enough, there is an indication of the number of arguments to be popped out of the stack
but this number is not good.
example: Lower = LBound(TwoDArray, 2)
gives:
# Ld TwoDArray
# LitDI2 0x0002
# FnLBound 0x0001
# St Lower</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1923-L1949" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnlbound(self, arg):
    &#34;&#34;&#34;
    command indicating the use of the LBound function
    strangely enough, there is an indication of the number of arguments to be popped out of the stack
    but this number is not good.
    example: Lower = LBound(TwoDArray, 2)
    gives: 
         # Ld TwoDArray
         # LitDI2 0x0002
         # FnLBound 0x0001
         # St Lower
    &#34;&#34;&#34;
    nb_parameters = int(arg,16) + 1
    params = []
    val = &#39;(&#39;
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]
        
        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;)&#39;
    val = &#39;LBound&#39; + val
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnmid"><code class="name flex">
<span>def <span class="ident">fnmid</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1951-L1953" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnmid(self):
    val = &#39;Mid(&#39; + self.opstack.pop() + &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnmidb"><code class="name flex">
<span>def <span class="ident">fnmidb</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1955-L1957" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnmidb(self):
    val = &#39;MidB(&#39; + self.opstack.pop() + &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnstrcomp"><code class="name flex">
<span>def <span class="ident">fnstrcomp</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when strcomp function with 2 arguments is called
example: MyComp = StrComp(MyStr2, MyStr1)
gives:
# Ld MyStr2
# Ld MyStr1
# FnStrComp
# St MyComp</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1959-L1971" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnstrcomp(self):
    &#34;&#34;&#34;
    command used when strcomp function with 2 arguments is called
    example: MyComp = StrComp(MyStr2, MyStr1)
    gives:
         # Ld MyStr2
         # Ld MyStr1
         # FnStrComp
         # St MyComp
    &#34;&#34;&#34;
    str2 = self.opstack.pop()
    str1 = self.opstack.pop()
    self.opstack.push(&#39;StrComp(&#39; + str1 + &#39;, &#39; + str2 + &#39;)&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnstrcomp3"><code class="name flex">
<span>def <span class="ident">fnstrcomp3</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when strcomp function with 3 arguments is called
example: MyComp = StrComp(MyStr1, MyStr2, 0)
gives:
# Ld MyStr1
# Ld MyStr2
# LitDI2 0x0000
# FnStrComp3
# St MyComp</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1973-L1987" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnstrcomp3(self):
    &#34;&#34;&#34;
    command used when strcomp function with 3 arguments is called
    example: MyComp = StrComp(MyStr1, MyStr2, 0)
    gives:
         # Ld MyStr1
         # Ld MyStr2
         # LitDI2 0x0000
         # FnStrComp3
         # St MyComp
    &#34;&#34;&#34;
    third_arg = self.opstack.pop()
    str2 = self.opstack.pop()
    str1 = self.opstack.pop()
    self.opstack.push(&#39;StrComp(&#39; + str1 + &#39;, &#39; + str2 + &#39;, &#39; + third_arg + &#39;)&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnstringvar"><code class="name flex">
<span>def <span class="ident">fnstringvar</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1989-L1990" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnstringvar(self, *args):
    raise Pcode2codeException(&#39;not implemented fnstringvar&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnstringstr"><code class="name flex">
<span>def <span class="ident">fnstringstr</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1992-L1993" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnstringstr(self, *args):
    raise Pcode2codeException(&#39;not implemented fnstringstr&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.fnubound"><code class="name flex">
<span>def <span class="ident">fnubound</span></span>(<span>self, arg)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when calling Ubound function
example: uL = UBound(sb_)
gives:
<br>
# Ld sb_
# FnUBound 0x0000
# St uL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L1995-L2018" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fnubound(self, arg):
    &#34;&#34;&#34;
    command used when calling Ubound function
    example: uL = UBound(sb_)
    gives:     
         # Ld sb_ 
         # FnUBound 0x0000 
         # St uL
    &#34;&#34;&#34;
    nb_parameters = int(arg,16) + 1
    params = []
    val = &#39;(&#39;
    if nb_parameters &gt; 0:
        for i in range(nb_parameters):
            params.append(self.opstack.pop())
        params = params[::-1]
        val = val + params[0]
        
        if nb_parameters &gt; 1:
            for param in params[1:]:
                val = val + &#39;, &#39; + param
    val += &#39;)&#39;
    val = &#39;UBound&#39; + val
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.for_"><code class="name flex">
<span>def <span class="ident">for_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2020-L2026" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def for_(self):
    maxvar = self.opstack.pop()
    minvar = self.opstack.pop()
    loopvar = self.opstack.pop()
    val = &#39;For &#39; + loopvar + &#39; = &#39; + minvar + &#39; To &#39; + maxvar
    self.opstack.push(val)
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.foreach"><code class="name flex">
<span>def <span class="ident">foreach</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a new for each loop definition
example: For Each MyObject In MyClasses
gives:
# StartForVariable
# Ld MyObject
# EndForVariable
# Ld MyClasses
# ForEach</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2028-L2043" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def foreach(self):
    &#34;&#34;&#34;
    command defining a new for each loop definition
    example: For Each MyObject In MyClasses
    gives:
         # StartForVariable
         # Ld MyObject
         # EndForVariable
         # Ld MyClasses
         # ForEach
    &#34;&#34;&#34;
    collect = self.opstack.pop()
    loopvar = self.opstack.pop()
    val = &#39;For Each &#39; + loopvar + &#39; In &#39; + collect
    self.opstack.push(val)
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.foreachas"><code class="name flex">
<span>def <span class="ident">foreachas</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2045-L2046" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def foreachas(self, *args):
    raise Pcode2codeException(&#39;not implemented foreachas&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.forstep"><code class="name flex">
<span>def <span class="ident">forstep</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2048-L2055" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def forstep(self):
    step = self.opstack.pop()
    maxvar = self.opstack.pop()
    minvar = self.opstack.pop()
    loopvar = self.opstack.pop()
    val = &#39;For &#39; + loopvar + &#39; = &#39; + minvar + &#39; To &#39; + maxvar + &#39; Step &#39; + step
    self.opstack.push(val)
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.funcdefn"><code class="name flex">
<span>def <span class="ident">funcdefn</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2057-L2064" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def funcdefn(self, *args: str):
    val = args[0]
    for arg in args[1:]:
        val += &#39; &#39; + arg
    val = val[1:-1]
    self.opstack.push(val)
    if not val.startswith(&#39;Declare&#39;):
        self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.funcdefnsave"><code class="name flex">
<span>def <span class="ident">funcdefnsave</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2066-L2067" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def funcdefnsave(self, *args):
    raise Pcode2codeException(&#39;not implemented funcdefnsave&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.getrec"><code class="name flex">
<span>def <span class="ident">getrec</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command to Get from a channel with a record: get channel, record, var
example: Get #1, RecordNumber, MyRecord
gives:
# LitDI2 0x0001
# Sharp
# Ld RecordNumber
# Ld MyRecord
# GetRec</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2069-L2086" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def getrec(self):
    &#34;&#34;&#34;
    command to Get from a channel with a record: get channel, record, var
    example: Get #1, RecordNumber, MyRecord
    gives:
         # LitDI2 0x0001
         # Sharp
         # Ld RecordNumber
         # Ld MyRecord
         # GetRec
    &#34;&#34;&#34;
    record = self.opstack.pop()
    record_num = self.opstack.pop()
    chan = self.opstack.pop()
    if chan is not None:
        self.opstack.push(&#39;Get &#39; + chan + &#39;, &#39; + record_num + &#39;, &#39; + record)
    else:
        self.opstack.push(&#39;Get &#39; + record_num + &#39;, , &#39; + record) # kindly ugly</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.gosub"><code class="name flex">
<span>def <span class="ident">gosub</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when gosub is used
example: If Num &gt; 0 Then GoSub MyRoutine
gives:
# Ld Num
# LitDI2 0x0000
# Gt
# If
# BoSImplicit
# GoSub MyRoutine
# EndIf</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2088-L2101" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def gosub(self, var):
    &#34;&#34;&#34;
    command used when gosub is used
    example: If Num &gt; 0 Then GoSub MyRoutine 
    gives:
         # Ld Num
         # LitDI2 0x0000
         # Gt
         # If
         # BoSImplicit
         # GoSub MyRoutine
         # EndIf
    &#34;&#34;&#34;
    self.opstack.push(&#39;GoSub &#39; + var)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.goto"><code class="name flex">
<span>def <span class="ident">goto</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a goto <label> is defined
example: GoTo label1
gives: # GoTo label1</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2103-L2109" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def goto(self, var):
    &#34;&#34;&#34;
    command used when a goto &lt;label&gt; is defined
    example: GoTo label1
    gives: # GoTo label1
    &#34;&#34;&#34;
    self.opstack.push(&#39;GoTo &#39; + var)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.if_"><code class="name flex">
<span>def <span class="ident">if_</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2112-L2115" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def if_(self, *args):
    val = &#39;If &#39; + self.opstack.pop() + &#39; Then&#39;
    self.onelineif = True
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.ifblock"><code class="name flex">
<span>def <span class="ident">ifblock</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2117-L2120" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def ifblock(self):
    val = &#39;If &#39; + self.opstack.pop() + &#39; Then&#39;
    self.opstack.push(val)
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.typeof"><code class="name flex">
<span>def <span class="ident">typeof</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when TypeOf function is used
TODO: associated type is obscure for now</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2122-L2127" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def typeof(self, *args):
    &#34;&#34;&#34;
    command used when TypeOf function is used
    TODO: associated type is obscure for now
    &#34;&#34;&#34;
    raise Pcode2codeException(&#39;not implemented typeof&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.iftypeblock"><code class="name flex">
<span>def <span class="ident">iftypeblock</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2129-L2130" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def iftypeblock(self, *args):
    raise Pcode2codeException(&#39;not implemented iftypeblock&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.implements"><code class="name flex">
<span>def <span class="ident">implements</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when Implements instruction is used
TODO: associated type is obscure for now</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2132-L2137" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def implements(self, *args):
    &#34;&#34;&#34;
    command used when Implements instruction is used
    TODO: associated type is obscure for now        
    &#34;&#34;&#34;
    raise Pcode2codeException(&#39;not implemented implements&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.input_"><code class="name flex">
<span>def <span class="ident">input_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when Input function is called
example : Input #1, MyString, MyNumber
gives:
# LitDI2 0x0001
# Sharp
# Input
# Ld MyString
# InputItem
# Ld MyNumber
# InputItem
# InputDone</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2139-L2153" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def input_(self):
    &#34;&#34;&#34;
    command used when Input function is called
    example : Input #1, MyString, MyNumber
    gives: 
         # LitDI2 0x0001
         # Sharp
         # Input
         # Ld MyString
         # InputItem
         # Ld MyNumber
         # InputItem
         # InputDone        
    &#34;&#34;&#34;
    self.opstack.push(&#39;Input &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.inputdone"><code class="name flex">
<span>def <span class="ident">inputdone</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when Input function is called
example : Input #1, MyString, MyNumber
gives:
# LitDI2 0x0001
# Sharp
# Input
# Ld MyString
# InputItem
# Ld MyNumber
# InputItem
# InputDone</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2155-L2176" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def inputdone(self):
    &#34;&#34;&#34;
    command used when Input function is called
    example : Input #1, MyString, MyNumber
    gives: 
         # LitDI2 0x0001
         # Sharp
         # Input
         # Ld MyString
         # InputItem
         # Ld MyNumber
         # InputItem
         # InputDone        
    &#34;&#34;&#34;
    elmts = []
    while self.opstack.size() &gt;= 1:
        elmts.append(self.opstack.pop())
    elmts = elmts[::-1]
    val = elmts[0]
    for elmt in elmts[1:]:
        val += elmt
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.inputItem"><code class="name flex">
<span>def <span class="ident">inputItem</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when Input function is called
example : Input #1, MyString, MyNumber
gives:
# LitDI2 0x0001
# Sharp
# Input
# Ld MyString
# InputItem
# Ld MyNumber
# InputItem
# InputDone</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2179-L2193" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def inputItem(self):
    &#34;&#34;&#34;
    command used when Input function is called
    example : Input #1, MyString, MyNumber
    gives: 
         # LitDI2 0x0001
         # Sharp
         # Input
         # Ld MyString
         # InputItem
         # Ld MyNumber
         # InputItem
         # InputDone        
    &#34;&#34;&#34;
    self.opstack.push(&#39;, &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.label"><code class="name flex">
<span>def <span class="ident">label</span></span>(<span>self, arg)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a new label
example: MyString:
gives:
# Label MyString</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2195-L2202" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def label(self, arg):
    &#34;&#34;&#34;
    command defining a new label
    example: MyString:
    gives:
         # Label MyString
    &#34;&#34;&#34;
    self.opstack.push(arg+&#39;:&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.let"><code class="name flex">
<span>def <span class="ident">let</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when let keywork is used
example: Let MyStr
= "Hello World"
gives:
# Let
# LitStr 0x000B "Hello World"
# St MyStr</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2204-L2214" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def let(self, *args):
    &#34;&#34;&#34;
    command used when let keywork is used
    example: Let MyStr  = &#34;Hello World&#34;
    gives:
         # Let
         # LitStr 0x000B &#34;Hello World&#34;
         # St MyStr
    &#34;&#34;&#34;
    self.opstack.push(&#39;Let&#39;)
    self.has_bos = True #we use this hackish way to print it even if not in stack top</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.line"><code class="name flex">
<span>def <span class="ident">line</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2217-L2218" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def line(self, *args):
    raise Pcode2codeException(&#39;not implemented line&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.linecont"><code class="name flex">
<span>def <span class="ident">linecont</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2220-L2222" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def linecont(self, *args):
    #pass on purpose
    pass</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lineInput"><code class="name flex">
<span>def <span class="ident">lineInput</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when Line Input instruction is used (to read one line at a time a file)
example: Line Input #1, TextLine
gives:
# LitDI2 0x0001
# Ld TextLine
# LineInput</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2224-L2235" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lineInput(self):
    &#34;&#34;&#34;
    command used when Line Input instruction is used (to read one line at a time a file)
    example: Line Input #1, TextLine
    gives:
         # LitDI2 0x0001
         # Ld TextLine
         # LineInput
    &#34;&#34;&#34;
    var = self.opstack.pop()
    num_file = self.opstack.pop()
    self.opstack.push(&#39;Line Input #&#39; + num_file + &#39;, &#39; + var)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.linenum"><code class="name flex">
<span>def <span class="ident">linenum</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2237-L2239" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def linenum(self, *args):
    # ignoring this seems to work fine.
    return</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litcy"><code class="name flex">
<span>def <span class="ident">litcy</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2241-L2242" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litcy(self, *args):
    raise Pcode2codeException(&#39;not implemented litcy&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litdate"><code class="name flex">
<span>def <span class="ident">litdate</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command to define a date literal
TODO: but wtf how to get date?
example1: MyDate = #2/12/1969#
gives: LitDate 0x0000 0x0000 0xA780 0x40D8
example2: MyDate = #2/12/1970#
gives: LitDate 0x0000 0x0000 0x02C0 0x40D9
example3: MyDate = #2/12/1971#
gives: LitDate 0x0000 0x0000 0x5E00 0x40D9
example4: MyDate = #2/11/1969#
gives: LitDate 0x0000 0x0000 0xA740 0x40D8
example5: MyDate = #2/10/1969#
gives: LitDate 0x0000 0x0000 0xA700 0x40D8
example6: MyDate = #3/12/1969#
gives: LitDate 0x0000 0x0000 0xAE80 0x40D8
example7: MyDate = #4/12/1969#
gives: LitDate 0x0000 0x0000 0xB640 0x40D8</p>
<p>1 year = 23360 (0x5b40) si on fait last2bytes.first2bytes
1 month = 64 (0x40) sur second octet
1 day =</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2244-L2268" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litdate(self, *args):
    &#34;&#34;&#34;
    command to define a date literal
    TODO: but wtf how to get date?
    example1: MyDate = #2/12/1969#
    gives: LitDate 0x0000 0x0000 0xA780 0x40D8
    example2: MyDate = #2/12/1970#
    gives: LitDate 0x0000 0x0000 0x02C0 0x40D9
    example3: MyDate = #2/12/1971#
    gives: LitDate 0x0000 0x0000 0x5E00 0x40D9
    example4: MyDate = #2/11/1969#
    gives: LitDate 0x0000 0x0000 0xA740 0x40D8
    example5: MyDate = #2/10/1969#
    gives: LitDate 0x0000 0x0000 0xA700 0x40D8
    example6: MyDate = #3/12/1969#
    gives: LitDate 0x0000 0x0000 0xAE80 0x40D8
    example7: MyDate = #4/12/1969#
    gives: LitDate 0x0000 0x0000 0xB640 0x40D8


    1 year = 23360 (0x5b40) si on fait last2bytes.first2bytes
    1 month = 64 (0x40) sur second octet
    1 day = 
    &#34;&#34;&#34;
    raise Pcode2codeException(&#39;a date is defined here, but it cannot be reconstructed&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litdefault"><code class="name flex">
<span>def <span class="ident">litdefault</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>appears to be useless
example: Open "TESTFILE" For Output As #1
gives:
# LitStr 0x0008 "TESTFILE"
# LitDI2 0x0001
# Sharp
# LitDefault
# Open (For Output)
example2: Lock #1, RecordNumber
gives:
# LitDI2 0x0001
# Sharp
# Ld RecordNumber
# LitDefault
# Lock
example3: same for unlock</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2270-L2289" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litdefault(self):
    &#34;&#34;&#34;
    appears to be useless
    example: Open &#34;TESTFILE&#34; For Output As #1 
    gives:
         # LitStr 0x0008 &#34;TESTFILE&#34;
         # LitDI2 0x0001
         # Sharp
         # LitDefault
         # Open (For Output)
    example2: Lock #1, RecordNumber
    gives:
         # LitDI2 0x0001
         # Sharp
         # Ld RecordNumber
         # LitDefault
         # Lock
    example3: same for unlock
    &#34;&#34;&#34;
    #pass on purpose</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litdi2"><code class="name flex">
<span>def <span class="ident">litdi2</span></span>(<span>self, value)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2292-L2293" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litdi2(self, value):
    self.opstack.push(str(int(value,16)))</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litdi4"><code class="name flex">
<span>def <span class="ident">litdi4</span></span>(<span>self, byte1, byte2)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2296-L2298" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litdi4(self, byte1, byte2):
    val = int(byte2+byte1[2:], 16)
    self.opstack.push(str(val))</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litdi8"><code class="name flex">
<span>def <span class="ident">litdi8</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2300-L2301" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litdi8(self, *args):
    raise Pcode2codeException(&#39;not implemented litdi8&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lithi2"><code class="name flex">
<span>def <span class="ident">lithi2</span></span>(<span>self, byte)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2303-L2308" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lithi2(self, byte):
    val = byte[2:]
    while val.startswith(&#39;0&#39;) and len(val) &gt; 1:
        val = val[1:]
    val = &#39;&amp;H&#39; + val
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lithi4"><code class="name flex">
<span>def <span class="ident">lithi4</span></span>(<span>self, byte1, byte2)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2310-L2315" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lithi4(self, byte1, byte2):
    val = byte2[2:]+byte1[2:]
    while val.startswith(&#39;0&#39;) and len(val) &gt; 1:
        val = val[1:]
    val = &#39;&amp;H&#39; + val
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lithi8"><code class="name flex">
<span>def <span class="ident">lithi8</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2317-L2318" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lithi8(self, *args):
    raise Pcode2codeException(&#39;not implemented lithi8&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litnothing"><code class="name flex">
<span>def <span class="ident">litnothing</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining the "Nothing" variable
example: Set Inst = Nothing
gives:
# SetStmt
# LitNothing
# Set Inst</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2320-L2329" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litnothing(self):
    &#34;&#34;&#34;
    command defining the &#34;Nothing&#34; variable
    example: Set Inst = Nothing
    gives:
         # SetStmt
         # LitNothing
         # Set Inst
    &#34;&#34;&#34;
    self.opstack.push(&#39;Nothing&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litoi2"><code class="name flex">
<span>def <span class="ident">litoi2</span></span>(<span>self, value)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when an octal is defined on a two bytes byte array
example: B = &amp;O1
gives:
# LitOI2 0x0001
# St B</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2331-L2341" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litoi2(self, value):
    &#34;&#34;&#34;
    command used when an octal is defined on a two bytes byte array
    example: B = &amp;O1
    gives:
         # LitOI2 0x0001
         # St B
    &#34;&#34;&#34;
    var = int(value,16)
    var2 = str(oct(var))[2:]
    self.opstack.push(&#39;&amp;O&#39; + var2)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litoi4"><code class="name flex">
<span>def <span class="ident">litoi4</span></span>(<span>self, byte1, byte2)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when an octal is defined on a two bytes byte array
example: B = &amp;O12345644444
gives:
# LitOI4 0x4924 0x5397
# St B</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2343-L2354" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litoi4(self, byte1, byte2):
    &#34;&#34;&#34;
    command used when an octal is defined on a two bytes byte array
    example: B = &amp;O12345644444
    gives:
         # LitOI4 0x4924 0x5397
         # St B
    &#34;&#34;&#34;        
    val = byte2[2:]+byte1[2:]
    var = int(val,16)
    var2 = str(oct(var))[2:]
    self.opstack.push(&#39;&amp;O&#39; + var2)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litoi8"><code class="name flex">
<span>def <span class="ident">litoi8</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2357-L2358" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litoi8(self, *args):
    raise Pcode2codeException(&#39;not implemented litoi8&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litr4"><code class="name flex">
<span>def <span class="ident">litr4</span></span>(<span>self, byte1, byte2)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a floating point on 32 bit is declared</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2360-L2365" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litr4(self, byte1, byte2):
    &#34;&#34;&#34;
    command used when a floating point on 32 bit is declared
    &#34;&#34;&#34;
    val = byte2[2:]+byte1[2:]
    self.opstack.push(str(struct.unpack(&#34;!f&#34;, bytes.fromhex(val))[0]))</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litr8"><code class="name flex">
<span>def <span class="ident">litr8</span></span>(<span>self, byte1, byte2, byte3, byte4)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a floating point on 64 bit is declared</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2367-L2372" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litr8(self, byte1, byte2, byte3, byte4):
    &#34;&#34;&#34;
    command used when a floating point on 64 bit is declared
    &#34;&#34;&#34;
    val = byte4[2:]+byte3[2:]+byte2[2:]+byte1[2:]
    self.opstack.push(str(struct.unpack(&#34;!d&#34;, bytes.fromhex(val))[0]))</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litsmalli2"><code class="name flex">
<span>def <span class="ident">litsmalli2</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2374-L2375" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litsmalli2(self, *args):
    raise Pcode2codeException(&#39;not implemented malli2&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litstr"><code class="name flex">
<span>def <span class="ident">litstr</span></span>(<span>self, mylen, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2377-L2387" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litstr(self, mylen, *args):
    val = args[0]
    for arg in args[1:]:
        val += &#39; &#39; + arg
    if len(val)&gt;=2:
        #assert(val[0]==&#39;&#34;&#39; and val[-1]==&#39;&#34;&#39;)
        val = val[1:-1]
        val = val.replace(&#39;&#34;&#39;, &#39;&#34;&#34;&#39;)
        val = &#39;&#34;&#39; + val + &#39;&#34;&#39;

    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.litvarspecial"><code class="name flex">
<span>def <span class="ident">litvarspecial</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2389-L2390" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def litvarspecial(self, var):
    self.opstack.push(var[1:-1])</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lock"><code class="name flex">
<span>def <span class="ident">lock</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command to lock a record
example: Lock #1, RecordNumber
gives:
# LitDI2 0x0001
# Sharp
# Ld RecordNumber
# LitDefault
# Lock</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2392-L2414" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lock(self):
    &#34;&#34;&#34;
    command to lock a record
    example: Lock #1, RecordNumber
    gives:
         # LitDI2 0x0001
         # Sharp
         # Ld RecordNumber
         # LitDefault
         # Lock
    &#34;&#34;&#34;
    if self.opstack.size() == 3:
        last_record = self.opstack.pop()
        first_record = self.opstack.pop()
        chan = self.opstack.pop()
        self.opstack.push(&#39;Lock &#39; + chan + &#39;, &#39; + first_record + &#39; To &#39; + last_record)
    elif self.opstack.size() == 2:
        record = self.opstack.pop()
        chan = self.opstack.pop()
        self.opstack.push(&#39;Lock &#39; + chan + &#39;, &#39; + record)
    elif self.opstack.size() == 1:
        chan = self.opstack.pop()
        self.opstack.push(&#39;Lock &#39; + chan)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.loop"><code class="name flex">
<span>def <span class="ident">loop</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2416-L2418" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def loop(self):
    self.opstack.push(&#39;Loop&#39;)
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.loopuntil"><code class="name flex">
<span>def <span class="ident">loopuntil</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining a loop until statement for "do"
example: Loop Until TheName = ""
gives:
# Ld TheName
# LitStr 0x0000 ""
# Eq
# LoopUntil</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2420-L2431" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def loopuntil(self):
    &#34;&#34;&#34;
    command defining a loop until statement for &#34;do&#34;
    example: Loop Until TheName = &#34;&#34;
    gives:
         # Ld TheName
         # LitStr 0x0000 &#34;&#34;
         # Eq
         # LoopUntil
    &#34;&#34;&#34;
    self.opstack.push(&#39;Loop Until &#39; + self.opstack.pop())
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.loopwhile"><code class="name flex">
<span>def <span class="ident">loopwhile</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling " while" definitions
example: Loop While Reponse = 5
gives:
# Ld Response
# LitDI2
0x0005
# Eq
# LoopWhile</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2433-L2444" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def loopwhile(self):
    &#34;&#34;&#34;
    command handling &#34; while&#34; definitions
    example: Loop While Reponse = 5
    gives:
         # Ld Response
         # LitDI2  0x0005
         # Eq
         # LoopWhile
    &#34;&#34;&#34;
    self.opstack.push(&#39;Loop While &#39; + self.opstack.pop())
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lset"><code class="name flex">
<span>def <span class="ident">lset</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command for RSet keyword
example: LSet MyString = "Right-&gt;"
gives:
# LitStr 0x0007 "Right-&gt;"
# Ld MyString
# RSet</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2447-L2458" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lset(self):
    &#34;&#34;&#34;
    command for RSet keyword
    example: LSet MyString = &#34;Right-&gt;&#34;
    gives:
         # LitStr 0x0007 &#34;Right-&gt;&#34;
         # Ld MyString
         # RSet
    &#34;&#34;&#34;
    var = self.opstack.pop()
    val = self.opstack.pop()
    self.opstack.push(&#39;LSet &#39; + var + &#39; = &#39; + val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.me"><code class="name flex">
<span>def <span class="ident">me</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2460-L2461" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def me(self, *args):
    raise Pcode2codeException(&#39;not implemented me&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.meimplicit"><code class="name flex">
<span>def <span class="ident">meimplicit</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when the object is the current form
example: Print
gives:
# MeImplicit
# PrintObj
# PrintNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2463-L2472" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def meimplicit(self, *args):
    &#34;&#34;&#34;
    command used when the object is the current form
    example: Print 
    gives:
         # MeImplicit
         # PrintObj
         # PrintNL
    &#34;&#34;&#34;
    self.opstack.push(&#39;MeImplicit&#39;) #just pushing a specific marker to change treatment later</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.memredim"><code class="name flex">
<span>def <span class="ident">memredim</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a property of an object is redim
example: ReDim myobj.foo(30)
gives:
# OptionBase
# LitDI2 0x001E
# Ld myobj
# MemRedim foo 0x0001 (As Variant)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2474-L2525" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def memredim(self, *args):
    &#34;&#34;&#34;
    command used when a property of an object is redim
    example: ReDim myobj.foo(30)
    gives:
         # OptionBase
         # LitDI2 0x001E
         # Ld myobj
         # MemRedim foo 0x0001 (As Variant)
    &#34;&#34;&#34;
    val = self.opstack.pop()
    args = list(args)
    preserve = False
    if args[0] == &#39;(Preserve)&#39;:
        args.pop(0)
        preserve = True

    nb_params = int(args[1], 16)

    values = []
    # gather all stack
    while self.opstack.size() &gt; 0:
        values.append(self.opstack.pop())
    values = values[::-1]

    if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
        val = values.pop(0) + &#39;, &#39; + val + &#39;.&#39; + args[0] + &#39;(&#39;
    else:
        val2 = &#39;ReDim &#39;
        if preserve:
            val2 += &#39;Preserve &#39;
        val2 += val + &#39;.&#39; + args[0] + &#39;(&#39;
        val = val2

    curr_val1 = values.pop(0)
    curr_val2 = values.pop(0)
    if curr_val1 == &#39;OptionBase&#39;:
        val += curr_val2 
    else:
        val += curr_val1 + &#39; To &#39; + curr_val2 

    while len(values) &gt; 0:
        val += &#39;, &#39;
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

    val += &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.memredimwith"><code class="name flex">
<span>def <span class="ident">memredimwith</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a property of an object is redim within a with
example: with myobj &hellip; ReDim .foo(30) .. end with
gives:
# OptionBase
# LitDI2 0x001E
# MemRedimWith foo 0x0001 (As Variant)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2527-L2576" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def memredimwith(self, *args):
    &#34;&#34;&#34;
    command used when a property of an object is redim within a with
    example: with myobj ... ReDim .foo(30) .. end with
    gives:
         # OptionBase
         # LitDI2 0x001E
         # MemRedimWith foo 0x0001 (As Variant)
    &#34;&#34;&#34;
    val = &#39;&#39;
    args = list(args)
    preserve = False
    if args[0] == &#39;(Preserve)&#39;:
        args.pop(0)
        preserve = True

    nb_params = int(args[1], 16)

    values = []
    # gather all stack
    while self.opstack.size() &gt; 0:
        values.append(self.opstack.pop())
    values = values[::-1]

    if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
        val = values.pop(0) + &#39;, &#39; + &#39;.&#39; + args[0] + &#39;(&#39;
    else:
        val += &#39;ReDim &#39;
        if preserve:
            val += &#39;Preserve &#39;
        val += &#39;.&#39; + args[0] + &#39;(&#39;

    curr_val1 = values.pop(0)
    curr_val2 = values.pop(0)
    if curr_val1 == &#39;OptionBase&#39;:
        val += curr_val2 
    else:
        val += curr_val1 + &#39; To &#39; + curr_val2 

    while len(values) &gt; 0:
        val += &#39;, &#39;
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

    val += &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.memredimas"><code class="name flex">
<span>def <span class="ident">memredimas</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a redim is defined on a property of an object with a As in the end
example: ReDim myobj.mytab(50) As Double
gives:
# OptionBase
# LitDI2 0x003C
# Ld myobj
# MemRedimAs Tab 0x0001 (As Double)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2579-L2636" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def memredimas(self, *args):
    &#34;&#34;&#34;
    command used when a redim is defined on a property of an object with a As in the end
    example: ReDim myobj.mytab(50) As Double
    gives:
         # OptionBase
         # LitDI2 0x003C
         # Ld myobj
         # MemRedimAs Tab 0x0001 (As Double)
    &#34;&#34;&#34;
    val = self.opstack.pop()
    args = list(args)
    preserve = False
    if args[0] == &#39;(Preserve)&#39;:
        args.pop(0)
        preserve = True

    nb_params = int(args[1], 16)

    values = []
    # gather all stack
    while self.opstack.size() &gt; 0:
        values.append(self.opstack.pop())
    values = values[::-1]

    if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
        val = values.pop(0) + &#39;, &#39; + val + &#39;.&#39; + args[0] + &#39;(&#39;
    else:
        val2 = &#39;ReDim &#39;
        if preserve:
            val2 += &#39;Preserve &#39;
        val2 += val + &#39;.&#39; + args[0] + &#39;(&#39;
        val = val2
        
    curr_val1 = values.pop(0)
    curr_val2 = values.pop(0)
    if curr_val1 == &#39;OptionBase&#39;:
        val += curr_val2 
    else:
        val += curr_val1 + &#39; To &#39; + curr_val2 

    while len(values) &gt; 0:
        val += &#39;, &#39;
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

    val += &#39;)&#39;

    args.pop(0) #remove var
    args.pop(0) # remove nb_params
    if len(args)&gt; 0: # do we have smthng like &#34;(As &lt;type&gt;)&#34;
        if args[-1] != &#39;Variant)&#39;:
            val += &#39; &#39; + args[0][1:] + &#39; &#39; + args[1][:-1]
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.memredimaswith"><code class="name flex">
<span>def <span class="ident">memredimaswith</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a redim is defined on a property of an object with a As in the end, within a with block
example: With myobj &hellip; ReDim .mytab(70) As Integer &hellip; End With
gives:
# OptionBase
# LitDI2 0x0046
# MemRedimAsWith Tab 0x0001 (As Integer)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2638-L2693" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def memredimaswith(self, *args):
    &#34;&#34;&#34;
    command used when a redim is defined on a property of an object with a As in the end, within a with block
    example: With myobj ... ReDim .mytab(70) As Integer ... End With 
    gives:
         # OptionBase
         # LitDI2 0x0046
         # MemRedimAsWith Tab 0x0001 (As Integer)
    &#34;&#34;&#34;
    val = &#39;&#39;
    args = list(args)
    preserve = False
    if args[0] == &#39;(Preserve)&#39;:
        args.pop(0)
        preserve = True

    nb_params = int(args[1], 16)

    values = []
    # gather all stack
    while self.opstack.size() &gt; 0:
        values.append(self.opstack.pop())
    values = values[::-1]

    if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
        val = values.pop(0) + &#39;, &#39; + &#39;.&#39; + args[0] + &#39;(&#39;
    else:
        val += &#39;ReDim &#39;
        if preserve:
            val += &#39;Preserve &#39;
        val += &#39;.&#39; + args[0] + &#39;(&#39;
        
    curr_val1 = values.pop(0)
    curr_val2 = values.pop(0)
    if curr_val1 == &#39;OptionBase&#39;:
        val += curr_val2 
    else:
        val += curr_val1 + &#39; To &#39; + curr_val2 

    while len(values) &gt; 0:
        val += &#39;, &#39;
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

    val += &#39;)&#39;

    args.pop(0) #remove var
    args.pop(0) # remove nb_params
    if len(args)&gt; 0: # do we have smthng like &#34;(As &lt;type&gt;)&#34;
        if args[-1] != &#39;Variant)&#39;:
            val += &#39; &#39; + args[0][1:] + &#39; &#39; + args[1][:-1]
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.mid"><code class="name flex">
<span>def <span class="ident">mid</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when Mid funtion is used to set a sub string part, e.g. as an instruction
example: Mid(MyString, 5, 3) = "fox"
gives:
# LitStr 0x0003 "fox"
# Ld MyString
# LitDI2 0x0005
# LitDI2 0x0003
# Mid</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2695-L2716" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def mid(self):
    &#34;&#34;&#34;
    command used when Mid funtion is used to set a sub string part, e.g. as an instruction
    example: Mid(MyString, 5, 3) = &#34;fox&#34;
    gives:
         # LitStr 0x0003 &#34;fox&#34;
         # Ld MyString
         # LitDI2 0x0005
         # LitDI2 0x0003
         # Mid
    &#34;&#34;&#34;
    if self.opstack.size() &gt; 3:
        length = self.opstack.pop()
        start = self.opstack.pop()
        obj = self.opstack.pop()
        str1 = self.opstack.pop()
        self.opstack.push(&#39;Mid(&#39; + obj + &#39;, &#39; + start + &#39;, &#39; + length + &#39;) = &#39; + str1)
    else:
        start = self.opstack.pop()
        obj = self.opstack.pop()
        str1 = self.opstack.pop()
        self.opstack.push(&#39;Mid(&#39; + obj + &#39;, &#39; + start + &#39;) = &#39; + str1)            </code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.midb"><code class="name flex">
<span>def <span class="ident">midb</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when Mid funtion is used to set a sub string part, e.g as an instruction
example: MidB(MyString, 5, 3) = "fox"
gives:
# LitStr 0x0003 "fox"
# Ld MyString
# LitDI2 0x0005
# LitDI2 0x0003
# MidB</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2718-L2739" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def midb(self):
    &#34;&#34;&#34;
    command used when Mid funtion is used to set a sub string part, e.g as an instruction
    example: MidB(MyString, 5, 3) = &#34;fox&#34;
    gives:
         # LitStr 0x0003 &#34;fox&#34;
         # Ld MyString
         # LitDI2 0x0005
         # LitDI2 0x0003
         # MidB
    &#34;&#34;&#34;
    if self.opstack.size() &gt; 3:
        length = self.opstack.pop()
        start = self.opstack.pop()
        obj = self.opstack.pop()
        str1 = self.opstack.pop()
        self.opstack.push(&#39;MidB(&#39; + obj + &#39;, &#39; + start + &#39;, &#39; + length + &#39;) = &#39; + str1)
    else:
        start = self.opstack.pop()
        obj = self.opstack.pop()
        str1 = self.opstack.pop()
        self.opstack.push(&#39;MidB(&#39; + obj + &#39;, &#39; + start + &#39;) = &#39; + str1)            </code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.name"><code class="name flex">
<span>def <span class="ident">name</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command for the name keyword, permitting to rename variables
example: Name OldName As NewName
gives:
# Ld OldName
# Ld NewName
# Name</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2742-L2753" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def name(self):
    &#34;&#34;&#34;
    command for the name keyword, permitting to rename variables
    example: Name OldName As NewName
    gives:
         # Ld OldName
         # Ld NewName
         # Name
    &#34;&#34;&#34;
    newname = self.opstack.pop()
    oldname = self.opstack.pop()
    self.opstack.push(&#39;Name &#39; + oldname + &#39; As &#39; + newname) </code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.new"><code class="name flex">
<span>def <span class="ident">new</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2755-L2756" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def new(self, var):
    self.opstack.push(&#39;New &#39; + var)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.next_"><code class="name flex">
<span>def <span class="ident">next_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2758-L2761" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def next_(self):
    self.opstack.push(&#39;Next&#39;)
    self.indentlevel = self.indentlevel - 1
    self.indentincrease_future = False</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.nextvar"><code class="name flex">
<span>def <span class="ident">nextvar</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2763-L2765" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def nextvar(self):
    self.opstack.push(&#39;Next &#39; + self.opstack.pop())
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.onerror"><code class="name flex">
<span>def <span class="ident">onerror</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining "on error" statements
example1: On Error GoTo ErrorHandler
gives:
# OnError ErrorHandler
example2: On Error GoTo 0
gives:
# OnError (GoTo 0)
example3: On Error Resume Next
gives:
# OnError (Resume Next)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2767-L2786" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def onerror(self, *args):
    &#34;&#34;&#34;
    command defining &#34;on error&#34; statements
    example1: On Error GoTo ErrorHandler
    gives:
         # OnError ErrorHandler
    example2: On Error GoTo 0
    gives: 
         # OnError (GoTo 0)
    example3: On Error Resume Next
    gives: 
         # OnError (Resume Next)
    &#34;&#34;&#34;
    if args[0] == &#39;(Resume&#39;:
        self.opstack.push(&#39;On Error Resume Next&#39;)
    elif args[0] == &#39;(GoTo&#39;:
        self.opstack.push(&#39;On Error GoTo 0&#39;)
    else:
        #TODO: to check
        self.opstack.push(&#39;On Error GoTo &#39; + args[0])</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.ongosub"><code class="name flex">
<span>def <span class="ident">ongosub</span></span>(<span>self, nb, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used for gosub on a variable
example: On Number GoSub Sub1, Sub2
gives:
# Ld Number
# OnGoSub 0x0004 Sub1, Sub2</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2788-L2800" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def ongosub(self, nb, *args):
    &#34;&#34;&#34;
    command used for gosub on a variable
    example: On Number GoSub Sub1, Sub2
    gives:
         # Ld Number
         # OnGoSub 0x0004 Sub1, Sub2
    &#34;&#34;&#34;
    val = &#39;On &#39; + self.opstack.pop() + &#39; GoSub &#39;
    val2 = args[0]
    for arg in args[1:]:
        val2 += &#39; &#39; + arg
    self.opstack.push(val + val2)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.ongoto"><code class="name flex">
<span>def <span class="ident">ongoto</span></span>(<span>self, nb, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used for goto on a variable
example: On Number GoTo Line1, Line2
gives:
# Ld Number
# OnGoto 0x0004 Line1, Line2</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2802-L2814" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def ongoto(self, nb, *args):
    &#34;&#34;&#34;
    command used for goto on a variable
    example: On Number GoTo Line1, Line2
    gives:
         # Ld Number
         # OnGoto 0x0004 Line1, Line2
    &#34;&#34;&#34;
    val = &#39;On &#39; + self.opstack.pop() + &#39; GoTo &#39;
    val2 = args[0]
    for arg in args[1:]:
        val2 += &#39; &#39; + arg
    self.opstack.push(val + val2)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.open_"><code class="name flex">
<span>def <span class="ident">open_</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used for Open function
example: Open "TESTFILE" For Output As #1
gives:
# LitStr 0x0008 "TESTFILE"
# LitDI2 0x0001
# Sharp
# LitDefault
# Open (For Output)
example2: Open "TESTFILE" For Binary Access Write Lock Write As #1
gives:
# LitStr 0x0008 "TESTFILE"
# LitDI2 0x0001
# Sharp
# LitDefault
# Open (For Binary Access Write Lock Write)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2816-L2839" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def open_(self, *args):
    &#34;&#34;&#34;
    command used for Open function
    example: Open &#34;TESTFILE&#34; For Output As #1
    gives:
         # LitStr 0x0008 &#34;TESTFILE&#34;
         # LitDI2 0x0001
         # Sharp
         # LitDefault
         # Open (For Output)
    example2: Open &#34;TESTFILE&#34; For Binary Access Write Lock Write As #1
    gives:
         # LitStr 0x0008 &#34;TESTFILE&#34;
         # LitDI2 0x0001
         # Sharp
         # LitDefault
         # Open (For Binary Access Write Lock Write)
    &#34;&#34;&#34;
    chan = self.opstack.pop()
    val = args[0][1:] # avoid parenthesis
    for arg in args[1:]:
        val += &#39; &#39; + arg
    val = val[:-1] #avoid parenthesis
    self.opstack.push(&#39;Open &#39; + self.opstack.pop() + &#39; &#39; + val + &#39; As &#39; + chan)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.option"><code class="name flex">
<span>def <span class="ident">option</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command for option keyword
example: Option Explicit
gives :
# Option (Explicit)
example2: Option Compare Binary
gives :
# Option (Compare Binary)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2841-L2855" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def option(self, *args):
    &#34;&#34;&#34;
    command for option keyword
    example: Option Explicit
    gives : 
       # Option (Explicit)
    example2: Option Compare Binary
    gives :
       # Option (Compare Binary)
    &#34;&#34;&#34;
    val = args[0][1:]
    if len(args)&gt;1:
        for arg in args[1:]: #strip parenthesis
            val += &#39; &#39; + arg
    self.opstack.push(&#39;Option &#39; + val[:-1])</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.optionbase"><code class="name flex">
<span>def <span class="ident">optionbase</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>used in the following case: when a table dimension is not declared from base to end, but only size;
to treat it, we will push a magic value on stack like for dim and dimimplicit, and vardef will treat it directly
example1: Dim MyArray(20)
gives:
# Dim
# OptionBase
# LitDI2 0x0014
# VarDefn MyArray</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2857-L2868" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def optionbase(self):
    &#34;&#34;&#34;
    used in the following case: when a table dimension is not declared from base to end, but only size;
    to treat it, we will push a magic value on stack like for dim and dimimplicit, and vardef will treat it directly
    example1: Dim MyArray(20)
    gives: 
         # Dim
         # OptionBase
         # LitDI2 0x0014
         # VarDefn MyArray
    &#34;&#34;&#34;
    self.opstack.push(&#39;OptionBase&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.parambyval"><code class="name flex">
<span>def <span class="ident">parambyval</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when Byval keyword is used
example: a ByVal b
gives:
# Ld B
# ParamByVal
# ArgsCall a 0x0001</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2870-L2879" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def parambyval(self):
    &#34;&#34;&#34;
    command used when Byval keyword is used
    example: a ByVal b
    gives:
         # Ld B
         # ParamByVal
         # ArgsCall a 0x0001
    &#34;&#34;&#34;
    self.opstack.push(&#39;ByVal &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.paramomitted"><code class="name flex">
<span>def <span class="ident">paramomitted</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a parameter is left blank in a function call
example: MsgBox Msg, , "Deferred Error Test"
gives:
# Ld Msg
# ParamOmitted
# LitStr 0x0013 "Deferred Error Test"
# ArgsCall MsgBox 0x0003</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2881-L2891" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def paramomitted(self):
    &#34;&#34;&#34;
    command used when a parameter is left blank in a function call
    example: MsgBox Msg, , &#34;Deferred Error Test&#34;
    gives:
         # Ld Msg
         # ParamOmitted
         # LitStr 0x0013 &#34;Deferred Error Test&#34;
         # ArgsCall MsgBox 0x0003
    &#34;&#34;&#34;
    self.opstack.push(&#39;&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.paramnamed"><code class="name flex">
<span>def <span class="ident">paramnamed</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a call is made with named parameters
example: MyClasses.Add Item:=Inst, Key:=CStr(Num)
gives:
# Ld Inst
# ParamNamed Item
# Ld Num
# Coerce (Str)
# ParamNamed Key
# Ld MyClasses
# ArgsMemCall Add 0x0002</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2893-L2906" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def paramnamed(self, var):
    &#34;&#34;&#34;
    command used when a call is made with named parameters
    example: MyClasses.Add Item:=Inst, Key:=CStr(Num)
    gives:
         # Ld Inst
         # ParamNamed Item
         # Ld Num
         # Coerce (Str)
         # ParamNamed Key
         # Ld MyClasses
         # ArgsMemCall Add 0x0002
    &#34;&#34;&#34;
    self.opstack.push(var + &#39;:=&#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printchan"><code class="name flex">
<span>def <span class="ident">printchan</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining "print" to a channel
example: Print #1, MyBool; " is a Boolean value"
gives:
# LitDI2 0x0001
# Sharp
# PrintChan
# Ld MyBool
# PrintItemSemi
# LitStr 0x0013 " is a Boolean value"
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2908-L2921" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printchan(self):
    &#34;&#34;&#34;
    command defining &#34;print&#34; to a channel
    example: Print #1, MyBool; &#34; is a Boolean value&#34;
    gives:
         # LitDI2 0x0001
         # Sharp
         # PrintChan
         # Ld MyBool
         # PrintItemSemi
         # LitStr 0x0013 &#34; is a Boolean value&#34;
         # PrintItemNL
    &#34;&#34;&#34;
    self.opstack.push(&#39;Print &#39; +self.opstack.pop() + &#39;,&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printcomma"><code class="name flex">
<span>def <span class="ident">printcomma</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a colon is used in Print
example: Debug.Print Spc(30), "Thirty spaces later&hellip;
gives:
# Debug
# PrintObj
# LitDI2 0x001E
# PrintSpc
# PrintComma
# LitStr 0x0016 "Thirty spaces later&hellip;"
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2923-L2936" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printcomma(self, *args):
    &#34;&#34;&#34;
    command used when a colon is used in Print
    example: Debug.Print Spc(30), &#34;Thirty spaces later...
    gives:
         # Debug
         # PrintObj
         # LitDI2 0x001E
         # PrintSpc
         # PrintComma
         # LitStr 0x0016 &#34;Thirty spaces later...&#34;
         # PrintItemNL
    &#34;&#34;&#34;
    self.opstack.push(&#39;,&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printeos"><code class="name flex">
<span>def <span class="ident">printeos</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>used at the end of some print when there is nothing, instead of printitemnl</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2938-L2952" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printeos(self):
    &#34;&#34;&#34;
    used at the end of some print when there is nothing, instead of printitemnl
    &#34;&#34;&#34;
    elmts = []
    while self.opstack.size() &gt;= 1:
        elmts.append(self.opstack.pop())
    elmts = elmts[::-1]
    val = elmts[0]
    for elmt in elmts[1:]:
        if ((elmt == &#39;;&#39;) or (elmt == &#39;,&#39;)) and (elmts.index(elmt) != 1):
            val+= elmt
        else:
            val += &#39; &#39; + elmt
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printitemcomma"><code class="name flex">
<span>def <span class="ident">printitemcomma</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining ",", used for example when writing
example: Write #1, "Hello World", 234
gives:
# LitDI2 0x0001
# Sharp
# WriteChan
# LitStr 0x000B "Hello World"
# PrintItemComma
# LitDI2 0x00EA
# PrintItemNL
# QuoteRem 0x0020 0x001C " Write comma-delimited data."</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2955-L2976" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printitemcomma(self):
    &#34;&#34;&#34;
    command defining &#34;,&#34;, used for example when writing 
    example: Write #1, &#34;Hello World&#34;, 234
    gives:
         # LitDI2 0x0001
         # Sharp
         # WriteChan
         # LitStr 0x000B &#34;Hello World&#34;
         # PrintItemComma
         # LitDI2 0x00EA
         # PrintItemNL
         # QuoteRem 0x0020 0x001C &#34; Write comma-delimited data.&#34;
    &#34;&#34;&#34;
    elmts = []
    while self.opstack.size() &gt;= 1:
        elmts.append(self.opstack.pop())
    elmts = elmts[::-1]
    val = elmts[0]
    for elmt in elmts[1:]:
        val += &#39; &#39; + elmt
    self.opstack.push(val + &#39;,&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printitemnl"><code class="name flex">
<span>def <span class="ident">printitemnl</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>TODO: not sure what's it is used for
example1: Write #1, MyBool; " is a Boolean value"
gives:
# LitDI2 0x0001
# Sharp
# WriteChan
# Ld MyBool
# PrintItemSemi
# LitStr 0x0013 " is a Boolean value"
# PrintItemNL
example2:
Debug.Print i
gives:
# Debug
# PrintObj
# Ld i
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L2978-L3007" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printitemnl(self):
    &#34;&#34;&#34;
    TODO: not sure what&#39;s it is used for
    example1: Write #1, MyBool; &#34; is a Boolean value&#34;
    gives:
         # LitDI2 0x0001
         # Sharp
         # WriteChan
         # Ld MyBool
         # PrintItemSemi
         # LitStr 0x0013 &#34; is a Boolean value&#34;
         # PrintItemNL
    example2:  Debug.Print i
    gives:
         # Debug
         # PrintObj
         # Ld i
         # PrintItemNL
    &#34;&#34;&#34;
    elmts = []
    while self.opstack.size() &gt;= 1:
        elmts.append(self.opstack.pop())
    elmts = elmts[::-1]
    val = elmts[0]
    for elmt in elmts[1:]:
        if ((elmt == &#39;;&#39;) or (elmt == &#39;,&#39;)) and (elmts.index(elmt) != 1):
            val+= elmt
        else:
            val += &#39; &#39; + elmt
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printitemsemi"><code class="name flex">
<span>def <span class="ident">printitemsemi</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining ";", used for example when writing
example: Write #1, MyBool; " is a Boolean value"
gives:
# LitDI2 0x0001
# Sharp
# WriteChan
# Ld MyBool
# PrintItemSemi
# LitStr 0x0013 " is a Boolean value"
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3009-L3029" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printitemsemi(self):
    &#34;&#34;&#34;
    command defining &#34;;&#34;, used for example when writing 
    example: Write #1, MyBool; &#34; is a Boolean value&#34;
    gives:
         # LitDI2 0x0001
         # Sharp
         # WriteChan
         # Ld MyBool
         # PrintItemSemi
         # LitStr 0x0013 &#34; is a Boolean value&#34;
         # PrintItemNL
    &#34;&#34;&#34;
    elmts = []
    while self.opstack.size() &gt;= 1:
        elmts.append(self.opstack.pop())
    elmts = elmts[::-1]
    val = elmts[0]
    for elmt in elmts[1:]:
        val += &#39; &#39; + elmt
    self.opstack.push(val + &#39;;&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printnl"><code class="name flex">
<span>def <span class="ident">printnl</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>really not sure about this one
example: Write #1,
<br>
gives:
# LitDI2 0x0001
# Sharp
# WriteChan
# PrintNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3031-L3048" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printnl(self):
    &#34;&#34;&#34;
    really not sure about this one
    example: Write #1,     
    gives:
         # LitDI2 0x0001
         # Sharp
         # WriteChan
         # PrintNL
    &#34;&#34;&#34;
    elmts = []
    while self.opstack.size() &gt;= 1:
        elmts.append(self.opstack.pop())
    elmts = elmts[::-1]
    val = elmts[0]
    for elmt in elmts[1:]:
        val += &#39; &#39; + elmt
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printobj"><code class="name flex">
<span>def <span class="ident">printobj</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>appears to call the print method of an object
example:
Debug.Print i
gives:
# Debug
# PrintObj
# Ld i
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3050-L3064" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printobj(self):
    &#34;&#34;&#34;
    appears to call the print method of an object
    example:  Debug.Print i
    gives:
         # Debug
         # PrintObj
         # Ld i
         # PrintItemNL
    &#34;&#34;&#34;
    if self.opstack.top() == &#39;MeImplicit&#39;:
        self.opstack.pop()
        self.opstack.push(&#39;Print&#39;)
    else:
        self.opstack.push(self.opstack.pop() + &#39;.Print&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printsemi"><code class="name flex">
<span>def <span class="ident">printsemi</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a semicolon is used in Print
example: Debug.Print Spc(30); "Thirty spaces later&hellip;
gives:
# Debug
# PrintObj
# LitDI2 0x001E
# PrintSpc
# PrintSemi
# LitStr 0x0016 "Thirty spaces later&hellip;"
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3066-L3079" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printsemi(self, *args):
    &#34;&#34;&#34;
    command used when a semicolon is used in Print
    example: Debug.Print Spc(30); &#34;Thirty spaces later...
    gives:
         # Debug
         # PrintObj
         # LitDI2 0x001E
         # PrintSpc
         # PrintSemi
         # LitStr 0x0016 &#34;Thirty spaces later...&#34;
         # PrintItemNL
    &#34;&#34;&#34;
    self.opstack.push(&#39;;&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printspc"><code class="name flex">
<span>def <span class="ident">printspc</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when SPC(n) is used in Print
example: Debug.Print Spc(30); "Thirty spaces later&hellip;
gives:
# Debug
# PrintObj
# LitDI2 0x001E
# PrintSpc
# PrintSemi
# LitStr 0x0016 "Thirty spaces later&hellip;"
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3081-L3094" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printspc(self):
    &#34;&#34;&#34;
    command used when SPC(n) is used in Print
    example: Debug.Print Spc(30); &#34;Thirty spaces later...
    gives:
         # Debug
         # PrintObj
         # LitDI2 0x001E
         # PrintSpc
         # PrintSemi
         # LitStr 0x0016 &#34;Thirty spaces later...&#34;
         # PrintItemNL
    &#34;&#34;&#34;
    self.opstack.push(&#39;Spc(&#39; + self.opstack.pop() + &#39;)&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printtab"><code class="name flex">
<span>def <span class="ident">printtab</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when Tab(n) is used in Print
example: Debug.Print Tab(30); "Thirty spaces later&hellip;
gives:
# Debug
# PrintObj
# LitDI2 0x001E
# PrintTab
# PrintSemi
# LitStr 0x0016 "Thirty spaces later&hellip;"
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3096-L3109" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printtab(self, *args):
    &#34;&#34;&#34;
    command used when Tab(n) is used in Print
    example: Debug.Print Tab(30); &#34;Thirty spaces later...
    gives:
         # Debug
         # PrintObj
         # LitDI2 0x001E
         # PrintTab
         # PrintSemi
         # LitStr 0x0016 &#34;Thirty spaces later...&#34;
         # PrintItemNL
    &#34;&#34;&#34;
    self.opstack.push(&#39;Tab(&#39; + self.opstack.pop() + &#39;)&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.printtabcomma"><code class="name flex">
<span>def <span class="ident">printtabcomma</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when Tab with no arg is used in Print
example: Debug.Print Tab, "Thirty spaces later&hellip;
gives:
# Debug
# PrintObj
# PrintTabComma
# PrintComma
# LitStr 0x0016 "Thirty spaces later&hellip;"
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3111-L3123" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def printtabcomma(self):
    &#34;&#34;&#34;
    command used when Tab with no arg is used in Print
    example: Debug.Print Tab, &#34;Thirty spaces later...
    gives:
         # Debug
         # PrintObj
         # PrintTabComma
         # PrintComma
         # LitStr 0x0016 &#34;Thirty spaces later...&#34;
         # PrintItemNL
    &#34;&#34;&#34;
    self.opstack.push(&#39;Tab&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.pset"><code class="name flex">
<span>def <span class="ident">pset</span></span>(<span>self, numparams)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when the pset method of an object is called
example: Me.PSet (intI, sngMidPt)
gives:
# Ld intI
# Ld sngMidPt
# LitDI2 0x0000
# Ld id_FFFF
# PSet 0x0002</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3125-L3152" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def pset(self, numparams):
    &#34;&#34;&#34;
    command used when the pset method of an object is called
    example: Me.PSet (intI, sngMidPt)
    gives:
         # Ld intI
         # Ld sngMidPt
         # LitDI2 0x0000
         # Ld id_FFFF
         # PSet 0x0002
    &#34;&#34;&#34;
    val = self.opstack.pop() + &#39;.PSet(&#39;
    first_arg = self.opstack.pop()
    if first_arg != &#39;0&#39;:
        val += first_arg + &#39;, &#39;
        
    nb_args = int(numparams, 16)
    params = []
    if nb_args &gt; 0:
        for i in range(nb_args):
            params.append(self.opstack.pop())
        params = params[::-1]

        val += params[0]
        for param in params[1:]:
            val = val + &#39;, &#39; + param
    val +=&#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.putrec"><code class="name flex">
<span>def <span class="ident">putrec</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command to Put to a channel with a record: Put channel, record, var
example: Put #1, RecordNumber, MyRecord
gives:
# LitDI2 0x0001
# Sharp
# Ld RecordNumber
# Ld MyRecord
# PutRec</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3154-L3168" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def putrec(self):
    &#34;&#34;&#34;
    command to Put to a channel with a record: Put channel, record, var
    example: Put #1, RecordNumber, MyRecord
    gives:
         # LitDI2 0x0001
         # Sharp
         # Ld RecordNumber
         # Ld MyRecord
         # PutRec
    &#34;&#34;&#34;
    record = self.opstack.pop()
    record_num = self.opstack.pop()
    chan = self.opstack.pop()
    self.opstack.push(F&#39;Put {chan}, {record_num}, {record}&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.quoterem"><code class="name flex">
<span>def <span class="ident">quoterem</span></span>(<span>self, val1, lenvar, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling comments definition with '
multiple cases:
example : MsgBox "toto" 'a message to send
gives:
# LitStr 0x0004 "toto"
# ArgsCall MsgBox 0x0001
# QuoteRem 0x000F 0x11</p>
<p>example : TODO macaroni
gives: TODO macaroni</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3170-L3189" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def quoterem(self, val1, lenvar, *args):
    &#34;&#34;&#34;
    command handling comments definition with &#39;
    multiple cases:
    example : MsgBox &#34;toto&#34; &#39;a message to send
    gives:
         # LitStr 0x0004 &#34;toto&#34;
         # ArgsCall MsgBox 0x0001
         # QuoteRem 0x000F 0x11

    example : TODO macaroni
    gives: TODO macaroni
    &#34;&#34;&#34;
    val = &#34;&#39;&#34; + args[0][1:]
    for arg in args[1:] :
        val += &#39; &#39; + arg
    val = val[:-1]
    if self.opstack.size() != 0:
        val = self.opstack.pop() + &#39; &#39; + val
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.redim"><code class="name flex">
<span>def <span class="ident">redim</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when redim function is used
example : ReDim temp(4)
gives:
# OptionBase
# LitDI2 0x0004
# Redim temp 0x0001 (As Variant)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3192-L3241" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def redim(self, *args):
    &#34;&#34;&#34;
    command used when redim function is used
    example : ReDim temp(4)
    gives:
         # OptionBase
         # LitDI2 0x0004
         # Redim temp 0x0001 (As Variant)
    &#34;&#34;&#34;
    val = &#39;&#39;
    args = list(args)
    preserve = False
    if args[0] == &#39;(Preserve)&#39;:
        args.pop(0)
        preserve = True

    nb_params = int(args[1], 16)

    values = []
    # gather all stack
    while self.opstack.size() &gt; 0:
        values.append(self.opstack.pop())
    values = values[::-1]

    if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
        val = values.pop(0) + &#39;, &#39; + args[0] + &#39;(&#39;
    else:
        val += &#39;ReDim &#39;
        if preserve:
            val += &#39;Preserve &#39;
        val += args[0] + &#39;(&#39;
        
    curr_val1 = values.pop(0)
    curr_val2 = values.pop(0)
    if curr_val1 == &#39;OptionBase&#39;:
        val += curr_val2 
    else:
        val += curr_val1 + &#39; To &#39; + curr_val2 

    while len(values) &gt; 0:
        val += &#39;, &#39;
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

    val += &#39;)&#39;
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.redimas"><code class="name flex">
<span>def <span class="ident">redimas</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when a redim is defined with a As in the end
example: ReDim mytab(50) As Double
gives:
# OptionBase
# LitDI2 0x0032
# RedimAs mytab 0x0001 (As Double)</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3244-L3299" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def redimas(self, *args):
    &#34;&#34;&#34;
    command used when a redim is defined with a As in the end
    example: ReDim mytab(50) As Double
    gives:
         # OptionBase
         # LitDI2 0x0032
         # RedimAs mytab 0x0001 (As Double)
    &#34;&#34;&#34;
    val = &#39;&#39;
    args = list(args)
    preserve = False
    if args[0] == &#39;(Preserve)&#39;:
        args.pop(0)
        preserve = True

    nb_params = int(args[1], 16)

    values = []
    # gather all stack
    while self.opstack.size() &gt; 0:
        values.append(self.opstack.pop())
    values = values[::-1]

    if values[0].startswith(&#39;ReDim&#39;): # in case redim of multiple variables
        val = values.pop(0) + &#39;, &#39; + args[0] + &#39;(&#39;
    else:
        val += &#39;ReDim &#39;
        if preserve:
            val += &#39;Preserve &#39;
        val += args[0] + &#39;(&#39;
        
    curr_val1 = values.pop(0)
    curr_val2 = values.pop(0)
    if curr_val1 == &#39;OptionBase&#39;:
        val += curr_val2 
    else:
        val += curr_val1 + &#39; To &#39; + curr_val2 

    while len(values) &gt; 0:
        val += &#39;, &#39;
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

    val += &#39;)&#39;

    args.pop(0) #remove var
    args.pop(0) # remove nb_params
    if len(args)&gt; 0: # do we have smthng like &#34;(As &lt;type&gt;)&#34;
        if args[-1] != &#39;Variant)&#39;:
            val += &#39; &#39; + args[0][1:] + &#39; &#39; + args[1][:-1]
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.reparse"><code class="name flex">
<span>def <span class="ident">reparse</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>opcode used when a non valid statement is employed</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3301-L3309" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def reparse(self, *args):
    &#34;&#34;&#34;
    opcode used when a non valid statement is employed
    &#34;&#34;&#34;
    val = args[1][1:]
    for arg in args[2:]:
        val += &#39; &#39; + arg
    val = val[:-1] # avoid double quotes
    self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.rem"><code class="name flex">
<span>def <span class="ident">rem</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command for Rem keyword
example: Rem This entire line is a comment
gives:
# Rem 0x001F " This entire line is a comment."</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3312-L3322" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def rem(self, *args):
    &#34;&#34;&#34;
    command for Rem keyword
    example: Rem This entire line is a comment
    gives:  # Rem 0x001F &#34; This entire line is a comment.&#34;
    &#34;&#34;&#34;
    val = args[2] # avoid space+double quote
    for arg in args[3:]:
        val += &#39; &#39; + arg
    val = val[:-1] #avoid double quote
    self.opstack.push(&#39;Rem &#39; + val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.resume"><code class="name flex">
<span>def <span class="ident">resume</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when resume keyword is used
example1: Resume
gives: # Resume
example2: Resume Next
gives: # Resume (Next)
example3: Resume titi
gives: # Resume titi</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3325-L3341" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def resume(self, *args):
    &#34;&#34;&#34;
    command used when resume keyword is used 
    example1: Resume
    gives: # Resume
    example2: Resume Next
    gives: # Resume (Next)
    example3: Resume titi
    gives: # Resume titi
    &#34;&#34;&#34;
    if args == ():
        self.opstack.push(&#39;Resume&#39;)
    else:
        if args[0] == &#39;(Next)&#39;:
            self.opstack.push(&#39;Resume Next&#39;)
        else:
            self.opstack.push(&#39;Resume &#39; + args[0])</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.return_"><code class="name flex">
<span>def <span class="ident">return_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3343-L3345" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def return_(self):
    #TODO: comment
    self.opstack.push(&#39;Return&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.rset"><code class="name flex">
<span>def <span class="ident">rset</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command for RSet keyword
example: RSet MyString = "Right-&gt;"
gives:
# LitStr 0x0007 "Right-&gt;"
# Ld MyString
# RSet</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3347-L3358" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def rset(self):
    &#34;&#34;&#34;
    command for RSet keyword
    example: RSet MyString = &#34;Right-&gt;&#34;
    gives:
         # LitStr 0x0007 &#34;Right-&gt;&#34;
         # Ld MyString
         # RSet
    &#34;&#34;&#34;
    var = self.opstack.pop()
    val = self.opstack.pop()
    self.opstack.push(&#39;RSet &#39; + var + &#39; = &#39; + val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.scale"><code class="name flex">
<span>def <span class="ident">scale</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command used when an object scale method is used
example: Me.Scale
gives:
# LitDI2 0x0000
# LitDI2 0x0000
# Ld sngNewH
# Ld sngNewV
# Ld id_FFFF
# Scale 0x0000
TODO: what to do with this command?</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3360-L3373" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def scale(self, *args):
    &#34;&#34;&#34;
    command used when an object scale method is used
    example: Me.Scale 
    gives:
         # LitDI2 0x0000
         # LitDI2 0x0000
         # Ld sngNewH
         # Ld sngNewV
         # Ld id_FFFF
         # Scale 0x0000
    TODO: what to do with this command?
    &#34;&#34;&#34;
    raise Pcode2codeException(&#39;not implemented scale&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.seek"><code class="name flex">
<span>def <span class="ident">seek</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>opcode used when seek is used to search in a file
example: Seek #1, 2
gives:
# LitDI2 0x0001
# Sharp
# LitDI2 0x0002
# Seek</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3375-L3386" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def seek(self):
    &#34;&#34;&#34;
    opcode used when seek is used to search in a file
    example: Seek #1, 2
    gives:
         # LitDI2 0x0001
         # Sharp
         # LitDI2 0x0002
         # Seek
    &#34;&#34;&#34;
    data = self.opstack.pop()
    self.opstack.push(&#39;Seek &#39; + self.opstack.pop() + &#39;, &#39; + data)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.selectcase"><code class="name flex">
<span>def <span class="ident">selectcase</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling a "select case" definition against a variable
example : Select Case x
gives:
# Ld x
# SelectCase</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3388-L3397" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def selectcase(self):
    &#34;&#34;&#34;
    command handling a &#34;select case&#34; definition against a variable
    example : Select Case x
    gives:
         # Ld x
         # SelectCase
    &#34;&#34;&#34;
    self.opstack.push(&#39;Select Case &#39; + self.opstack.pop())
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.selectis"><code class="name flex">
<span>def <span class="ident">selectis</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3399-L3400" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def selectis(self, *args):
    raise Pcode2codeException(&#39;not implemented selectis&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.selecttype"><code class="name flex">
<span>def <span class="ident">selecttype</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3402-L3403" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def selecttype(self, *args):
    raise Pcode2codeException(&#39;not implemented selecttype&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.setstmt"><code class="name flex">
<span>def <span class="ident">setstmt</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3405-L3408" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def setstmt(self):
    # TODO: comment
    #pass on purpose
    pass</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.stack"><code class="name flex">
<span>def <span class="ident">stack</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3410-L3411" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def stack(self, *args):
    raise Pcode2codeException(&#39;not implemented stack&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.stop"><code class="name flex">
<span>def <span class="ident">stop</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3413-L3415" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def stop(self):
    #TODO: comment
    self.opstack.push(&#39;Stop&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.type_"><code class="name flex">
<span>def <span class="ident">type_</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"><p>command for Type keyword, #TODO: beware because it's also used for enum keyword
example: Type EmployeeRecord
gives :
# Type EmployeeRecord</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3417-L3430" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def type_(self, *args):
    &#34;&#34;&#34;
    command for Type keyword, #TODO: beware because it&#39;s also used for enum keyword
    example: Type EmployeeRecord
    gives : 
       # Type EmployeeRecord
    &#34;&#34;&#34;
    if args[0] == &#39;(Private)&#39;:
        self.opstack.push(&#39;Private Type &#39; + args[1])
    elif args[0] == &#39;(Public)&#39;:
        self.opstack.push(&#39;Public Type &#39; + args[1])
    else:
        self.opstack.push(&#39;Type &#39; + args[0])
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.unlock"><code class="name flex">
<span>def <span class="ident">unlock</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command to unlock a record
example: Unlock #1, RecordNumber
gives:
# LitDI2 0x0001
# Sharp
# Ld RecordNumber
# LitDefault
# Unlock</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3432-L3454" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def unlock(self):
    &#34;&#34;&#34;
    command to unlock a record
    example: Unlock #1, RecordNumber
    gives:
         # LitDI2 0x0001
         # Sharp
         # Ld RecordNumber
         # LitDefault
         # Unlock
    &#34;&#34;&#34;
    if self.opstack.size() == 3:
        last_record = self.opstack.pop()
        first_record = self.opstack.pop()
        chan = self.opstack.pop()
        self.opstack.push(&#39;Unlock &#39; + chan + &#39;, &#39; + first_record + &#39; To &#39; + last_record)
    elif self.opstack.size() == 2:
        record = self.opstack.pop()
        chan = self.opstack.pop()
        self.opstack.push(&#39;Unlock &#39; + chan + &#39;, &#39; + record)
    elif self.opstack.size() == 1:
        chan = self.opstack.pop()
        self.opstack.push(&#39;Unlock &#39; + chan)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.vardefn"><code class="name flex">
<span>def <span class="ident">vardefn</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3476-L3581" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def vardefn(self, *args):      
    ending =&#39;&#39;
    args = list(args) #quite ugly, but fu...
    if args[0] == &#39;(WithEvents)&#39;:
        var = args.pop(0)[1:-1] + &#39; &#39; + args.pop(0)
    else:
        var = args.pop(0)

    spaces = 1
    if len(args) &gt; 0:
        if args[-1].startswith(&#39;0x&#39;):
            spaces = int(args.pop(-1),16) #TODO: treat spaces there
        ending = args[0]
        for arg in args[1:]:
            ending += &#39; &#39; + arg
        ending = &#39; &#39; + ending[1:-1]
        

    # first we check if this is only one literal definition
    # in this case, we get Dim definitions and we are all set up
    stacktop = self.opstack.pop()

    if stacktop == &#39;DimImplicit&#39;: #case where dim is implicit, 
        val = var + ending  # we have pushed in this case &#39;DimImplicit&#39; on stack
        self.opstack.push(val)
        return

    # in this case we have a single variable declaration
    decls = [&#39;Dim&#39;, &#39;Private&#39;, &#39;Public&#39;, &#39;Protected&#39;, &#39;Friend&#39;, &#39;Protected Friend&#39;, &#39;Shared&#39;, &#39;Shadows&#39;, &#39;Static&#39;, &#39;ReadOnly&#39;]
    if stacktop in decls:
        val = stacktop + &#39; &#39; + var + ending
        self.opstack.push(val)
        return

    else:
        # in this case, our variable is either a table, or there is also some const declarations
        # if so, walk the stack and check for declaration
        self.opstack.push(stacktop)
        values = []

        # gather all stack
        while self.opstack.size() &gt; 0:
            values.append(self.opstack.pop())
        values = values[::-1]

        # if we have multiple vardefn with dim, then we are here
        # because all previous vardef should have been pushed correctly on stack
        if len(values) == 1 :
            for decl in decls:
                if values[0].startswith(decl):
                    val = values[0] +&#39;, &#39; + var + ending
                    self.opstack.push(val)
                    return
                
        # if const is used for declaration, then a value is attributed to variable
        # appears somehow not possible to declare a table as const, so far so good, no need to check this case
        if &#39;Const&#39; in values[0]:
            val = values.pop(0)
            end_val = &#39; = &#39; + values.pop(0)
            if len(values) &gt; 0:
                # how to say what is dimensions to what is attribution
                #val = &#39;Undefined variable declaration&#39;
                raise Pcode2codeException(&#39;undefined variable declaration&#39;)
            else:
                val = val + &#39; &#39; + var + ending + end_val
            self.opstack.push(val)
            return
        
        #so here we have a table
        val = &#39;&#39;
        if values[0] in decls: #first we check if this is the first definition
            val += values.pop(0) + &#39; &#39; + var + &#39;(&#39;
        elif values[0] == &#39;DimImplicit&#39;: #not sure about this one
            values.pop(0)
            val += var + &#39;(&#39;
        else:
            #next we check for a previous declaration
            prev_decl = False
            for decl in decls:
                if values[0].startswith(decl):
                    val += values.pop(0) +&#39;, &#39; + var + &#39;(&#39;
                    prev_decl = True
            if prev_decl is False: #in this case, nothing before
                val+= var + &#39;(&#39;

        #first occurence
        curr_val1 = values.pop(0)
        curr_val2 = values.pop(0)
        if curr_val1 == &#39;OptionBase&#39;:
            val += curr_val2 
        else:
            val += curr_val1 + &#39; To &#39; + curr_val2 

        #other occurences
        while len(values) &gt; 0:
            val += &#39;, &#39;
            curr_val1 = values.pop(0)
            curr_val2 = values.pop(0)
            if curr_val1 == &#39;OptionBase&#39;:
                val += curr_val2 
            else:
                val += curr_val1 + &#39; To &#39; + curr_val2 

        #closing
        val += &#39;)&#39; + ending
        self.opstack.push(val)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.wend"><code class="name flex">
<span>def <span class="ident">wend</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling end of while loop "Wend"
example: Wend
gives :
# Wend</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3583-L3591" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def wend(self):
    &#34;&#34;&#34;
    command handling end of while loop &#34;Wend&#34;
    example: Wend
    gives : 
          # Wend
    &#34;&#34;&#34;
    self.opstack.push(&#39;Wend&#39;)
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.while_"><code class="name flex">
<span>def <span class="ident">while_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling "while" loops definitions
example: While numero &lt;= 12
gives:
# Ld numero
# LitDI2 0x000C
# Le
# While</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3593-L3604" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def while_(self):
    &#34;&#34;&#34;
    command handling &#34;while&#34; loops definitions
    example: While numero &lt;= 12
    gives:
         # Ld numero
         # LitDI2 0x000C
         # Le
         # While
    &#34;&#34;&#34;
    self.opstack.push(&#39;While &#39; + self.opstack.pop())
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.with_"><code class="name flex">
<span>def <span class="ident">with_</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command handling "with" definitions
example: with theWindow
gives:
# StartWithExpr
# Ld theWindow
# With</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3606-L3616" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def with_(self):
    &#34;&#34;&#34;
    command handling &#34;with&#34; definitions
    example: with theWindow 
    gives:
         # StartWithExpr
         # Ld theWindow
         # With
    &#34;&#34;&#34;
    self.opstack.push(&#39;With &#39; + self.opstack.pop())
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.writechan"><code class="name flex">
<span>def <span class="ident">writechan</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command defining "write" to a channel
example: Write #1, MyBool; " is a Boolean value"
gives:
# LitDI2 0x0001
# Sharp
# WriteChan
# Ld MyBool
# PrintItemSemi
# LitStr 0x0013 " is a Boolean value"
# PrintItemNL</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3618-L3631" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def writechan(self):
    &#34;&#34;&#34;
    command defining &#34;write&#34; to a channel
    example: Write #1, MyBool; &#34; is a Boolean value&#34;
    gives:
         # LitDI2 0x0001
         # Sharp
         # WriteChan
         # Ld MyBool
         # PrintItemSemi
         # LitStr 0x0013 &#34; is a Boolean value&#34;
         # PrintItemNL
    &#34;&#34;&#34;
    self.opstack.push(&#39;Write &#39; +self.opstack.pop() + &#39;,&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.constfuncexpr"><code class="name flex">
<span>def <span class="ident">constfuncexpr</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3633-L3634" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def constfuncexpr(self, *args):
    raise Pcode2codeException(&#39;not implemented constfuncexpr&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lbconst"><code class="name flex">
<span>def <span class="ident">lbconst</span></span>(<span>self, var)</span>
</code></dt>
<dd>
<section class="desc"><p>opcode used when #Const is used
example: #Const x = y
gives:
# LbMark
# Ld B
# LbConst a</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3636-L3645" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lbconst(self, var):
    &#34;&#34;&#34;
    opcode used when #Const is used
    example: #Const x = y
    gives:
         # LbMark
         # Ld B
         # LbConst a
    &#34;&#34;&#34;
    self.opstack.push(&#39;#Const &#39; + var + &#39; = &#39; + self.opstack.pop())</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lbif"><code class="name flex">
<span>def <span class="ident">lbif</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>opcode used when #If is used
example: #If a = b Then
gives:
# LbMark
# Ld a
# Ld B
# Eq
# LbIf</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3647-L3659" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lbif(self):
    &#34;&#34;&#34;
    opcode used when #If is used
    example: #If a = b Then
    gives:
         # LbMark
         # Ld a
         # Ld B
         # Eq
         # LbIf
    &#34;&#34;&#34;
    self.opstack.push(&#39;#If &#39; + self.opstack.pop() + &#39; Then&#39;)
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lbelse"><code class="name flex">
<span>def <span class="ident">lbelse</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>opcode used when #Else is used
example: #Else
gives: lbElse</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3661-L3669" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lbelse(self):
    &#34;&#34;&#34;
    opcode used when #Else is used
    example: #Else 
    gives: lbElse
    &#34;&#34;&#34;
    self.opstack.push(&#39;#Else&#39;)
    self.indentlevel = self.indentlevel - 1
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lbelseif"><code class="name flex">
<span>def <span class="ident">lbelseif</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>opcode used when #Elseif is used
example: #ElseIf a = c Then
gives:
# LbMark
# Ld a
# Ld c
# Eq
# LbElseIf</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3671-L3684" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lbelseif(self):
    &#34;&#34;&#34;
    opcode used when #Elseif is used
    example: #ElseIf a = c Then
    gives:
         # LbMark
         # Ld a
         # Ld c
         # Eq
         # LbElseIf
    &#34;&#34;&#34;
    self.opstack.push(&#39;#ElseIf &#39; + self.opstack.pop() + &#39; Then&#39;)
    self.indentlevel = self.indentlevel - 1
    self.indentincrease_future = True</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lbendif"><code class="name flex">
<span>def <span class="ident">lbendif</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>opcode used when "#End If" is used
example: #End If
gives: #LbEndIf</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3686-L3693" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lbendif(self):
    &#34;&#34;&#34;
    opcode used when &#34;#End If&#34; is used
    example: #End If
    gives: #LbEndIf
    &#34;&#34;&#34;
    self.opstack.push(&#39;#End If&#39;)
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.lbmark"><code class="name flex">
<span>def <span class="ident">lbmark</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>appears to be used to indicate the start of a lb statement, appears quite useless</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3695-L3699" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def lbmark(self):
    &#34;&#34;&#34;
    appears to be used to indicate the start of a lb statement, appears quite useless
    &#34;&#34;&#34;
    pass #pass on purposes</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endforvariable"><code class="name flex">
<span>def <span class="ident">endforvariable</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>This command ends out a for loop variable definition. Gives nothing interesting in fact
example: TODO macaroni
gives: TODO macaroni</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3701-L3707" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endforvariable(self):
    &#34;&#34;&#34;
    This command ends out a for loop variable definition. Gives nothing interesting in fact
    example: TODO macaroni
    gives: TODO macaroni
    &#34;&#34;&#34;
    #pass on purposes</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.startforvariable"><code class="name flex">
<span>def <span class="ident">startforvariable</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>This command starts out a for loop variable definition. Gives nothing interesting in fact
example: TODO macaroni
gives: TODO macaroni</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3709-L3715" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def startforvariable(self):
    &#34;&#34;&#34;
    This command starts out a for loop variable definition. Gives nothing interesting in fact
    example: TODO macaroni
    gives: TODO macaroni
    &#34;&#34;&#34;
    #pass on purposes</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.newredim"><code class="name flex">
<span>def <span class="ident">newredim</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3717-L3718" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def newredim(self, *args):
    raise Pcode2codeException(&#39;not implemented newredim&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.startwithexpr"><code class="name flex">
<span>def <span class="ident">startwithexpr</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>used like startforvariable, eg, simply an indicator of when a with variable is declared.
pretty useless for us.
example: With theWindow
gives:
# StartWithExpr
# Ld theWindow
# With</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3720-L3730" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def startwithexpr(self):
    &#34;&#34;&#34;
    used like startforvariable, eg, simply an indicator of when a with variable is declared.
    pretty useless for us.
    example: With theWindow
    gives:
         # StartWithExpr
         # Ld theWindow
         # With
    &#34;&#34;&#34;
    #pass on purposes</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.setorst"><code class="name flex">
<span>def <span class="ident">setorst</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3732-L3733" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def setorst(self, *args):
    raise Pcode2codeException(&#39;not implemented setorst&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.endenum"><code class="name flex">
<span>def <span class="ident">endenum</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>command to end an enum
example: End Enum
gives:
#EndEnum</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3735-L3743" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def endenum(self):
    &#34;&#34;&#34;
    command to end an enum
    example: End Enum
    gives:
         #EndEnum
    &#34;&#34;&#34;
    self.opstack.push(&#39;End Enum&#39;)
    self.indentlevel = self.indentlevel - 1</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.illegal"><code class="name flex">
<span>def <span class="ident">illegal</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3745-L3746" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def illegal(self, *args):
    raise Pcode2codeException(&#39;not implemented illegal&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.newline"><code class="name flex">
<span>def <span class="ident">newline</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>defines a blank line. Used for internal processing, for blank streams and lines</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3748-L3752" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def newline(self):
    &#34;&#34;&#34;
    defines a blank line. Used for internal processing, for blank streams and lines
    &#34;&#34;&#34;
    self.opstack.push(&#39;&#39;)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.clearstack"><code class="name flex">
<span>def <span class="ident">clearstack</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3754-L3755" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def clearstack(self):
    self.opstack.clearstack()</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.getstacktop"><code class="name flex">
<span>def <span class="ident">getstacktop</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3757-L3758" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def getstacktop(self):
    return self.opstack.top()</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.getstackpop"><code class="name flex">
<span>def <span class="ident">getstackpop</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3760-L3761" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def getstackpop(self):
    return self.opstack.pop()</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.getstacksize"><code class="name flex">
<span>def <span class="ident">getstacksize</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3763-L3764" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def getstacksize(self):
    return self.opstack.size()</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.increaseindentlevel_future"><code class="name flex">
<span>def <span class="ident">increaseindentlevel_future</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>when we increase the indent level, we need to first print out the line, and then to increase the indent level.
to do so, when a line has been printed, this function checks if the indent level need to be increased and do so.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3766-L3775" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def increaseindentlevel_future(self):
    &#34;&#34;&#34;
    when we increase the indent level, we need to first print out the line, and then to increase the indent level. 
    to do so, when a line has been printed, this function checks if the indent level need to be increased and do so.
    &#34;&#34;&#34;
    if self.unindented &gt; 0:
        self.unindented -= 1
    elif self.indentincrease_future:
        self.indentlevel = self.indentlevel + 1
    self.indentincrease_future = False</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.getindentlevel"><code class="name flex">
<span>def <span class="ident">getindentlevel</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>function retrieving the class indentlevel parameter, used to print out code with correct indent</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3777-L3781" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def getindentlevel(self):
    &#34;&#34;&#34;
     function retrieving the class indentlevel parameter, used to print out code with correct indent
    &#34;&#34;&#34;
    return self.indentlevel</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.hasbos"><code class="name flex">
<span>def <span class="ident">hasbos</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3783-L3784" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def hasbos(self):
    return self.has_bos</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Operations.resethasbos"><code class="name flex">
<span>def <span class="ident">resethasbos</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3786-L3787" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def resethasbos(self):
    self.has_bos = False</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Parser"><code class="flex name class">
<span>class <span class="ident">Parser</span></span>
<span>(</span><span>myinput)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3789-L3937" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Parser:

    def __init__(self, myinput):
        self.myinput = myinput  # input to be processed, is always a dump of pcodedmp module there
        self.opstack = Stack()  # vba bytecode is somewhat stack based, so we declare a new one 
        self.operations = Operations(self.opstack) # all operations that can be found in vba bytecode
        self.output = &#39;&#39;        # the output of global processing
        self.output_queue = []
        self.unindented = 0

    def queueLineOutput(self, line, linenum, print_linenum=False, has_end=True):
        self.output_queue.append((line, linenum, print_linenum, has_end))

    def addlineOutput(self, line, linenum, print_linenum=False, has_end=True, _checking_queue=False):
        &#34;&#34;&#34;
            Because we can choose what is the output for our module, this function somehow bufferize the
            output before it&#39;s printed in the latter.
        &#34;&#34;&#34;
        if not line.strip():
            return
        while not _checking_queue and self.output_queue:
            self.addlineOutput(*self.output_queue.pop(), True)
        if print_linenum:
            self.output += str(linenum) + &#39;: &#39;           
        if not has_end:
            self.output += line
            return
        self.output += line + &#39;\n&#39; 

    def getOutput(self):
        &#34;&#34;&#34;
        simply a getter to output, used in the end of global processing
        &#34;&#34;&#34;
        return self.output

    def parseInput(self):
        &#34;&#34;&#34;
            Function parsing pcodedmp dump to create a dictionary of all lines of the input with the operation lines associated.
            Basically, to explain, a pcodedmp dump would look like so:
               &#39; Line #7:
               &#39;   Dim 
               &#39;   VarDefn hiz7dgus (As String)
            Here the first line gives out the line number, and the rest are operation lines.
        &#34;&#34;&#34;
        splittedInput = self.myinput.splitlines()
        lines = {}
        i = 0
        started = False
        streams = {}
        laststream = None
        opelinesblock = []
        # we parse each lines, and cut them by line blocks, to put them in &#34;lines&#34;
        #TODO: simplify
        for inputLine in splittedInput:
            inputLine = inputLine.strip()

            if &#39;VBA/&#39; in inputLine and inputLine.endswith(&#39;bytes&#39;): # here we have a new stream in the document
                if laststream is None: #eg first occurence
                    laststream = inputLine
                else:
                    if opelinesblock == []:
                        opelinesblock = [&#39;NewLine&#39;]
                    lines[i] = opelinesblock
                    streams[laststream] = lines
                    opelinesblock = []
                    i = 0
                    lines = {}
                    started = False
                    laststream = inputLine
            if inputLine.startswith(&#39;Line #&#39;): # here is our new line block
                started = True
                if not inputLine.startswith(&#39;Line #0&#39;):
                    
                    if opelinesblock == []:             # when line is blank, it still appears in dump
                        opelinesblock = [&#39;NewLine&#39;]     # so we treat it with a special new operation
                                                        # saying line is blank
                    lines[i] = opelinesblock
                    i+=1
                opelinesblock = []
            else:
                if started:
                    opelinesblock.append(inputLine)

        if opelinesblock == []:
            opelinesblock = [&#39;NewLine&#39;]
            
        lines[i] = opelinesblock
        streams[laststream] = lines

        self.myinput = streams


    def parseOpLine(self, inputLine):
        &#34;&#34;&#34;
            function to parse an operation line.
            to avoid using costly regexp, we split each operation line. The first element is always the operation
            to do, and the rest is potential args. In case there are args, they will be reconstructed by the underlying operation.
        &#34;&#34;&#34;
        linelist = inputLine.split()
        ope = linelist[0]
        args = linelist[1:]
        func = self.operations.ops[ope]
        func(*args)

    def processInput(self, print_linenum):
        &#34;&#34;&#34;
            When the input has been &lt;&lt;parsed&gt;&gt;, this function process it to disassemble the input, by calling parseOpLine for each line. 
            It is basically only a printing function.
            args: 
              - print_linenum: boolean indicating if line numbers should be printed in the output or not. Please refer to function named &#34;process&#34;
        &#34;&#34;&#34;
        for stream in self.myinput.keys():
            if stream:
                self.queueLineOutput(&#39;# DECOMPILED STREAM : &#39; + stream, 0)
            unindented = 0
            for linenum, oplines in self.myinput[stream].items():
                for line in oplines:
                    if line.startswith(&#39;FuncDefn&#39;):
                        unindented += 1
                    if line.startswith(&#39;EndFunc&#39;) or line.startswith(&#39;EndSub&#39;):
                        unindented -= 1
            self.operations.unindented = unindented
            for linenum in self.myinput[stream]:
                try:
                    self.operations.clearstack()
                    for opline in self.myinput[stream][linenum]:
                        self.parseOpLine(opline)
                    if self.operations.hasbos():
                        output_parts = []
                        while self.operations.getstacksize() &gt; 0:
                            output_parts.append(self.operations.getstackpop())
                        output_parts = output_parts[::-1]
                        self.addlineOutput(self.operations.getindentlevel() * &#39;  &#39;, linenum, print_linenum, False)
                        for part in output_parts[:-1]:
                            self.addlineOutput(part + &#39; &#39;, linenum, has_end=False)
                        self.addlineOutput(output_parts[-1], linenum)
                        self.operations.resethasbos()
                    else:
                        self.addlineOutput(self.operations.getindentlevel() * &#39;  &#39; + self.operations.getstacktop(), linenum, print_linenum)
                except Pcode2codeException as e:
                    self.addlineOutput(&#34;&#39; pcode2code, cannot process line &#34;+ str(linenum) + &#39; : &#39; + str(e), linenum, print_linenum)
                    for opline in self.myinput[stream][linenum]:
                        self.addlineOutput(&#34;&#39;\t# &#34; + opline, linenum)
                except Exception as e:
                    self.addlineOutput(&#34;&#39; a generic exception occured at line &#34; + str(linenum) + &#34;: &#34; + str(e), linenum, print_linenum)
                    for opline in self.myinput[stream][linenum]:
                        self.addlineOutput(&#34;&#39;\t# &#34; + opline, linenum)
                self.operations.increaseindentlevel_future()
            self.output_queue.clear()</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="refinery.lib.thirdparty.pcode2code.Parser.queueLineOutput"><code class="name flex">
<span>def <span class="ident">queueLineOutput</span></span>(<span>self, line, linenum, print_linenum=False, has_end=True)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3799-L3800" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def queueLineOutput(self, line, linenum, print_linenum=False, has_end=True):
    self.output_queue.append((line, linenum, print_linenum, has_end))</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Parser.addlineOutput"><code class="name flex">
<span>def <span class="ident">addlineOutput</span></span>(<span>self, line, linenum, print_linenum=False, has_end=True)</span>
</code></dt>
<dd>
<section class="desc"><p>Because we can choose what is the output for our module, this function somehow bufferize the
output before it's printed in the latter.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3802-L3816" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def addlineOutput(self, line, linenum, print_linenum=False, has_end=True, _checking_queue=False):
    &#34;&#34;&#34;
        Because we can choose what is the output for our module, this function somehow bufferize the
        output before it&#39;s printed in the latter.
    &#34;&#34;&#34;
    if not line.strip():
        return
    while not _checking_queue and self.output_queue:
        self.addlineOutput(*self.output_queue.pop(), True)
    if print_linenum:
        self.output += str(linenum) + &#39;: &#39;           
    if not has_end:
        self.output += line
        return
    self.output += line + &#39;\n&#39; </code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Parser.getOutput"><code class="name flex">
<span>def <span class="ident">getOutput</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>simply a getter to output, used in the end of global processing</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3818-L3822" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def getOutput(self):
    &#34;&#34;&#34;
    simply a getter to output, used in the end of global processing
    &#34;&#34;&#34;
    return self.output</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Parser.parseInput"><code class="name flex">
<span>def <span class="ident">parseInput</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"><p>Function parsing pcodedmp dump to create a dictionary of all lines of the input with the operation lines associated.
Basically, to explain, a pcodedmp dump would look like so:
' Line #7:
'
Dim
'
VarDefn hiz7dgus (As String)
Here the first line gives out the line number, and the rest are operation lines.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3824-L3878" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def parseInput(self):
    &#34;&#34;&#34;
        Function parsing pcodedmp dump to create a dictionary of all lines of the input with the operation lines associated.
        Basically, to explain, a pcodedmp dump would look like so:
           &#39; Line #7:
           &#39;   Dim 
           &#39;   VarDefn hiz7dgus (As String)
        Here the first line gives out the line number, and the rest are operation lines.
    &#34;&#34;&#34;
    splittedInput = self.myinput.splitlines()
    lines = {}
    i = 0
    started = False
    streams = {}
    laststream = None
    opelinesblock = []
    # we parse each lines, and cut them by line blocks, to put them in &#34;lines&#34;
    #TODO: simplify
    for inputLine in splittedInput:
        inputLine = inputLine.strip()

        if &#39;VBA/&#39; in inputLine and inputLine.endswith(&#39;bytes&#39;): # here we have a new stream in the document
            if laststream is None: #eg first occurence
                laststream = inputLine
            else:
                if opelinesblock == []:
                    opelinesblock = [&#39;NewLine&#39;]
                lines[i] = opelinesblock
                streams[laststream] = lines
                opelinesblock = []
                i = 0
                lines = {}
                started = False
                laststream = inputLine
        if inputLine.startswith(&#39;Line #&#39;): # here is our new line block
            started = True
            if not inputLine.startswith(&#39;Line #0&#39;):
                
                if opelinesblock == []:             # when line is blank, it still appears in dump
                    opelinesblock = [&#39;NewLine&#39;]     # so we treat it with a special new operation
                                                    # saying line is blank
                lines[i] = opelinesblock
                i+=1
            opelinesblock = []
        else:
            if started:
                opelinesblock.append(inputLine)

    if opelinesblock == []:
        opelinesblock = [&#39;NewLine&#39;]
        
    lines[i] = opelinesblock
    streams[laststream] = lines

    self.myinput = streams</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Parser.parseOpLine"><code class="name flex">
<span>def <span class="ident">parseOpLine</span></span>(<span>self, inputLine)</span>
</code></dt>
<dd>
<section class="desc"><p>function to parse an operation line.
to avoid using costly regexp, we split each operation line. The first element is always the operation
to do, and the rest is potential args. In case there are args, they will be reconstructed by the underlying operation.</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3881-L3891" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def parseOpLine(self, inputLine):
    &#34;&#34;&#34;
        function to parse an operation line.
        to avoid using costly regexp, we split each operation line. The first element is always the operation
        to do, and the rest is potential args. In case there are args, they will be reconstructed by the underlying operation.
    &#34;&#34;&#34;
    linelist = inputLine.split()
    ope = linelist[0]
    args = linelist[1:]
    func = self.operations.ops[ope]
    func(*args)</code></pre>
</details>
</dd>
<dt id="refinery.lib.thirdparty.pcode2code.Parser.processInput"><code class="name flex">
<span>def <span class="ident">processInput</span></span>(<span>self, print_linenum)</span>
</code></dt>
<dd>
<section class="desc"><p>When the input has been &lt;<parsed>&gt;, this function process it to disassemble the input, by calling parseOpLine for each line.
It is basically only a printing function.
args:
- print_linenum: boolean indicating if line numbers should be printed in the output or not. Please refer to function named "process"</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/binref/refinery/blob/4c0004e3a5e038a14f699905f942361689d71fc3/refinery/lib/thirdparty/pcode2code.py#L3893-L3937" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def processInput(self, print_linenum):
    &#34;&#34;&#34;
        When the input has been &lt;&lt;parsed&gt;&gt;, this function process it to disassemble the input, by calling parseOpLine for each line. 
        It is basically only a printing function.
        args: 
          - print_linenum: boolean indicating if line numbers should be printed in the output or not. Please refer to function named &#34;process&#34;
    &#34;&#34;&#34;
    for stream in self.myinput.keys():
        if stream:
            self.queueLineOutput(&#39;# DECOMPILED STREAM : &#39; + stream, 0)
        unindented = 0
        for linenum, oplines in self.myinput[stream].items():
            for line in oplines:
                if line.startswith(&#39;FuncDefn&#39;):
                    unindented += 1
                if line.startswith(&#39;EndFunc&#39;) or line.startswith(&#39;EndSub&#39;):
                    unindented -= 1
        self.operations.unindented = unindented
        for linenum in self.myinput[stream]:
            try:
                self.operations.clearstack()
                for opline in self.myinput[stream][linenum]:
                    self.parseOpLine(opline)
                if self.operations.hasbos():
                    output_parts = []
                    while self.operations.getstacksize() &gt; 0:
                        output_parts.append(self.operations.getstackpop())
                    output_parts = output_parts[::-1]
                    self.addlineOutput(self.operations.getindentlevel() * &#39;  &#39;, linenum, print_linenum, False)
                    for part in output_parts[:-1]:
                        self.addlineOutput(part + &#39; &#39;, linenum, has_end=False)
                    self.addlineOutput(output_parts[-1], linenum)
                    self.operations.resethasbos()
                else:
                    self.addlineOutput(self.operations.getindentlevel() * &#39;  &#39; + self.operations.getstacktop(), linenum, print_linenum)
            except Pcode2codeException as e:
                self.addlineOutput(&#34;&#39; pcode2code, cannot process line &#34;+ str(linenum) + &#39; : &#39; + str(e), linenum, print_linenum)
                for opline in self.myinput[stream][linenum]:
                    self.addlineOutput(&#34;&#39;\t# &#34; + opline, linenum)
            except Exception as e:
                self.addlineOutput(&#34;&#39; a generic exception occured at line &#34; + str(linenum) + &#34;: &#34; + str(e), linenum, print_linenum)
                for opline in self.myinput[stream][linenum]:
                    self.addlineOutput(&#34;&#39;\t# &#34; + opline, linenum)
            self.operations.increaseindentlevel_future()
        self.output_queue.clear()</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="refinery.lib.thirdparty" href="index.html">refinery.lib.thirdparty</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="refinery.lib.thirdparty.pcode2code.Pcode2codeException" href="#refinery.lib.thirdparty.pcode2code.Pcode2codeException">Pcode2codeException</a></code></h4>
</li>
<li>
<h4><code><a title="refinery.lib.thirdparty.pcode2code.Stack" href="#refinery.lib.thirdparty.pcode2code.Stack">Stack</a></code></h4>
<ul class="two-column">
<li><code><a title="refinery.lib.thirdparty.pcode2code.Stack.pop" href="#refinery.lib.thirdparty.pcode2code.Stack.pop">pop</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Stack.push" href="#refinery.lib.thirdparty.pcode2code.Stack.push">push</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Stack.size" href="#refinery.lib.thirdparty.pcode2code.Stack.size">size</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Stack.top" href="#refinery.lib.thirdparty.pcode2code.Stack.top">top</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Stack.bottom" href="#refinery.lib.thirdparty.pcode2code.Stack.bottom">bottom</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Stack.clearstack" href="#refinery.lib.thirdparty.pcode2code.Stack.clearstack">clearstack</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.lib.thirdparty.pcode2code.Operations" href="#refinery.lib.thirdparty.pcode2code.Operations">Operations</a></code></h4>
<ul class="">
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.imp" href="#refinery.lib.thirdparty.pcode2code.Operations.imp">imp</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.eqv" href="#refinery.lib.thirdparty.pcode2code.Operations.eqv">eqv</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.xor" href="#refinery.lib.thirdparty.pcode2code.Operations.xor">xor</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.or_" href="#refinery.lib.thirdparty.pcode2code.Operations.or_">or_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.and_" href="#refinery.lib.thirdparty.pcode2code.Operations.and_">and_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.eq" href="#refinery.lib.thirdparty.pcode2code.Operations.eq">eq</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.ne" href="#refinery.lib.thirdparty.pcode2code.Operations.ne">ne</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.le" href="#refinery.lib.thirdparty.pcode2code.Operations.le">le</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.ge" href="#refinery.lib.thirdparty.pcode2code.Operations.ge">ge</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lt" href="#refinery.lib.thirdparty.pcode2code.Operations.lt">lt</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.gt" href="#refinery.lib.thirdparty.pcode2code.Operations.gt">gt</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.add" href="#refinery.lib.thirdparty.pcode2code.Operations.add">add</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.sub" href="#refinery.lib.thirdparty.pcode2code.Operations.sub">sub</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.mod" href="#refinery.lib.thirdparty.pcode2code.Operations.mod">mod</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.idiv" href="#refinery.lib.thirdparty.pcode2code.Operations.idiv">idiv</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.mul" href="#refinery.lib.thirdparty.pcode2code.Operations.mul">mul</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.div" href="#refinery.lib.thirdparty.pcode2code.Operations.div">div</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.concat" href="#refinery.lib.thirdparty.pcode2code.Operations.concat">concat</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.like" href="#refinery.lib.thirdparty.pcode2code.Operations.like">like</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.pwr" href="#refinery.lib.thirdparty.pcode2code.Operations.pwr">pwr</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.is_" href="#refinery.lib.thirdparty.pcode2code.Operations.is_">is_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.not_" href="#refinery.lib.thirdparty.pcode2code.Operations.not_">not_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.umi" href="#refinery.lib.thirdparty.pcode2code.Operations.umi">umi</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnabs" href="#refinery.lib.thirdparty.pcode2code.Operations.fnabs">fnabs</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnfix" href="#refinery.lib.thirdparty.pcode2code.Operations.fnfix">fnfix</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnint" href="#refinery.lib.thirdparty.pcode2code.Operations.fnint">fnint</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnsgn" href="#refinery.lib.thirdparty.pcode2code.Operations.fnsgn">fnsgn</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnlen" href="#refinery.lib.thirdparty.pcode2code.Operations.fnlen">fnlen</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnlenb" href="#refinery.lib.thirdparty.pcode2code.Operations.fnlenb">fnlenb</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.paren" href="#refinery.lib.thirdparty.pcode2code.Operations.paren">paren</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.sharp" href="#refinery.lib.thirdparty.pcode2code.Operations.sharp">sharp</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.ldlhs" href="#refinery.lib.thirdparty.pcode2code.Operations.ldlhs">ldlhs</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.ld" href="#refinery.lib.thirdparty.pcode2code.Operations.ld">ld</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.memld" href="#refinery.lib.thirdparty.pcode2code.Operations.memld">memld</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.dictld" href="#refinery.lib.thirdparty.pcode2code.Operations.dictld">dictld</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.indexld" href="#refinery.lib.thirdparty.pcode2code.Operations.indexld">indexld</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsld" href="#refinery.lib.thirdparty.pcode2code.Operations.argsld">argsld</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsmemld" href="#refinery.lib.thirdparty.pcode2code.Operations.argsmemld">argsmemld</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsdictld" href="#refinery.lib.thirdparty.pcode2code.Operations.argsdictld">argsdictld</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.st" href="#refinery.lib.thirdparty.pcode2code.Operations.st">st</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.memst" href="#refinery.lib.thirdparty.pcode2code.Operations.memst">memst</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.dictst" href="#refinery.lib.thirdparty.pcode2code.Operations.dictst">dictst</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.indexst" href="#refinery.lib.thirdparty.pcode2code.Operations.indexst">indexst</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsst" href="#refinery.lib.thirdparty.pcode2code.Operations.argsst">argsst</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsmemst" href="#refinery.lib.thirdparty.pcode2code.Operations.argsmemst">argsmemst</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsdictst" href="#refinery.lib.thirdparty.pcode2code.Operations.argsdictst">argsdictst</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.set_" href="#refinery.lib.thirdparty.pcode2code.Operations.set_">set_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.memset" href="#refinery.lib.thirdparty.pcode2code.Operations.memset">memset</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.dictset" href="#refinery.lib.thirdparty.pcode2code.Operations.dictset">dictset</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.indexset" href="#refinery.lib.thirdparty.pcode2code.Operations.indexset">indexset</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsset" href="#refinery.lib.thirdparty.pcode2code.Operations.argsset">argsset</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsmemset" href="#refinery.lib.thirdparty.pcode2code.Operations.argsmemset">argsmemset</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsdictset" href="#refinery.lib.thirdparty.pcode2code.Operations.argsdictset">argsdictset</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.memldwith" href="#refinery.lib.thirdparty.pcode2code.Operations.memldwith">memldwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.dictldwith" href="#refinery.lib.thirdparty.pcode2code.Operations.dictldwith">dictldwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsmemldwith" href="#refinery.lib.thirdparty.pcode2code.Operations.argsmemldwith">argsmemldwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsdictldwith" href="#refinery.lib.thirdparty.pcode2code.Operations.argsdictldwith">argsdictldwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.memstwith" href="#refinery.lib.thirdparty.pcode2code.Operations.memstwith">memstwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.dictstwith" href="#refinery.lib.thirdparty.pcode2code.Operations.dictstwith">dictstwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsmemstwith" href="#refinery.lib.thirdparty.pcode2code.Operations.argsmemstwith">argsmemstwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsdictstwith" href="#refinery.lib.thirdparty.pcode2code.Operations.argsdictstwith">argsdictstwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.memsetwith" href="#refinery.lib.thirdparty.pcode2code.Operations.memsetwith">memsetwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.dictsetwith" href="#refinery.lib.thirdparty.pcode2code.Operations.dictsetwith">dictsetwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsmemsetwith" href="#refinery.lib.thirdparty.pcode2code.Operations.argsmemsetwith">argsmemsetwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsdictsetwith" href="#refinery.lib.thirdparty.pcode2code.Operations.argsdictsetwith">argsdictsetwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argscall" href="#refinery.lib.thirdparty.pcode2code.Operations.argscall">argscall</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsmemcall" href="#refinery.lib.thirdparty.pcode2code.Operations.argsmemcall">argsmemcall</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsmemcallwith" href="#refinery.lib.thirdparty.pcode2code.Operations.argsmemcallwith">argsmemcallwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsarray" href="#refinery.lib.thirdparty.pcode2code.Operations.argsarray">argsarray</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.assert_" href="#refinery.lib.thirdparty.pcode2code.Operations.assert_">assert_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.bos" href="#refinery.lib.thirdparty.pcode2code.Operations.bos">bos</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.bosimplicit" href="#refinery.lib.thirdparty.pcode2code.Operations.bosimplicit">bosimplicit</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.bol" href="#refinery.lib.thirdparty.pcode2code.Operations.bol">bol</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.ldaddressof" href="#refinery.lib.thirdparty.pcode2code.Operations.ldaddressof">ldaddressof</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.memaddressof" href="#refinery.lib.thirdparty.pcode2code.Operations.memaddressof">memaddressof</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.case" href="#refinery.lib.thirdparty.pcode2code.Operations.case">case</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.caseto" href="#refinery.lib.thirdparty.pcode2code.Operations.caseto">caseto</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.casegt" href="#refinery.lib.thirdparty.pcode2code.Operations.casegt">casegt</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.caselt" href="#refinery.lib.thirdparty.pcode2code.Operations.caselt">caselt</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.casege" href="#refinery.lib.thirdparty.pcode2code.Operations.casege">casege</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.casele" href="#refinery.lib.thirdparty.pcode2code.Operations.casele">casele</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.casene" href="#refinery.lib.thirdparty.pcode2code.Operations.casene">casene</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.caseeq" href="#refinery.lib.thirdparty.pcode2code.Operations.caseeq">caseeq</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.caseelse" href="#refinery.lib.thirdparty.pcode2code.Operations.caseelse">caseelse</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.casedone" href="#refinery.lib.thirdparty.pcode2code.Operations.casedone">casedone</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.circle" href="#refinery.lib.thirdparty.pcode2code.Operations.circle">circle</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.close" href="#refinery.lib.thirdparty.pcode2code.Operations.close">close</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.closeall" href="#refinery.lib.thirdparty.pcode2code.Operations.closeall">closeall</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.coerce_" href="#refinery.lib.thirdparty.pcode2code.Operations.coerce_">coerce_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.coercevar" href="#refinery.lib.thirdparty.pcode2code.Operations.coercevar">coercevar</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.context" href="#refinery.lib.thirdparty.pcode2code.Operations.context">context</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.debug" href="#refinery.lib.thirdparty.pcode2code.Operations.debug">debug</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.deftype" href="#refinery.lib.thirdparty.pcode2code.Operations.deftype">deftype</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.dim" href="#refinery.lib.thirdparty.pcode2code.Operations.dim">dim</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.dimimplicit" href="#refinery.lib.thirdparty.pcode2code.Operations.dimimplicit">dimimplicit</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.do" href="#refinery.lib.thirdparty.pcode2code.Operations.do">do</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.doevents" href="#refinery.lib.thirdparty.pcode2code.Operations.doevents">doevents</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.dounitil" href="#refinery.lib.thirdparty.pcode2code.Operations.dounitil">dounitil</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.dowhile" href="#refinery.lib.thirdparty.pcode2code.Operations.dowhile">dowhile</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.else_" href="#refinery.lib.thirdparty.pcode2code.Operations.else_">else_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.elseblock" href="#refinery.lib.thirdparty.pcode2code.Operations.elseblock">elseblock</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.elseifblock" href="#refinery.lib.thirdparty.pcode2code.Operations.elseifblock">elseifblock</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.elseiftypeblock" href="#refinery.lib.thirdparty.pcode2code.Operations.elseiftypeblock">elseiftypeblock</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.end" href="#refinery.lib.thirdparty.pcode2code.Operations.end">end</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endcontext" href="#refinery.lib.thirdparty.pcode2code.Operations.endcontext">endcontext</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endfunc" href="#refinery.lib.thirdparty.pcode2code.Operations.endfunc">endfunc</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endif" href="#refinery.lib.thirdparty.pcode2code.Operations.endif">endif</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endifblock" href="#refinery.lib.thirdparty.pcode2code.Operations.endifblock">endifblock</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endimmediate" href="#refinery.lib.thirdparty.pcode2code.Operations.endimmediate">endimmediate</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endprop" href="#refinery.lib.thirdparty.pcode2code.Operations.endprop">endprop</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endselect" href="#refinery.lib.thirdparty.pcode2code.Operations.endselect">endselect</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endsub" href="#refinery.lib.thirdparty.pcode2code.Operations.endsub">endsub</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endtype" href="#refinery.lib.thirdparty.pcode2code.Operations.endtype">endtype</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endwith" href="#refinery.lib.thirdparty.pcode2code.Operations.endwith">endwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.erase" href="#refinery.lib.thirdparty.pcode2code.Operations.erase">erase</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.error" href="#refinery.lib.thirdparty.pcode2code.Operations.error">error</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.eventdecl" href="#refinery.lib.thirdparty.pcode2code.Operations.eventdecl">eventdecl</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.raiseevent" href="#refinery.lib.thirdparty.pcode2code.Operations.raiseevent">raiseevent</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsmemraiseevent" href="#refinery.lib.thirdparty.pcode2code.Operations.argsmemraiseevent">argsmemraiseevent</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.argsmemraiseeventwith" href="#refinery.lib.thirdparty.pcode2code.Operations.argsmemraiseeventwith">argsmemraiseeventwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.exitdo" href="#refinery.lib.thirdparty.pcode2code.Operations.exitdo">exitdo</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.exitfor" href="#refinery.lib.thirdparty.pcode2code.Operations.exitfor">exitfor</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.exitfunc" href="#refinery.lib.thirdparty.pcode2code.Operations.exitfunc">exitfunc</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.exitprop" href="#refinery.lib.thirdparty.pcode2code.Operations.exitprop">exitprop</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.exitsub" href="#refinery.lib.thirdparty.pcode2code.Operations.exitsub">exitsub</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fncurdir" href="#refinery.lib.thirdparty.pcode2code.Operations.fncurdir">fncurdir</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fndir" href="#refinery.lib.thirdparty.pcode2code.Operations.fndir">fndir</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.empty0" href="#refinery.lib.thirdparty.pcode2code.Operations.empty0">empty0</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.empty1" href="#refinery.lib.thirdparty.pcode2code.Operations.empty1">empty1</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnerror" href="#refinery.lib.thirdparty.pcode2code.Operations.fnerror">fnerror</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnformat" href="#refinery.lib.thirdparty.pcode2code.Operations.fnformat">fnformat</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnfreefile" href="#refinery.lib.thirdparty.pcode2code.Operations.fnfreefile">fnfreefile</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fninstr" href="#refinery.lib.thirdparty.pcode2code.Operations.fninstr">fninstr</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fninstr3" href="#refinery.lib.thirdparty.pcode2code.Operations.fninstr3">fninstr3</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fninstr4" href="#refinery.lib.thirdparty.pcode2code.Operations.fninstr4">fninstr4</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fninstrb" href="#refinery.lib.thirdparty.pcode2code.Operations.fninstrb">fninstrb</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fninstrb3" href="#refinery.lib.thirdparty.pcode2code.Operations.fninstrb3">fninstrb3</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fninstrb4" href="#refinery.lib.thirdparty.pcode2code.Operations.fninstrb4">fninstrb4</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnlbound" href="#refinery.lib.thirdparty.pcode2code.Operations.fnlbound">fnlbound</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnmid" href="#refinery.lib.thirdparty.pcode2code.Operations.fnmid">fnmid</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnmidb" href="#refinery.lib.thirdparty.pcode2code.Operations.fnmidb">fnmidb</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnstrcomp" href="#refinery.lib.thirdparty.pcode2code.Operations.fnstrcomp">fnstrcomp</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnstrcomp3" href="#refinery.lib.thirdparty.pcode2code.Operations.fnstrcomp3">fnstrcomp3</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnstringvar" href="#refinery.lib.thirdparty.pcode2code.Operations.fnstringvar">fnstringvar</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnstringstr" href="#refinery.lib.thirdparty.pcode2code.Operations.fnstringstr">fnstringstr</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.fnubound" href="#refinery.lib.thirdparty.pcode2code.Operations.fnubound">fnubound</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.for_" href="#refinery.lib.thirdparty.pcode2code.Operations.for_">for_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.foreach" href="#refinery.lib.thirdparty.pcode2code.Operations.foreach">foreach</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.foreachas" href="#refinery.lib.thirdparty.pcode2code.Operations.foreachas">foreachas</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.forstep" href="#refinery.lib.thirdparty.pcode2code.Operations.forstep">forstep</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.funcdefn" href="#refinery.lib.thirdparty.pcode2code.Operations.funcdefn">funcdefn</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.funcdefnsave" href="#refinery.lib.thirdparty.pcode2code.Operations.funcdefnsave">funcdefnsave</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.getrec" href="#refinery.lib.thirdparty.pcode2code.Operations.getrec">getrec</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.gosub" href="#refinery.lib.thirdparty.pcode2code.Operations.gosub">gosub</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.goto" href="#refinery.lib.thirdparty.pcode2code.Operations.goto">goto</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.if_" href="#refinery.lib.thirdparty.pcode2code.Operations.if_">if_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.ifblock" href="#refinery.lib.thirdparty.pcode2code.Operations.ifblock">ifblock</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.typeof" href="#refinery.lib.thirdparty.pcode2code.Operations.typeof">typeof</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.iftypeblock" href="#refinery.lib.thirdparty.pcode2code.Operations.iftypeblock">iftypeblock</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.implements" href="#refinery.lib.thirdparty.pcode2code.Operations.implements">implements</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.input_" href="#refinery.lib.thirdparty.pcode2code.Operations.input_">input_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.inputdone" href="#refinery.lib.thirdparty.pcode2code.Operations.inputdone">inputdone</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.inputItem" href="#refinery.lib.thirdparty.pcode2code.Operations.inputItem">inputItem</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.label" href="#refinery.lib.thirdparty.pcode2code.Operations.label">label</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.let" href="#refinery.lib.thirdparty.pcode2code.Operations.let">let</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.line" href="#refinery.lib.thirdparty.pcode2code.Operations.line">line</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.linecont" href="#refinery.lib.thirdparty.pcode2code.Operations.linecont">linecont</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lineInput" href="#refinery.lib.thirdparty.pcode2code.Operations.lineInput">lineInput</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.linenum" href="#refinery.lib.thirdparty.pcode2code.Operations.linenum">linenum</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litcy" href="#refinery.lib.thirdparty.pcode2code.Operations.litcy">litcy</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litdate" href="#refinery.lib.thirdparty.pcode2code.Operations.litdate">litdate</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litdefault" href="#refinery.lib.thirdparty.pcode2code.Operations.litdefault">litdefault</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litdi2" href="#refinery.lib.thirdparty.pcode2code.Operations.litdi2">litdi2</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litdi4" href="#refinery.lib.thirdparty.pcode2code.Operations.litdi4">litdi4</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litdi8" href="#refinery.lib.thirdparty.pcode2code.Operations.litdi8">litdi8</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lithi2" href="#refinery.lib.thirdparty.pcode2code.Operations.lithi2">lithi2</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lithi4" href="#refinery.lib.thirdparty.pcode2code.Operations.lithi4">lithi4</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lithi8" href="#refinery.lib.thirdparty.pcode2code.Operations.lithi8">lithi8</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litnothing" href="#refinery.lib.thirdparty.pcode2code.Operations.litnothing">litnothing</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litoi2" href="#refinery.lib.thirdparty.pcode2code.Operations.litoi2">litoi2</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litoi4" href="#refinery.lib.thirdparty.pcode2code.Operations.litoi4">litoi4</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litoi8" href="#refinery.lib.thirdparty.pcode2code.Operations.litoi8">litoi8</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litr4" href="#refinery.lib.thirdparty.pcode2code.Operations.litr4">litr4</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litr8" href="#refinery.lib.thirdparty.pcode2code.Operations.litr8">litr8</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litsmalli2" href="#refinery.lib.thirdparty.pcode2code.Operations.litsmalli2">litsmalli2</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litstr" href="#refinery.lib.thirdparty.pcode2code.Operations.litstr">litstr</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.litvarspecial" href="#refinery.lib.thirdparty.pcode2code.Operations.litvarspecial">litvarspecial</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lock" href="#refinery.lib.thirdparty.pcode2code.Operations.lock">lock</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.loop" href="#refinery.lib.thirdparty.pcode2code.Operations.loop">loop</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.loopuntil" href="#refinery.lib.thirdparty.pcode2code.Operations.loopuntil">loopuntil</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.loopwhile" href="#refinery.lib.thirdparty.pcode2code.Operations.loopwhile">loopwhile</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lset" href="#refinery.lib.thirdparty.pcode2code.Operations.lset">lset</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.me" href="#refinery.lib.thirdparty.pcode2code.Operations.me">me</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.meimplicit" href="#refinery.lib.thirdparty.pcode2code.Operations.meimplicit">meimplicit</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.memredim" href="#refinery.lib.thirdparty.pcode2code.Operations.memredim">memredim</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.memredimwith" href="#refinery.lib.thirdparty.pcode2code.Operations.memredimwith">memredimwith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.memredimas" href="#refinery.lib.thirdparty.pcode2code.Operations.memredimas">memredimas</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.memredimaswith" href="#refinery.lib.thirdparty.pcode2code.Operations.memredimaswith">memredimaswith</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.mid" href="#refinery.lib.thirdparty.pcode2code.Operations.mid">mid</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.midb" href="#refinery.lib.thirdparty.pcode2code.Operations.midb">midb</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.name" href="#refinery.lib.thirdparty.pcode2code.Operations.name">name</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.new" href="#refinery.lib.thirdparty.pcode2code.Operations.new">new</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.next_" href="#refinery.lib.thirdparty.pcode2code.Operations.next_">next_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.nextvar" href="#refinery.lib.thirdparty.pcode2code.Operations.nextvar">nextvar</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.onerror" href="#refinery.lib.thirdparty.pcode2code.Operations.onerror">onerror</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.ongosub" href="#refinery.lib.thirdparty.pcode2code.Operations.ongosub">ongosub</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.ongoto" href="#refinery.lib.thirdparty.pcode2code.Operations.ongoto">ongoto</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.open_" href="#refinery.lib.thirdparty.pcode2code.Operations.open_">open_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.option" href="#refinery.lib.thirdparty.pcode2code.Operations.option">option</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.optionbase" href="#refinery.lib.thirdparty.pcode2code.Operations.optionbase">optionbase</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.parambyval" href="#refinery.lib.thirdparty.pcode2code.Operations.parambyval">parambyval</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.paramomitted" href="#refinery.lib.thirdparty.pcode2code.Operations.paramomitted">paramomitted</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.paramnamed" href="#refinery.lib.thirdparty.pcode2code.Operations.paramnamed">paramnamed</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printchan" href="#refinery.lib.thirdparty.pcode2code.Operations.printchan">printchan</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printcomma" href="#refinery.lib.thirdparty.pcode2code.Operations.printcomma">printcomma</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printeos" href="#refinery.lib.thirdparty.pcode2code.Operations.printeos">printeos</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printitemcomma" href="#refinery.lib.thirdparty.pcode2code.Operations.printitemcomma">printitemcomma</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printitemnl" href="#refinery.lib.thirdparty.pcode2code.Operations.printitemnl">printitemnl</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printitemsemi" href="#refinery.lib.thirdparty.pcode2code.Operations.printitemsemi">printitemsemi</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printnl" href="#refinery.lib.thirdparty.pcode2code.Operations.printnl">printnl</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printobj" href="#refinery.lib.thirdparty.pcode2code.Operations.printobj">printobj</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printsemi" href="#refinery.lib.thirdparty.pcode2code.Operations.printsemi">printsemi</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printspc" href="#refinery.lib.thirdparty.pcode2code.Operations.printspc">printspc</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printtab" href="#refinery.lib.thirdparty.pcode2code.Operations.printtab">printtab</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.printtabcomma" href="#refinery.lib.thirdparty.pcode2code.Operations.printtabcomma">printtabcomma</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.pset" href="#refinery.lib.thirdparty.pcode2code.Operations.pset">pset</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.putrec" href="#refinery.lib.thirdparty.pcode2code.Operations.putrec">putrec</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.quoterem" href="#refinery.lib.thirdparty.pcode2code.Operations.quoterem">quoterem</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.redim" href="#refinery.lib.thirdparty.pcode2code.Operations.redim">redim</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.redimas" href="#refinery.lib.thirdparty.pcode2code.Operations.redimas">redimas</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.reparse" href="#refinery.lib.thirdparty.pcode2code.Operations.reparse">reparse</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.rem" href="#refinery.lib.thirdparty.pcode2code.Operations.rem">rem</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.resume" href="#refinery.lib.thirdparty.pcode2code.Operations.resume">resume</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.return_" href="#refinery.lib.thirdparty.pcode2code.Operations.return_">return_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.rset" href="#refinery.lib.thirdparty.pcode2code.Operations.rset">rset</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.scale" href="#refinery.lib.thirdparty.pcode2code.Operations.scale">scale</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.seek" href="#refinery.lib.thirdparty.pcode2code.Operations.seek">seek</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.selectcase" href="#refinery.lib.thirdparty.pcode2code.Operations.selectcase">selectcase</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.selectis" href="#refinery.lib.thirdparty.pcode2code.Operations.selectis">selectis</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.selecttype" href="#refinery.lib.thirdparty.pcode2code.Operations.selecttype">selecttype</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.setstmt" href="#refinery.lib.thirdparty.pcode2code.Operations.setstmt">setstmt</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.stack" href="#refinery.lib.thirdparty.pcode2code.Operations.stack">stack</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.stop" href="#refinery.lib.thirdparty.pcode2code.Operations.stop">stop</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.type_" href="#refinery.lib.thirdparty.pcode2code.Operations.type_">type_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.unlock" href="#refinery.lib.thirdparty.pcode2code.Operations.unlock">unlock</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.vardefn" href="#refinery.lib.thirdparty.pcode2code.Operations.vardefn">vardefn</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.wend" href="#refinery.lib.thirdparty.pcode2code.Operations.wend">wend</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.while_" href="#refinery.lib.thirdparty.pcode2code.Operations.while_">while_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.with_" href="#refinery.lib.thirdparty.pcode2code.Operations.with_">with_</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.writechan" href="#refinery.lib.thirdparty.pcode2code.Operations.writechan">writechan</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.constfuncexpr" href="#refinery.lib.thirdparty.pcode2code.Operations.constfuncexpr">constfuncexpr</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lbconst" href="#refinery.lib.thirdparty.pcode2code.Operations.lbconst">lbconst</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lbif" href="#refinery.lib.thirdparty.pcode2code.Operations.lbif">lbif</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lbelse" href="#refinery.lib.thirdparty.pcode2code.Operations.lbelse">lbelse</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lbelseif" href="#refinery.lib.thirdparty.pcode2code.Operations.lbelseif">lbelseif</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lbendif" href="#refinery.lib.thirdparty.pcode2code.Operations.lbendif">lbendif</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.lbmark" href="#refinery.lib.thirdparty.pcode2code.Operations.lbmark">lbmark</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endforvariable" href="#refinery.lib.thirdparty.pcode2code.Operations.endforvariable">endforvariable</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.startforvariable" href="#refinery.lib.thirdparty.pcode2code.Operations.startforvariable">startforvariable</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.newredim" href="#refinery.lib.thirdparty.pcode2code.Operations.newredim">newredim</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.startwithexpr" href="#refinery.lib.thirdparty.pcode2code.Operations.startwithexpr">startwithexpr</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.setorst" href="#refinery.lib.thirdparty.pcode2code.Operations.setorst">setorst</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.endenum" href="#refinery.lib.thirdparty.pcode2code.Operations.endenum">endenum</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.illegal" href="#refinery.lib.thirdparty.pcode2code.Operations.illegal">illegal</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.newline" href="#refinery.lib.thirdparty.pcode2code.Operations.newline">newline</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.clearstack" href="#refinery.lib.thirdparty.pcode2code.Operations.clearstack">clearstack</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.getstacktop" href="#refinery.lib.thirdparty.pcode2code.Operations.getstacktop">getstacktop</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.getstackpop" href="#refinery.lib.thirdparty.pcode2code.Operations.getstackpop">getstackpop</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.getstacksize" href="#refinery.lib.thirdparty.pcode2code.Operations.getstacksize">getstacksize</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.increaseindentlevel_future" href="#refinery.lib.thirdparty.pcode2code.Operations.increaseindentlevel_future">increaseindentlevel_future</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.getindentlevel" href="#refinery.lib.thirdparty.pcode2code.Operations.getindentlevel">getindentlevel</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.hasbos" href="#refinery.lib.thirdparty.pcode2code.Operations.hasbos">hasbos</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Operations.resethasbos" href="#refinery.lib.thirdparty.pcode2code.Operations.resethasbos">resethasbos</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="refinery.lib.thirdparty.pcode2code.Parser" href="#refinery.lib.thirdparty.pcode2code.Parser">Parser</a></code></h4>
<ul class="two-column">
<li><code><a title="refinery.lib.thirdparty.pcode2code.Parser.queueLineOutput" href="#refinery.lib.thirdparty.pcode2code.Parser.queueLineOutput">queueLineOutput</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Parser.addlineOutput" href="#refinery.lib.thirdparty.pcode2code.Parser.addlineOutput">addlineOutput</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Parser.getOutput" href="#refinery.lib.thirdparty.pcode2code.Parser.getOutput">getOutput</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Parser.parseInput" href="#refinery.lib.thirdparty.pcode2code.Parser.parseInput">parseInput</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Parser.parseOpLine" href="#refinery.lib.thirdparty.pcode2code.Parser.parseOpLine">parseOpLine</a></code></li>
<li><code><a title="refinery.lib.thirdparty.pcode2code.Parser.processInput" href="#refinery.lib.thirdparty.pcode2code.Parser.processInput">processInput</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>
hljs.configure({languages: []})
hljs.initHighlightingOnLoad()
</script>
</body>
</html>
